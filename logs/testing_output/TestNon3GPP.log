2025-12-05T18:56:16.946012699Z[36m [INFO][UPF][Main] [0mUPF version:  
	free5GC version: v4.1.0-26-gf454591
	build time:      2025-12-05T18:52:44Z
	commit hash:     +f9b9500
	commit time:     2025-12-05T05:43:16Z
	go version:      go1.24.2 linux/amd64
2025-12-05T18:56:16.946081125Z[36m [INFO][UPF][CFG] [0mRead config from [./config/upfcfg.test.yaml]
2025-12-05T18:56:16.946232446Z[36m [INFO][UPF][CFG] [0m==================================================
2025-12-05T18:56:16.946239176Z[36m [INFO][UPF][CFG] [0m(*factory.Config)(0xc0000e5e00)({
	Version: (string) (len=5) "1.0.3",
	Description: (string) (len=31) "UPF initial local configuration",
	Pfcp: (*factory.Pfcp)(0xc00029a480)({
		Addr: (string) (len=14) "10.200.200.101",
		NodeID: (string) (len=14) "10.200.200.101",
		RetransTimeout: (time.Duration) 1s,
		MaxRetrans: (uint8) 3
	}),
	Gtpu: (*factory.Gtpu)(0xc00029a750)({
		Forwarder: (string) (len=5) "gtp5g",
		IfList: ([]factory.IfInfo) (len=1 cap=1) {
			(factory.IfInfo) {
				Addr: (string) (len=14) "10.200.200.102",
				Type: (string) (len=2) "N3",
				Name: (string) "",
				IfName: (string) "",
				MTU: (uint32) 0
			}
		}
	}),
	DnnList: ([]factory.DnnList) (len=1 cap=1) {
		(factory.DnnList) {
			Dnn: (string) (len=8) "internet",
			Cidr: (string) (len=12) "10.60.0.0/16",
			NatIfName: (string) ""
		}
	},
	Logger: (*factory.Logger)(0xc0001a18c0)({
		Enable: (bool) true,
		Level: (string) (len=4) "info",
		ReportCaller: (bool) false
	})
})
2025-12-05T18:56:16.946241660Z[36m [INFO][UPF][CFG] [0m==================================================
2025-12-05T18:56:16.946244877Z[36m [INFO][UPF][Main] [0mLog level is set to [info]
2025-12-05T18:56:16.946247350Z[36m [INFO][UPF][Main] [0mReport Caller is set to [false]
2025-12-05T18:56:16.946265986Z[36m [INFO][UPF][Main] [0mstarting Gtpu Forwarder [gtp5g]
2025-12-05T18:56:16.946278396Z[36m [INFO][UPF][Main] [0mGTP Address: "10.200.200.102:2152"
2025-12-05T18:56:16.948087670Z[36m [INFO][UPF][BUFF] [0mbuff netlink server started
2025-12-05T18:56:16.948121594Z[36m [INFO][UPF][Gtp5g] [0mForwarder started
2025-12-05T18:56:16.948220412Z[36m [INFO][UPF][Perio] [0mperio server started
2025-12-05T18:56:16.948292693Z[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mstarting pfcp server
2025-12-05T18:56:16.948351835Z[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mpfcp server started
2025-12-05T18:56:16.948358171Z[36m [INFO][UPF][Main] [0mUPF started
Run TestCN
os.Args: [/tmp/go-build2415630793/b001/test.test -test.paniconexit0 -test.v=true -test.timeout=0s -test.run=TestCN]
2025-12-05T18:56:20.270143019Z[36m [INFO][NRF][Main] [0mLog enable is set to [true]
2025-12-05T18:56:20.270224971Z[36m [INFO][NRF][Main] [0mLog level is set to [info]
2025-12-05T18:56:20.270246507Z[36m [INFO][NRF][Main] [0mReport Caller is set to [false]
2025-12-05T18:56:20.270257089Z[36m [INFO][NRF][Init] [0mnrfconfig Info: Version[1.0.2] Description[NRF initial test configuration]
2025-12-05T18:56:20.270288309Z[36m [INFO][NRF][SBI] [0mBinding addr: [127.0.0.10:8000]
AMF Config failed: invalid T3555: non zero value required
2025-12-05T18:56:20.270668887Z[36m [INFO][AMF][Main] [0mLog enable is set to [true]
2025-12-05T18:56:20.270672093Z[36m [INFO][AMF][Main] [0mLog level is set to [info]
2025-12-05T18:56:20.270674446Z[36m [INFO][AMF][Main] [0mReport Caller is set to [false]
2025-12-05T18:56:20.270711039Z[36m [INFO][AMF][SBI] [0mBinding addr: [127.0.0.18:8000]
2025-12-05T18:56:20.271117803Z[36m [INFO][SMF][Main] [0mLog enable is set to [true]
2025-12-05T18:56:20.271121152Z[36m [INFO][SMF][Main] [0mLog level is set to [info]
2025-12-05T18:56:20.271123461Z[36m [INFO][SMF][Main] [0mReport Caller is set to [false]
2025-12-05T18:56:20.271127740Z[36m [INFO][SMF][CTX] [0msmfconfig Info: Version[1.0.7] Description[SMF initial single test configuration]
2025-12-05T18:56:20.271139525Z[36m [INFO][SMF][CTX] [0mEndpoints: [10.200.200.102]
2025-12-05T18:56:20.271263280Z[36m [INFO][UDR][Util] [0mudrconfig Info: Version[1.1.0] Description[UDR initial test configuration]
2025-12-05T18:56:20.271277484Z[36m [INFO][UDR][Main] [0mLog enable is set to [true]
2025-12-05T18:56:20.271280144Z[36m [INFO][UDR][Main] [0mLog level is set to [info]
2025-12-05T18:56:20.271282529Z[36m [INFO][UDR][Main] [0mReport Caller is set to [false]
2025-12-05T18:56:20.271618590Z[36m [INFO][PCF][Main] [0mLog enable is set to [true]
2025-12-05T18:56:20.271621829Z[36m [INFO][PCF][Main] [0mLog level is set to [info]
2025-12-05T18:56:20.271624149Z[36m [INFO][PCF][Main] [0mReport Caller is set to [false]
2025-12-05T18:56:20.271629074Z[36m [INFO][PCF][Util] [0mpcfconfig Info: Version[1.0.2] Description[PCF initial test configuration]
2025-12-05T18:56:20.271704493Z[36m [INFO][PCF][SBI] [0mBinding addr: [127.0.0.7:8000]
2025-12-05T18:56:20.271906338Z[36m [INFO][UDM][Main] [0mLog enable is set to [true]
2025-12-05T18:56:20.271908975Z[36m [INFO][UDM][Main] [0mLog level is set to [info]
2025-12-05T18:56:20.271911229Z[36m [INFO][UDM][Main] [0mReport Caller is set to [false]
2025-12-05T18:56:20.271914096Z[36m [INFO][UDM][Util] [0mudmconfig Info: Version[1.0.3] Description[UDM initial test configuration]
2025-12-05T18:56:20.271974688Z[36m [INFO][UDM][SBI] [0mBinding addr: [127.0.0.3:8000]
2025-12-05T18:56:20.271987458Z[36m [INFO][NSSF][Main] [0mLog enable is set to [true]
2025-12-05T18:56:20.271989986Z[36m [INFO][NSSF][Main] [0mLog level is set to [info]
2025-12-05T18:56:20.271992317Z[36m [INFO][NSSF][Main] [0mReport Caller is set to [false]
2025-12-05T18:56:20.272096714Z[36m [INFO][AUSF][Main] [0mLog enable is set to [true]
2025-12-05T18:56:20.272099165Z[36m [INFO][AUSF][Main] [0mLog level is set to [info]
2025-12-05T18:56:20.272115656Z[36m [INFO][AUSF][Main] [0mReport Caller is set to [false]
2025-12-05T18:56:20.272123612Z[36m [INFO][AUSF][Init] [0mausfconfig Info: Version[1.0.3] Description[AUSF initial test configuration]
ausf context =  &{{{} {{{} 0} {0 0} {[] {} <nil>} <nil> <nil> 0}} {{} {{{} 0} {0 0} {[] {} <nil>} <nil> <nil> 0}} 4e539199-2ef0-46ab-aaf1-ca277ee0e1e9 ausfGroup001 8000 127.0.0.9 127.0.0.9 http://127.0.0.9:8000 http http://127.0.0.10:8000 ../cert/nrf.pem map[nausf-auth:{4e539199-2ef0-46ab-aaf1-ca277ee0e1e9 nausf-auth [{v1 1.0.3 <nil>}] http REGISTERED   [{127.0.0.9   8000}]  [] [] [] [] [] [] map[] map[] 0 0 0 <nil> <nil>  [] [] []  map[] false <nil>}] [{208 93} {123 45}]  0xc0006b26e0 false false}
2025-12-05T18:56:20.272171750Z[36m [INFO][AUSF][SBI] [0mBinding addr: [127.0.0.9:8000]
CHF Config failed: invalid Cgf.PassiveTransferPortRange.End: non zero value required;Cgf.PassiveTransferPortRange.Start: non zero value required
2025-12-05T18:56:20.272277646Z[36m [INFO][CHF][Main] [0mLog enable is set to [true]
2025-12-05T18:56:20.272280338Z[36m [INFO][CHF][Main] [0mLog level is set to [info]
2025-12-05T18:56:20.272282603Z[36m [INFO][CHF][Main] [0mReport Caller is set to [false]
2025-12-05T18:56:20.272288108Z[36m [INFO][CHF][Init] [0mchfconfig Info: Version[1.0.3] Description[CHF initial test configuration]
2025-12-05T18:56:20.272297420Z[36m [INFO][CHF][SBI] [0mBinding addr: [127.0.0.113:8000]
NfStart 9
2025-12-05T18:56:20.272365428Z[36m [INFO][NRF][Init] [0mServer starting
2025-12-05T18:56:20.272397283Z[36m [INFO][NRF][SBI] [0mSBI server started
2025-12-05T18:56:20.944161716Z[36m [INFO][AMF][Util] [0mamfconfig Info: Version[1.0.9]
2025-12-05T18:56:20.944223227Z[36m [INFO][AMF][Init] [0mServer started
2025-12-05T18:56:20.944328004Z[36m [INFO][AMF][Ngap] [0mListen on 10.200.200.1:38412
2025-12-05T18:56:20.945574767Z[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-12-05T18:56:20.947457223Z[36m [INFO][NRF][NFM] [0murilist update
2025-12-05T18:56:20.958729113Z[36m [INFO][NRF][NFM] [0mCreate NF Profile: afb10138-6a20-44f0-984f-c8f78a942262
2025-12-05T18:56:20.959905480Z[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/afb10138-6a20-44f0-984f-c8f78a942262 |  |
2025-12-05T18:56:20.960070359Z[36m [INFO][AMF][Main] [0mOAuth2 setting receive from NRF: false
2025-12-05T18:56:20.960077023Z[36m [INFO][AMF][SBI] [0mStart SBI server (listen on 127.0.0.18:8000)
2025-12-05T18:56:21.265849353Z[36m [INFO][SMF][Init] [0mServer started
2025-12-05T18:56:21.266330704Z[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-12-05T18:56:21.267422843Z[36m [INFO][NRF][NFM] [0murilist update
2025-12-05T18:56:21.267947197Z[36m [INFO][NRF][NFM] [0mCreate NF Profile: a4332398-80cd-4038-a6d4-21337c4b40a2
2025-12-05T18:56:21.268670642Z[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/a4332398-80cd-4038-a6d4-21337c4b40a2 |  |
2025-12-05T18:56:21.268808328Z[36m [INFO][SMF][Main] [0mOAuth2 setting receive from NRF: false
2025-12-05T18:56:21.269212663Z[36m [INFO][SMF][Init] [0mSMF Registration to NRF {a4332398-80cd-4038-a6d4-21337c4b40a2  SMF REGISTERED [] 0 [{208 93}] [] [{1 fedcba [] false} {1 112233 [] false}] [] []   [127.0.0.2] [] [] [] [] [] [] 0 0 0 <nil> area1 <nil> map[] <nil> map[] <nil> map[] <nil> map[] 0xc000cd0160 map[] <nil> map[] <nil> map[] <nil> map[] <nil> map[] <nil> <nil> <nil> map[] <nil> map[] map[] map[] map[oauth2:false] <nil> false [{a4332398-80cd-4038-a6d4-21337c4b40a2nsmf-pdusession nsmf-pdusession [{v1 https://127.0.0.2:8000/nsmf-pdusession/v1 2025-12-05 18:56:20.271150096 +0000 UTC}] https REGISTERED   [{127.0.0.2   8000}] http://127.0.0.2:8000 [] [] [] [] [] [] map[] map[] 0 0 0 <nil> <nil>  [] [] []  map[] false <nil>} {a4332398-80cd-4038-a6d4-21337c4b40a2nsmf-event-exposure nsmf-event-exposure [{v1 https://127.0.0.2:8000/nsmf-pdusession/v1 2025-12-05 18:56:20.271150096 +0000 UTC}] https REGISTERED   [{127.0.0.2   8000}] http://127.0.0.2:8000 [] [] [] [] [] [] map[] map[] 0 0 0 <nil> <nil>  [] [] []  map[] false <nil>} {a4332398-80cd-4038-a6d4-21337c4b40a2nsmf-oam nsmf-oam [{v1 https://127.0.0.2:8000/nsmf-pdusession/v1 2025-12-05 18:56:20.271150096 +0000 UTC}] https REGISTERED   [{127.0.0.2   8000}] http://127.0.0.2:8000 [] [] [] [] [] [] map[] map[] 0 0 0 <nil> <nil>  [] [] []  map[] false <nil>}] map[] false false [] <nil> <nil> [] [] false false map[] map[] [] <nil> <nil>  map[] map[] <nil> <nil> map[] <nil> map[] map[] map[] map[] <nil> <nil> [] <nil> <nil>}
2025-12-05T18:56:21.269250974Z[36m [INFO][SMF][PFCP] [0mListen on 10.200.200.1:8805
2025-12-05T18:56:21.269257299Z[36m [INFO][SMF][PFCP] [0mPfcp running... [2025-12-05 18:56:21.269254279 +0000 UTC m=+1.026179872]
2025-12-05T18:56:21.269265474Z[36m [INFO][SMF][SBI] [0mStart SBI server (listen on 127.0.0.2:8000)
2025-12-05T18:56:21.818450460Z[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-12-05T18:56:21.819690119Z[36m [INFO][NRF][NFM] [0murilist update
2025-12-05T18:56:21.820260733Z[36m [INFO][NRF][NFM] [0mCreate NF Profile: fae60dd3-1279-446d-ab2f-6ff07b36f817
2025-12-05T18:56:21.821142604Z[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/fae60dd3-1279-446d-ab2f-6ff07b36f817 |  |
2025-12-05T18:56:21.821302230Z[36m [INFO][UDR][Main] [0mOAuth2 setting receive from NRF: false
2025-12-05T18:56:21.821307493Z[36m [INFO][UDR][Init] [0mregister to NRF successfully
2025-12-05T18:56:21.821310404Z[36m [INFO][UDR][Init] [0mServer started
2025-12-05T18:56:21.821313545Z[36m [INFO][UDR][Init] [0mUDR Config Info: Version[1.1.0] Description[UDR initial test configuration]
2025-12-05T18:56:21.821316434Z[36m [INFO][UDR][SBI] [0mStarting server...
2025-12-05T18:56:22.030630207Z[36m [INFO][PCF][Init] [0mServer started
2025-12-05T18:56:22.031033166Z[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-12-05T18:56:22.031893115Z[36m [INFO][NRF][NFM] [0murilist update
2025-12-05T18:56:22.032510379Z[36m [INFO][NRF][NFM] [0mCreate NF Profile: c3a46934-2263-44d3-890a-ee3565ff4ab5
2025-12-05T18:56:22.033227835Z[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/c3a46934-2263-44d3-890a-ee3565ff4ab5 |  |
2025-12-05T18:56:22.033372283Z[36m [INFO][PCF][Main] [0mOAuth2 setting receive from NRF: false
2025-12-05T18:56:22.033378860Z[36m [INFO][PCF][SBI] [0mStart SBI server (listen on 127.0.0.7:8000)
2025-12-05T18:56:22.962932199Z[36m [INFO][UDM][Init] [0mServer started
2025-12-05T18:56:22.962981878Z[36m [INFO][SMF][Main] [0mSending PFCP Association Request to UPF[10.200.200.101]
2025-12-05T18:56:22.962990209Z[36m [INFO][UDM][SBI] [0mStarting server...
2025-12-05T18:56:22.963214862Z[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleAssociationSetupRequest
2025-12-05T18:56:22.963263525Z[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1] [0mNew node
2025-12-05T18:56:22.963330045Z[36m [INFO][SMF][Main] [0mReceived PFCP Association Setup Accepted Response from UPF[10.200.200.101]
2025-12-05T18:56:22.963335735Z[36m [INFO][SMF][Main] [0mUPF(10.200.200.101) setup association
2025-12-05T18:56:22.963464746Z[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-12-05T18:56:22.964432024Z[36m [INFO][NRF][NFM] [0murilist update
2025-12-05T18:56:22.964950221Z[36m [INFO][NRF][NFM] [0mCreate NF Profile: a4ce3e9f-37d7-43b2-a8b6-0a39a984816e
2025-12-05T18:56:22.965569904Z[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/a4ce3e9f-37d7-43b2-a8b6-0a39a984816e |  |
2025-12-05T18:56:22.965705182Z[36m [INFO][UDM][Main] [0mOAuth2 setting receive from NRF: false
2025-12-05T18:56:22.965711387Z[36m [INFO][UDM][SBI] [0mStart SBI server (listen on 127.0.0.3:8000)
2025-12-05T18:56:24.433300264Z[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-12-05T18:56:24.434474286Z[36m [INFO][NRF][NFM] [0murilist update
2025-12-05T18:56:24.435052189Z[36m [INFO][NRF][NFM] [0mCreate NF Profile: 9273df08-0f14-4dff-a65f-89f5b7a860ce
2025-12-05T18:56:24.435819530Z[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/9273df08-0f14-4dff-a65f-89f5b7a860ce |  |
2025-12-05T18:56:24.435962883Z[36m [INFO][NSSF][Main] [0mOAuth2 setting receive from NRF: false
2025-12-05T18:56:24.435968038Z[36m [INFO][NSSF][Main] [0mregister to NRF successfully
2025-12-05T18:56:24.435971003Z[36m [INFO][NSSF][SBI] [0mStarting server...
2025-12-05T18:56:24.633769811Z[36m [INFO][AUSF][Init] [0mServer started
2025-12-05T18:56:24.634172395Z[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-12-05T18:56:24.635723400Z[36m [INFO][NRF][NFM] [0murilist update
2025-12-05T18:56:24.636243391Z[36m [INFO][NRF][NFM] [0mCreate NF Profile: 4e539199-2ef0-46ab-aaf1-ca277ee0e1e9
2025-12-05T18:56:24.637068443Z[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/4e539199-2ef0-46ab-aaf1-ca277ee0e1e9 |  |
2025-12-05T18:56:24.637194572Z[36m [INFO][AUSF][Main] [0mOAuth2 setting receive from NRF: false
2025-12-05T18:56:24.637201149Z[36m [INFO][AUSF][SBI] [0mStart SBI server (listen on 127.0.0.9:8000)
2025-12-05T18:56:24.833812461Z[36m [INFO][CHF][Init] [0mServer started
2025-12-05T18:56:24.834559783Z[36m [INFO][CHF][Acct] [0mOpen Account Balance Management Server
2025-12-05T18:56:24.835805144Z[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-12-05T18:56:24.836868285Z[36m [INFO][NRF][NFM] [0murilist update
2025-12-05T18:56:24.837458879Z[36m [INFO][NRF][NFM] [0mCreate NF Profile: d59b4a2c-fdb3-48fa-adc3-48d405af1e6e
2025-12-05T18:56:24.838450015Z[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/d59b4a2c-fdb3-48fa-adc3-48d405af1e6e |  |
2025-12-05T18:56:24.838566756Z[36m [INFO][CHF][Main] [0mOAuth2 setting receive from NRF: false
2025-12-05T18:56:24.838580369Z[36m [INFO][CHF][SBI] [0mStart SBI server (listen on 127.0.0.113:8000)
=== RUN   TestCN
2025-12-05T18:56:31.919283758Z[36m [INFO][N3IWF][Main] [0mN3IWF version:  
	free5GC version: v4.1.0-26-gf454591
	build time:      2025-12-05T18:52:41Z
	commit hash:     a08e0bf5
	commit time:     2025-11-24T08:29:45Z
	go version:      go1.24.2 linux/amd64
2025-12-05T18:56:31.919957256Z[36m [INFO][N3IWF][CFG] [0mRead config from [./config/n3iwfcfg.test.yaml]
2025-12-05T18:56:31.920691330Z[36m [INFO][N3IWF][Main] [0mLog enable is set to [true]
2025-12-05T18:56:31.920707274Z[36m [INFO][N3IWF][Main] [0mLog level is set to [info]
2025-12-05T18:56:31.920710874Z[36m [INFO][N3IWF][Main] [0mReport Caller is set to [false]
2025-12-05T18:56:31.920941794Z[33m [WARN][N3IWF][CTX] [0mParse PKCS8 private key failed: x509: failed to parse private key (use ParsePKCS1PrivateKey instead for this key format)
2025-12-05T18:56:31.920947769Z[36m [INFO][N3IWF][CTX] [0mParse using PKCS1...
2025-12-05T18:56:31.922025864Z[33m [WARN][N3IWF][Main] [0mnetlink.RouteAdd: file exists
2025-12-05T18:56:31.922036687Z[36m [INFO][N3IWF][Main] [0mSetup XFRM interface xfrmi-default
2025-12-05T18:56:31.924444495Z[36m [INFO][N3IWF][NGAP] [0mSend NG Setup Request
2025-12-05T18:56:31.924477876Z[36m [INFO][AMF][Ngap] [0m[AMF] SCTP Accept from: 10.200.200.1/10.0.2.15/172.17.0.1/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57451
2025-12-05T18:56:31.924795701Z[36m [INFO][AMF][Ngap] [0mCreate a new NG connection for: 10.200.200.1/10.0.2.15/172.17.0.1/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57451
2025-12-05T18:56:31.924893020Z[36m [INFO][N3IWF][Main] [0mNGAP service running.
2025-12-05T18:56:31.925021314Z[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/172.17.0.1/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57451] [0mHandle NGSetupRequest
2025-12-05T18:56:31.925028383Z[33m [WARN][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/172.17.0.1/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57451] [0mMissing IE PagingDRX
2025-12-05T18:56:31.925054033Z[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/172.17.0.1/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57451] [0mSend NG-Setup response
2025-12-05T18:56:31.925229259Z[36m [INFO][N3IWF][NGAP] [0mHandle NG Setup Response
2025-12-05T18:56:31.925231492Z[36m [INFO][N3IWF][Main] [0mNAS TCP server successfully started.
2025-12-05T18:56:31.925614670Z[36m [INFO][N3IWF][Main] [0mListening NWu user plane traffic
2025-12-05T18:56:31.925889461Z[36m [INFO][N3IWF][Main] [0mIKE service running
2025-12-05T18:56:31.925896235Z[36m [INFO][N3IWF][Main] [0mN3IWF started
Run TestNon3GPPUE
os.Args: [/tmp/go-build628257400/b001/test.test -test.paniconexit0 -test.v=true -test.timeout=0s -test.run=TestNon3GPPUE noinit]
MongoDB Set
=== RUN   TestNon3GPPUE
2025-12-05T18:56:35.872571888Z[36m [INFO][N3IWF][IKE] [0mHandle IKE_SA_INIT
    non3gpp_test.go:955: Get SA payload
2025-12-05T18:56:35.879750504Z[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-12-05T18:56:35.879763854Z[36m [INFO][N3IWF][IKE] [0mEcoding initiator for later IKE authentication
2025-12-05T18:56:35.879768385Z[36m [INFO][N3IWF][IKE] [0mParsing security association
2025-12-05T18:56:35.879777095Z[36m [INFO][N3IWF][IKE] [0mReceived traffic selector initiator from UE
2025-12-05T18:56:35.879779372Z[36m [INFO][N3IWF][IKE] [0mReceived traffic selector initiator from UE
    non3gpp_test.go:1064: Get IDr
    non3gpp_test.go:1068: Get CERT
    non3gpp_test.go:1066: Get AUTH
    non3gpp_test.go:1071: Get EAP
2025-12-05T18:56:35.880644436Z[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-12-05T18:56:35.880654219Z[36m [INFO][N3IWF][IKE] [0mEAP5G MessageID : 2
2025-12-05T18:56:35.880703966Z[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-12-05T18:56:35.880751360Z[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-12-05T18:56:35.880754983Z[36m [INFO][N3IWF][IKE] [0mHandle UnmarshalEAP5GDataResponse event
2025-12-05T18:56:35.880764777Z[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-12-05T18:56:35.880768683Z[36m [INFO][N3IWF][NGAP] [0mSend Initial UE Message
2025-12-05T18:56:35.880972921Z[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/172.17.0.1/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57451] [0mHandle InitialUEMessage
2025-12-05T18:56:35.881019123Z[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/172.17.0.1/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57451] [0mNew RanUe [RanUeNgapID:0][AmfUeNgapID:1]
2025-12-05T18:56:35.881051416Z[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/172.17.0.1/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57451] [0m5GSMobileIdentity ["SUCI":"suci-0-208-93-0-0-0-0000007487", err: <nil>]
2025-12-05T18:56:35.881094871Z[36m [INFO][AMF][CTX] [0mNew AmfUe [supi:][guti:20893cafe0000000001]
2025-12-05T18:56:35.881120237Z[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [Deregistered] to [Deregistered]
2025-12-05T18:56:35.881123848Z[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mHandle Registration Request
2025-12-05T18:56:35.881127776Z[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mRegistrationType: Initial Registration
2025-12-05T18:56:35.881132537Z[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mMobileIdentity5GS: SUCI[suci-0-208-93-0-0-0-0000007487]
2025-12-05T18:56:35.881149269Z[36m [INFO][AMF][Gmm] [0mHandle event[Start Authentication], transition from [Deregistered] to [Authentication]
2025-12-05T18:56:35.881153241Z[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mAuthentication procedure
2025-12-05T18:56:35.881659579Z[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-12-05T18:56:35.882788909Z[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&target-nf-type=AUSF |  |
2025-12-05T18:56:35.883424066Z[36m [INFO][AUSF][UeAuth] [0mHandleUeAuthPostRequest
2025-12-05T18:56:35.883435239Z[36m [INFO][AUSF][UeAuth] [0mServing network authorized
2025-12-05T18:56:35.883656762Z[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-12-05T18:56:35.884433084Z[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AUSF&service-names=nudm-ueau&target-nf-type=UDM |  |
2025-12-05T18:56:35.886203209Z[36m [INFO][UDM][UEAU] [0mHandle GenerateAuthDataRequest
2025-12-05T18:56:35.886297888Z[36m [INFO][UDM][Suci] [0mscheme 0
2025-12-05T18:56:35.886308197Z[36m [INFO][UDM][Suci] [0mSUPI type is IMSI
2025-12-05T18:56:35.886942751Z[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-12-05T18:56:35.887425860Z[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=UDM&target-nf-type=UDR |  |
2025-12-05T18:56:35.888148364Z[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v2/subscription-data/imsi-208930000007487/authentication-data/authentication-subscription |  |
2025-12-05T18:56:35.888277284Z[36m [INFO][UDM][Proc] [0mModifyAuthenticationSubscriptionRequest:  [{replace /sequenceNumber  { 16f3b3f70fc3 map[] 0 }}]
2025-12-05T18:56:35.889586680Z[36m [INFO][UDR][GIN] [0m| 204 |       127.0.0.1 | PATCH   | /nudr-dr/v2/subscription-data/imsi-208930000007487/authentication-data/authentication-subscription |  |
2025-12-05T18:56:35.889712557Z[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | POST    | /nudm-ueau/v1/suci-0-208-93-0-0-0-0000007487/security-information/generate-auth-data |  |
2025-12-05T18:56:35.889790100Z[36m [INFO][AUSF][UeAuth] [0mAdd SuciSupiPair (suci-0-208-93-0-0-0-0000007487, imsi-208930000007487) to map.
2025-12-05T18:56:35.889794838Z[36m [INFO][AUSF][UeAuth] [0mUse 5G AKA auth method
2025-12-05T18:56:35.889799150Z[36m [INFO][AUSF][5gAka] [0mXresStar = 3630326630323137623065663466353239643738613636343939366433333361
2025-12-05T18:56:35.889825085Z[36m [INFO][AUSF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nausf-auth/v1/ue-authentications |  |
2025-12-05T18:56:35.889889703Z[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mSend Authentication Request
2025-12-05T18:56:35.889906665Z[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/172.17.0.1/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57451] [0mSend Downlink Nas Transport
2025-12-05T18:56:35.889965396Z[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mStart T3560 timer
2025-12-05T18:56:35.890067977Z[36m [INFO][N3IWF][NGAP] [0mHandle Downlink NAS Transport
2025-12-05T18:56:35.890085934Z[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-12-05T18:56:35.890089611Z[36m [INFO][N3IWF][IKE] [0mHandle SendEAPNASMsg event
2025-12-05T18:56:35.890347238Z[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-12-05T18:56:35.890366935Z[36m [INFO][N3IWF][IKE] [0mEAP5G MessageID : 2
2025-12-05T18:56:35.890434903Z[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-12-05T18:56:35.890439794Z[36m [INFO][N3IWF][NGAP] [0mSend Uplink NAS Transport
2025-12-05T18:56:35.890618702Z[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/172.17.0.1/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57451] [0mHandle UplinkNASTransport
2025-12-05T18:56:35.890631801Z[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/172.17.0.1/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57451] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-12-05T18:56:35.890650492Z[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [Authentication] to [Authentication]
2025-12-05T18:56:35.890653895Z[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mHandle Authentication Response
2025-12-05T18:56:35.890658163Z[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mStop T3560 timer
2025-12-05T18:56:35.890801987Z[36m [INFO][AUSF][5gAka] [0mAuth5gAkaComfirmRequest
2025-12-05T18:56:35.890807623Z[36m [INFO][AUSF][5gAka] [0mres*: 3630326630323137623065663466353239643738613636343939366433333361
Xres*: 3630326630323137623065663466353239643738613636343939366433333361
2025-12-05T18:56:35.890814977Z[36m [INFO][AUSF][5gAka] [0m5G AKA confirmation succeeded
2025-12-05T18:56:35.891061316Z[36m [INFO][UDM][UEAU] [0mHandle ConfirmAuthDataRequest
2025-12-05T18:56:35.891942397Z[36m [INFO][UDR][GIN] [0m| 204 |       127.0.0.1 | PUT     | /nudr-dr/v2/subscription-data/imsi-208930000007487/authentication-data/authentication-status |  |
2025-12-05T18:56:35.892014578Z[36m [INFO][UDM][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudm-ueau/v1/imsi-208930000007487/auth-events |  |
2025-12-05T18:56:35.892074951Z[36m [INFO][AUSF][GIN] [0m| 200 |       127.0.0.1 | PUT     | /nausf-auth/v1/ue-authentications/suci-0-208-93-0-0-0-0000007487/5g-aka-confirmation |  |
2025-12-05T18:56:35.892135706Z[36m [INFO][AMF][Gmm] [0mHandle event[Authentication Success], transition from [Authentication] to [SecurityMode]
2025-12-05T18:56:35.892151125Z[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-208930000007487] [0mSend Security Mode Command
2025-12-05T18:56:35.892162178Z[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/172.17.0.1/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57451] [0mSend Downlink Nas Transport
2025-12-05T18:56:35.892201846Z[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-208930000007487] [0mStart T3560 timer
2025-12-05T18:56:35.892262704Z[36m [INFO][N3IWF][NGAP] [0mHandle Downlink NAS Transport
2025-12-05T18:56:35.892277400Z[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-12-05T18:56:35.892280978Z[36m [INFO][N3IWF][IKE] [0mHandle SendEAPNASMsg event
2025-12-05T18:56:35.892434569Z[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-12-05T18:56:35.892444429Z[36m [INFO][N3IWF][IKE] [0mEAP5G MessageID : 2
2025-12-05T18:56:35.892457571Z[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-12-05T18:56:35.892461642Z[36m [INFO][N3IWF][NGAP] [0mSend Uplink NAS Transport
2025-12-05T18:56:35.892636824Z[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/172.17.0.1/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57451] [0mHandle UplinkNASTransport
2025-12-05T18:56:35.892651444Z[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/172.17.0.1/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57451] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-12-05T18:56:35.892669730Z[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [SecurityMode] to [SecurityMode]
2025-12-05T18:56:35.892673013Z[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-208930000007487] [0mHandle Security Mode Complete
2025-12-05T18:56:35.892676581Z[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-208930000007487] [0mStop T3560 timer
2025-12-05T18:56:35.892699255Z[36m [INFO][AMF][Gmm] [0mHandle event[SecurityMode Success], transition from [SecurityMode] to [ContextSetup]
2025-12-05T18:56:35.892703085Z[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-208930000007487] [0mHandle InitialRegistration
2025-12-05T18:56:35.892941063Z[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-12-05T18:56:35.893703936Z[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&supi=imsi-208930000007487&target-nf-type=UDM |  |
2025-12-05T18:56:35.894083955Z[36m [INFO][UDM][Consumer] [0mTwoLayerPathHandlerFunc,  imsi-208930000007487 nssai
2025-12-05T18:56:35.894113830Z[36m [INFO][UDM][SDM] [0mHandle GetNssai
2025-12-05T18:56:35.894359167Z[36m [INFO][UDR][DataRepo] [0mQueryAmDataProcedure: ueId: imsi-208930000007487, servingPlmnId: 20893
2025-12-05T18:56:35.894738521Z[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v2/subscription-data/imsi-208930000007487/20893/provisioned-data/am-data?supported-features= |  |
2025-12-05T18:56:35.894841080Z[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v2/imsi-208930000007487/nssai?plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-12-05T18:56:35.894963554Z[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-12-05T18:56:35.895521369Z[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&supi=imsi-208930000007487&target-nf-type=UDM |  |
2025-12-05T18:56:35.895870659Z[36m [INFO][UDM][UECM] [0mHandle RegisterAmfNon3gppAccessRequest
2025-12-05T18:56:35.907109138Z[36m [INFO][UDR][GIN] [0m| 204 |       127.0.0.1 | PUT     | /nudr-dr/v2/subscription-data/imsi-208930000007487/context-data/amf-non-3gpp-access |  |
2025-12-05T18:56:35.907177904Z[36m [INFO][UDM][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nudm-uecm/v1/imsi-208930000007487/registrations/amf-non-3gpp-access |  |
2025-12-05T18:56:35.907299601Z[36m [INFO][UDM][Consumer] [0mTwoLayerPathHandlerFunc,  imsi-208930000007487 am-data
2025-12-05T18:56:35.907310676Z[36m [INFO][UDM][SDM] [0mHandle GetAmData
2025-12-05T18:56:35.907368969Z[36m [INFO][UDR][DataRepo] [0mQueryAmDataProcedure: ueId: imsi-208930000007487, servingPlmnId: 20893
2025-12-05T18:56:35.907673662Z[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v2/subscription-data/imsi-208930000007487/20893/provisioned-data/am-data?supported-features= |  |
2025-12-05T18:56:35.907772894Z[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v2/imsi-208930000007487/am-data?plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-12-05T18:56:35.907926983Z[36m [INFO][UDM][Consumer] [0mTwoLayerPathHandlerFunc,  imsi-208930000007487 smf-select-data
2025-12-05T18:56:35.907940169Z[36m [INFO][UDM][SDM] [0mHandle GetSmfSelectData
2025-12-05T18:56:35.908421089Z[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v2/subscription-data/imsi-208930000007487/20893/provisioned-data/smf-selection-subscription-data?supported-features= |  |
2025-12-05T18:56:35.908549046Z[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v2/imsi-208930000007487/smf-select-data?plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-12-05T18:56:35.908671991Z[36m [INFO][UDM][Consumer] [0mTwoLayerPathHandlerFunc,  imsi-208930000007487 ue-context-in-smf-data
2025-12-05T18:56:35.908682737Z[36m [INFO][UDM][SDM] [0mHandle GetUeContextInSmfData
2025-12-05T18:56:35.909025799Z[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v2/subscription-data/imsi-208930000007487/context-data/smf-registrations?supported-features= |  |
2025-12-05T18:56:35.909148823Z[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v2/imsi-208930000007487/ue-context-in-smf-data |  |
2025-12-05T18:56:35.909429775Z[36m [INFO][UDM][Consumer] [0mTwoLayerPathHandlerFunc,  imsi-208930000007487 sdm-subscriptions
2025-12-05T18:56:35.909450873Z[36m [INFO][UDM][SDM] [0mHandle Subscribe
2025-12-05T18:56:35.909531961Z[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v2/subscription-data/imsi-208930000007487/context-data/sdm-subscriptions |  |
2025-12-05T18:56:35.909578426Z[36m [INFO][UDM][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudm-sdm/v2/imsi-208930000007487/sdm-subscriptions |  |
2025-12-05T18:56:35.909800621Z[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-12-05T18:56:35.910462865Z[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&supi=imsi-208930000007487&target-nf-type=PCF |  |
2025-12-05T18:56:35.911024503Z[36m [INFO][PCF][AmPol] [0mHandle AM Policy Create Request
2025-12-05T18:56:35.911116121Z[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-12-05T18:56:35.911728910Z[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=UDR |  |
2025-12-05T18:56:35.912330384Z[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v2/policy-data/ues/imsi-208930000007487/am-data |  |
2025-12-05T18:56:35.912632456Z[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-12-05T18:56:35.913338764Z[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?guami=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22amfId%22%3A%22cafe00%22%7D&requester-nf-type=PCF&target-nf-type=AMF |  |
2025-12-05T18:56:35.913700306Z[36m [INFO][AMF][Comm] [0mHandle AMF Status Change Subscribe Request
2025-12-05T18:56:35.913714860Z[36m [INFO][AMF][Comm] [0mnew AMF Status Subscription[1]
2025-12-05T18:56:35.913726864Z[36m [INFO][AMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /namf-comm/v1/subscriptions |  |
2025-12-05T18:56:35.913912343Z[36m [INFO][PCF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-am-policy-control/v1/policies |  |
2025-12-05T18:56:35.914015531Z[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-208930000007487] [0mSend Registration Accept
2025-12-05T18:56:35.914033346Z[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/172.17.0.1/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57451] [0mSend Initial Context Setup Request
2025-12-05T18:56:35.914123780Z[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-208930000007487] [0mStart T3550 timer
2025-12-05T18:56:35.914241267Z[36m [INFO][N3IWF][NGAP] [0mHandle Initial Context Setup Request
2025-12-05T18:56:35.914259793Z[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-12-05T18:56:35.914263711Z[36m [INFO][N3IWF][IKE] [0mHandle SendEAPSuccessMsg event
2025-12-05T18:56:35.914377308Z[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-12-05T18:56:35.914418180Z[36m [INFO][N3IWF][IKE] [0mInbound SPI: 0x021faad9, Outbound SPI: 0x83f8ea2d
2025-12-05T18:56:35.940611325Z[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-12-05T18:56:35.940623176Z[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-12-05T18:56:35.940631482Z[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-12-05T18:56:35.940635115Z[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
    non3gpp_test.go:1389: Get Authentication from N3IWF
2025-12-05T18:56:35.940670352Z[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-12-05T18:56:35.940673963Z[36m [INFO][N3IWF][NGAP] [0mSend Initial Context Setup Response
2025-12-05T18:56:35.940803780Z[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/172.17.0.1/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57451] [0mHandle InitialContextSetupResponse
2025-12-05T18:56:35.940816409Z[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/172.17.0.1/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57451] [0mHandle InitialContextSetupResponse (RAN UE NGAP ID: 0)
2025-12-05T18:56:35.940821617Z[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/172.17.0.1/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57451] [0mSend Downlink Nas Transport
2025-12-05T18:56:35.940913506Z[36m [INFO][N3IWF][NGAP] [0mHandle Downlink NAS Transport
2025-12-05T18:56:35.941407629Z[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
Security header type: Integrity Protected And Ciphered
cmac value: 0x13966d5f
err <nil>
    non3gpp_test.go:1494: Get NAS Security Mode Command Message:
         (*nas.Message)(0xc000c81d60)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc000cf54a0)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 42                                          |~.B|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(0xc000000000)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			RegistrationAcceptMessageIdentity: (nasType.RegistrationAcceptMessageIdentity) {
        				Octet: (uint8) 66
        			},
        			RegistrationResult5GS: (nasType.RegistrationResult5GS) {
        				Iei: (uint8) 0,
        				Len: (uint8) 1,
        				Octet: (uint8) 2
        			},
        			GUTI5G: (*nasType.GUTI5G)(0xc000f0e5a0)({
        				Iei: (uint8) 119,
        				Len: (uint16) 11,
        				Octet: ([11]uint8) (len=11 cap=11) {
        					00000000  f2 02 f8 39 ca fe 00 00  00 00 01                 |...9.......|
        				}
        			}),
        			EquivalentPlmns: (*nasType.EquivalentPlmns)(<nil>),
        			TAIList: (*nasType.TAIList)(0xc000c81d80)({
        				Iei: (uint8) 84,
        				Len: (uint8) 7,
        				Buffer: ([]uint8) (len=7 cap=7) {
        					00000000  00 02 f8 39 00 00 01                              |...9...|
        				}
        			}),
        			AllowedNSSAI: (*nasType.AllowedNSSAI)(0xc000c81da0)({
        				Iei: (uint8) 21,
        				Len: (uint8) 10,
        				Buffer: ([]uint8) (len=10 cap=10) {
        					00000000  04 01 fe dc ba 04 01 11  22 33                    |........"3|
        				}
        			}),
        			RejectedNSSAI: (*nasType.RejectedNSSAI)(<nil>),
        			ConfiguredNSSAI: (*nasType.ConfiguredNSSAI)(<nil>),
        			NetworkFeatureSupport5GS: (*nasType.NetworkFeatureSupport5GS)(0xc000f0e5db)({
        				Iei: (uint8) 33,
        				Len: (uint8) 1,
        				Octet: ([3]uint8) (len=3 cap=3) {
        					00000000  00 00 00                                          |...|
        				}
        			}),
        			PDUSessionStatus: (*nasType.PDUSessionStatus)(<nil>),
        			PDUSessionReactivationResult: (*nasType.PDUSessionReactivationResult)(<nil>),
        			PDUSessionReactivationResultErrorCause: (*nasType.PDUSessionReactivationResultErrorCause)(<nil>),
        			LADNInformation: (*nasType.LADNInformation)(<nil>),
        			MICOIndication: (*nasType.MICOIndication)(<nil>),
        			NetworkSlicingIndication: (*nasType.NetworkSlicingIndication)(<nil>),
        			ServiceAreaList: (*nasType.ServiceAreaList)(<nil>),
        			T3512Value: (*nasType.T3512Value)(<nil>),
        			Non3GppDeregistrationTimerValue: (*nasType.Non3GppDeregistrationTimerValue)(0xc000f0e5f3)({
        				Iei: (uint8) 93,
        				Len: (uint8) 1,
        				Octet: (uint8) 73
        			}),
        			T3502Value: (*nasType.T3502Value)(0xc000f0e5f9)({
        				Iei: (uint8) 22,
        				Len: (uint8) 1,
        				Octet: (uint8) 44
        			}),
        			EmergencyNumberList: (*nasType.EmergencyNumberList)(<nil>),
        			ExtendedEmergencyNumberList: (*nasType.ExtendedEmergencyNumberList)(<nil>),
        			SORTransparentContainer: (*nasType.SORTransparentContainer)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			NSSAIInclusionMode: (*nasType.NSSAIInclusionMode)(<nil>),
        			OperatordefinedAccessCategoryDefinitions: (*nasType.OperatordefinedAccessCategoryDefinitions)(<nil>),
        			NegotiatedDRXParameters: (*nasType.NegotiatedDRXParameters)(<nil>),
        			Non3GppNwPolicies: (*nasType.Non3GppNwPolicies)(<nil>),
        			EPSBearerContextStatus: (*nasType.EPSBearerContextStatus)(<nil>)
        		}),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(<nil>),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(<nil>)
        })
2025-12-05T18:56:35.941850215Z[36m [INFO][N3IWF][NGAP] [0mSend Uplink NAS Transport
2025-12-05T18:56:35.941956346Z[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/172.17.0.1/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57451] [0mHandle UplinkNASTransport
2025-12-05T18:56:35.941966392Z[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/172.17.0.1/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57451] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-12-05T18:56:35.941984634Z[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [ContextSetup] to [ContextSetup]
2025-12-05T18:56:35.941987938Z[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-208930000007487] [0mHandle Registration Complete
2025-12-05T18:56:35.941991495Z[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-208930000007487] [0mStop T3550 timer
2025-12-05T18:56:35.942007067Z[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-208930000007487] [0mSend Configuration Update Command
2025-12-05T18:56:35.942011433Z[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/172.17.0.1/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57451] [0mSend Downlink Nas Transport
2025-12-05T18:56:35.942049668Z[36m [INFO][AMF][Gmm] [0mHandle event[ContextSetup Success], transition from [ContextSetup] to [Registered]
2025-12-05T18:56:35.942096198Z[36m [INFO][N3IWF][NGAP] [0mHandle Downlink NAS Transport
2025-12-05T18:56:37.066881257Z[36m [INFO][N3IWF][NGAP] [0mSend Uplink NAS Transport
2025-12-05T18:56:37.067115219Z[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/172.17.0.1/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57451] [0mHandle UplinkNASTransport
2025-12-05T18:56:37.067136460Z[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/172.17.0.1/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57451] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-12-05T18:56:37.067195104Z[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-12-05T18:56:37.067200017Z[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-208930000007487] [0mHandle UL NAS Transport
2025-12-05T18:56:37.067203891Z[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-208930000007487] [0mTransport 5GSM Message to SMF
2025-12-05T18:56:37.067212766Z[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-208930000007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-12-05T18:56:37.067635594Z[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-12-05T18:56:37.068336190Z[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&target-nf-type=NSSF |  |
2025-12-05T18:56:37.068771707Z[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-12-05T18:56:37.068903056Z[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-12-05T18:56:37.068969973Z[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v2/network-slice-information?nf-id=afb10138-6a20-44f0-984f-c8f78a942262&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-12-05T18:56:37.069065765Z[33m [WARN][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-208930000007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-12-05T18:56:37.069177300Z[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-12-05T18:56:37.069880314Z[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%5B%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%5D&target-nf-type=SMF&target-plmn-list=%5B%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%5D |  |
2025-12-05T18:56:37.070416564Z[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-12-05T18:56:37.070491360Z[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-12-05T18:56:37.070513793Z[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-12-05T18:56:37.070516934Z[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-12-05T18:56:37.070641081Z[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-12-05T18:56:37.071253224Z[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-12-05T18:56:37.071389126Z[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-208930000007487] [0mSend NF Discovery Serving UDM Successfully
2025-12-05T18:56:37.071676123Z[36m [INFO][UDM][Consumer] [0mTwoLayerPathHandlerFunc,  imsi-208930000007487 sm-data
2025-12-05T18:56:37.071707563Z[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-12-05T18:56:37.071717225Z[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-208930000007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-12-05T18:56:37.072332487Z[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v2/subscription-data/imsi-208930000007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-12-05T18:56:37.072449775Z[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v2/imsi-208930000007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-12-05T18:56:37.072522776Z[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-12-05T18:56:37Z[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc0003814e0 0xc000381500 0xc000381520]
2025-12-05T18:56:37.072534605Z[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-12-05T18:56:37.072544662Z[36m [INFO][SMF][GSM] [0m&{[0xc0003814e0 0xc000381500 0xc000381520]}
2025-12-05T18:56:37.072547256Z[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-12-05T18:56:37.072618790Z[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-12-05T18:56:37.073268468Z[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=afb10138-6a20-44f0-984f-c8f78a942262&target-nf-type=AMF |  |
2025-12-05T18:56:37.073385427Z[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-12-05T18:56:37.073400080Z[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.1
2025-12-05T18:56:37.073403046Z[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-12-05T18:56:37.073405650Z[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-208930000007487] [0mAllocated PDUAdress[10.60.0.1]
2025-12-05T18:56:37.073501402Z[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-12-05T18:56:37.073798484Z[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=BSF |  |
2025-12-05T18:56:37.073867742Z[33m [WARN][SMF][Consumer] [0mBSF selection failed: no BSF instances found
2025-12-05T18:56:37.073871594Z[33m [WARN][SMF][Consumer] [0mBSF query error (falling back to NRF): no BSF instances found
2025-12-05T18:56:37.073874461Z[36m [INFO][SMF][Consumer] [0mNo PCF binding found in BSF, using NRF discovery for SUPI: imsi-208930000007487, DNN: internet
2025-12-05T18:56:37.073945274Z[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-12-05T18:56:37.074552247Z[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?preferred-locality=area1&requester-nf-type=SMF&target-nf-type=PCF |  |
2025-12-05T18:56:37.075125197Z[36m [INFO][PCF][SMpolicy] [0mHandle CreateSmPolicy
2025-12-05T18:56:37.075957066Z[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v2/policy-data/ues/imsi-208930000007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-12-05T18:56:37.078457399Z[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v2/application-data/influenceData?dnns=internet&snssais=%5B%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%5D&supis=imsi-208930000007487 |  |
2025-12-05T18:56:37.078551969Z[36m [INFO][PCF][SMpolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-12-05T18:56:37.078669530Z[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v2/application-data/influenceData/subs-to-notify |  |
2025-12-05T18:56:37.079126922Z[36m [INFO][PCF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-12-05T18:56:37.079282686Z[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-208930000007487] PDUSessionID[1]
2025-12-05T18:56:37.079515165Z[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-12-05T18:56:37.080023191Z[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-12-05T18:56:37.080138093Z[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-12-05T18:56:37.081481675Z[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-12-05T18:56:37.081506943Z[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-12-05T18:56:37.081518247Z[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-12-05T18:56:37.081521650Z[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-208930000007487
2025-12-05T18:56:37.081524473Z[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-208930000007487
2025-12-05T18:56:37.081746515Z[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-12-05T18:56:37.081934159Z[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-12-05T18:56:37.082004435Z[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-208930000007487] [0mInstall PCCRule[PccRuleId-1]
2025-12-05T18:56:37.082010454Z[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-208930000007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-12-05T18:56:37.082030852Z[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-208930000007487] [0mInstall PCCRule[PccRuleId-2]
2025-12-05T18:56:37.082034178Z[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-208930000007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-12-05T18:56:37.082048459Z[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-208930000007487] [0mHas default path
2025-12-05T18:56:37.082224839Z[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-12-05T18:56:37.082414997Z[36m [INFO][UDM][Consumer] [0mTwoLayerPathHandlerFunc,  imsi-208930000007487 sdm-subscriptions
2025-12-05T18:56:37.082440669Z[36m [INFO][UDM][SDM] [0mHandle Subscribe
2025-12-05T18:56:37.082499231Z[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-12-05T18:56:37.082519224Z[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x1][UPSEID:0x1] [0mNew session
2025-12-05T18:56:37.082701672Z[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v2/subscription-data/imsi-208930000007487/context-data/sdm-subscriptions |  |
2025-12-05T18:56:37.082824179Z[36m [INFO][UDM][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudm-sdm/v2/imsi-208930000007487/sdm-subscriptions |  |
2025-12-05T18:56:37.082930685Z[36m [INFO][SMF][PduSess] [0mSDM Subscription Successful UE: imsi-208930000007487 SubscriptionId: 2
2025-12-05T18:56:37.082943587Z[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-12-05T18:56:37.083039648Z[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-208930000007487] [0mcreate smContext[pduSessionID: 1] Success
2025-12-05T18:56:37.083196658Z[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:1 urrid:1 period:30000000000}]
2025-12-05T18:56:37.083211464Z[36m [INFO][UPF][Perio] [0mnew ticker [30s]
2025-12-05T18:56:37.083256446Z[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:1 urrid:2 period:30000000000}]
2025-12-05T18:56:37.084064957Z[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-12-05T18:56:37.084704873Z[36m [INFO][AMF][Producer] [0mHandle N1N2 Message Transfer Request
2025-12-05T18:56:37.084724341Z[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/172.17.0.1/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57451] [0mSend PDU Session Resource Setup Request
2025-12-05T18:56:37.084839243Z[36m [INFO][AMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-208930000007487/n1-n2-messages |  |
2025-12-05T18:56:37.084907886Z[36m [INFO][N3IWF][NGAP] [0mHandle PDU Session Resource Setup Request
2025-12-05T18:56:37.084996940Z[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-12-05T18:56:37.085001908Z[36m [INFO][N3IWF][IKE] [0mHandle CreatePDUSession event
    non3gpp_test.go:1558: Received Qos Flow settings
    non3gpp_test.go:1561: NotificationData:[6 1 2 1 2 2]
    non3gpp_test.go:1571: UP IP Address: 10.0.0.1
2025-12-05T18:56:37.085263625Z[36m [INFO][N3IWF][IKE] [0mHandle CREATE_CHILD_SA
2025-12-05T18:56:37.085279635Z[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-12-05T18:56:37.085293215Z[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-12-05T18:56:37.085296465Z[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-12-05T18:56:37.085420384Z[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-12-05T18:56:37.085487367Z[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
Security header type: Integrity Protected And Ciphered
cmac value: 0x221ccfdf
err <nil>
2025-12-05T18:56:37.085510150Z[36m [INFO][N3IWF][NGAP] [0mSend PDU Session Resource Setup Response
    non3gpp_test.go:1675: Dump DecodePDUSessionEstablishmentAccept:
         (*nas.Message)(0xc000b8e460)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc000208c30)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 68                                          |~.h|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(<nil>),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(0xc000b90190)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			DLNASTRANSPORTMessageIdentity: (nasType.DLNASTRANSPORTMessageIdentity) {
        				Octet: (uint8) 104
        			},
        			SpareHalfOctetAndPayloadContainerType: (nasType.SpareHalfOctetAndPayloadContainerType) {
        				Octet: (uint8) 1
        			},
        			PayloadContainer: (nasType.PayloadContainer) {
        				Iei: (uint8) 0,
        				Len: (uint16) 109,
        				Buffer: ([]uint8) (len=109 cap=109) {
        					00000000  2e 01 00 c2 11 00 1a 01  00 06 31 31 01 01 ff 01  |..........11....|
        					00000010  02 00 0e 21 11 09 10 09  09 09 09 ff ff ff ff 80  |...!............|
        					00000020  02 06 01 03 e8 01 03 e8  29 05 01 0a 3c 00 01 22  |........)...<.."|
        					00000030  04 01 fe dc ba 79 00 0c  01 20 41 01 01 09 02 20  |.....y... A.... |
        					00000040  41 01 01 08 7b 00 1b 80  00 0d 04 08 08 08 08 00  |A...{...........|
        					00000050  03 10 20 01 48 60 48 60  00 00 00 00 00 00 00 00  |.. .H`H`........|
        					00000060  88 88 25 09 08 69 6e 74  65 72 6e 65 74           |..%..internet|
        				}
        			},
        			PduSessionID2Value: (*nasType.PduSessionID2Value)(0xc00065e2f4)({
        				Iei: (uint8) 18,
        				Octet: (uint8) 1
        			}),
        			AdditionalInformation: (*nasType.AdditionalInformation)(<nil>),
        			Cause5GMM: (*nasType.Cause5GMM)(<nil>),
        			BackoffTimerValue: (*nasType.BackoffTimerValue)(<nil>)
        		}),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(0xc000c20120)({
        		GsmHeader: (nas.GsmHeader) {
        			Octet: ([4]uint8) (len=4 cap=4) {
        				00000000  2e 01 00 c2                                       |....|
        			}
        		},
        		PDUSessionEstablishmentRequest: (*nasMessage.PDUSessionEstablishmentRequest)(<nil>),
        		PDUSessionEstablishmentAccept: (*nasMessage.PDUSessionEstablishmentAccept)(0xc00063a080)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 46
        			},
        			PDUSessionID: (nasType.PDUSessionID) {
        				Octet: (uint8) 1
        			},
        			PTI: (nasType.PTI) {
        				Octet: (uint8) 0
        			},
        			PDUSESSIONESTABLISHMENTACCEPTMessageIdentity: (nasType.PDUSESSIONESTABLISHMENTACCEPTMessageIdentity) {
        				Octet: (uint8) 194
        			},
        			SelectedSSCModeAndSelectedPDUSessionType: (nasType.SelectedSSCModeAndSelectedPDUSessionType) {
        				Octet: (uint8) 17
        			},
        			AuthorizedQosRules: (nasType.AuthorizedQosRules) {
        				Iei: (uint8) 0,
        				Len: (uint16) 26,
        				Buffer: ([]uint8) (len=26 cap=26) {
        					00000000  01 00 06 31 31 01 01 ff  01 02 00 0e 21 11 09 10  |...11.......!...|
        					00000010  09 09 09 09 ff ff ff ff  80 02                    |..........|
        				}
        			},
        			SessionAMBR: (nasType.SessionAMBR) {
        				Iei: (uint8) 0,
        				Len: (uint8) 6,
        				Octet: ([6]uint8) (len=6 cap=6) {
        					00000000  01 03 e8 01 03 e8                                 |......|
        				}
        			},
        			Cause5GSM: (*nasType.Cause5GSM)(<nil>),
        			PDUAddress: (*nasType.PDUAddress)(0xc00065e310)({
        				Iei: (uint8) 41,
        				Len: (uint8) 5,
        				Octet: ([13]uint8) (len=13 cap=13) {
        					00000000  01 0a 3c 00 01 00 00 00  00 00 00 00 00           |..<..........|
        				}
        			}),
        			RQTimerValue: (*nasType.RQTimerValue)(<nil>),
        			SNSSAI: (*nasType.SNSSAI)(0xc00065e326)({
        				Iei: (uint8) 34,
        				Len: (uint8) 4,
        				Octet: ([8]uint8) (len=8 cap=8) {
        					00000000  01 fe dc ba 00 00 00 00                           |........|
        				}
        			}),
        			AlwaysonPDUSessionIndication: (*nasType.AlwaysonPDUSessionIndication)(<nil>),
        			MappedEPSBearerContexts: (*nasType.MappedEPSBearerContexts)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			AuthorizedQosFlowDescriptions: (*nasType.AuthorizedQosFlowDescriptions)(0xc000b8e480)({
        				Iei: (uint8) 121,
        				Len: (uint16) 12,
        				Buffer: ([]uint8) (len=12 cap=12) {
        					00000000  01 20 41 01 01 09 02 20  41 01 01 08              |. A.... A...|
        				}
        			}),
        			ExtendedProtocolConfigurationOptions: (*nasType.ExtendedProtocolConfigurationOptions)(0xc000b8e4a0)({
        				Iei: (uint8) 123,
        				Len: (uint16) 27,
        				Buffer: ([]uint8) (len=27 cap=27) {
        					00000000  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000010  60 00 00 00 00 00 00 00  00 88 88                 |`..........|
        				}
        			}),
        			DNN: (*nasType.DNN)(0xc000b8e4c0)({
        				Iei: (uint8) 37,
        				Len: (uint8) 9,
        				Buffer: ([]uint8) (len=9 cap=9) {
        					00000000  08 69 6e 74 65 72 6e 65  74                       |.internet|
        				}
        			})
        		}),
        		PDUSessionEstablishmentReject: (*nasMessage.PDUSessionEstablishmentReject)(<nil>),
        		PDUSessionAuthenticationCommand: (*nasMessage.PDUSessionAuthenticationCommand)(<nil>),
        		PDUSessionAuthenticationComplete: (*nasMessage.PDUSessionAuthenticationComplete)(<nil>),
        		PDUSessionAuthenticationResult: (*nasMessage.PDUSessionAuthenticationResult)(<nil>),
        		PDUSessionModificationRequest: (*nasMessage.PDUSessionModificationRequest)(<nil>),
        		PDUSessionModificationReject: (*nasMessage.PDUSessionModificationReject)(<nil>),
        		PDUSessionModificationCommand: (*nasMessage.PDUSessionModificationCommand)(<nil>),
        		PDUSessionModificationComplete: (*nasMessage.PDUSessionModificationComplete)(<nil>),
        		PDUSessionModificationCommandReject: (*nasMessage.PDUSessionModificationCommandReject)(<nil>),
        		PDUSessionReleaseRequest: (*nasMessage.PDUSessionReleaseRequest)(<nil>),
        		PDUSessionReleaseReject: (*nasMessage.PDUSessionReleaseReject)(<nil>),
        		PDUSessionReleaseCommand: (*nasMessage.PDUSessionReleaseCommand)(<nil>),
        		PDUSessionReleaseComplete: (*nasMessage.PDUSessionReleaseComplete)(<nil>),
        		Status5GSM: (*nasMessage.Status5GSM)(<nil>)
        	})
        })
        
2025-12-05T18:56:37.085650579Z[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/172.17.0.1/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57451] [0mHandle PDUSessionResourceSetupResponse
2025-12-05T18:56:37.085668537Z[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/172.17.0.1/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57451] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
    non3gpp_test.go:1681: PDU Address: 10.60.0.1
    non3gpp_test.go:264: GRE Key Field: 0x1000000
2025-12-05T18:56:37.086016613Z[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
2025-12-05T18:56:37.086225191Z[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
    non3gpp_test.go:1714: 2 times PDU Session Est Request Start
    non3gpp_test.go:641: Waiting for N3IWF reply from IKE
2025-12-05T18:56:37.095537080Z[36m [INFO][N3IWF][NGAP] [0mSend Uplink NAS Transport
2025-12-05T18:56:37.116336347Z[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-12-05T18:56:37.116431814Z[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:eab050e7-ab2d-4ad2-941e-086208d99fa4/modify |  |
2025-12-05T18:56:37.290647140Z[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/172.17.0.1/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57451] [0mHandle UplinkNASTransport
2025-12-05T18:56:37.290666914Z[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/172.17.0.1/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57451] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-12-05T18:56:37.290696832Z[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-12-05T18:56:37.290705248Z[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-208930000007487] [0mHandle UL NAS Transport
2025-12-05T18:56:37.290708662Z[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-208930000007487] [0mTransport 5GSM Message to SMF
2025-12-05T18:56:37.290715206Z[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-208930000007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-12-05T18:56:37.291029867Z[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-12-05T18:56:37.291103339Z[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-12-05T18:56:37.291115486Z[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v2/network-slice-information?nf-id=afb10138-6a20-44f0-984f-c8f78a942262&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-12-05T18:56:37.291214624Z[33m [WARN][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-208930000007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-12-05T18:56:37.291446934Z[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-12-05T18:56:37.350266981Z[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%5B%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%5D&target-nf-type=SMF&target-plmn-list=%5B%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%5D |  |
2025-12-05T18:56:37.351552140Z[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-12-05T18:56:37.351716560Z[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-12-05T18:56:37.351735819Z[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-12-05T18:56:37.351739190Z[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-12-05T18:56:37.372751321Z[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-12-05T18:56:37.373540526Z[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-12-05T18:56:37.373737364Z[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-208930000007487] [0mSend NF Discovery Serving UDM Successfully
2025-12-05T18:56:37.374012805Z[36m [INFO][UDM][Consumer] [0mTwoLayerPathHandlerFunc,  imsi-208930000007487 sm-data
2025-12-05T18:56:37.374043380Z[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-12-05T18:56:37.374052375Z[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-208930000007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-12-05T18:56:37.374732415Z[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v2/subscription-data/imsi-208930000007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-12-05T18:56:37.374887560Z[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v2/imsi-208930000007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-12-05T18:56:37.375004388Z[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-12-05T18:56:37Z[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc000d02260 0xc000d02280 0xc000d022a0]
2025-12-05T18:56:37.375021973Z[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-12-05T18:56:37.375026438Z[36m [INFO][SMF][GSM] [0m&{[0xc000d02260 0xc000d02280 0xc000d022a0]}
2025-12-05T18:56:37.375029086Z[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-12-05T18:56:37.375242180Z[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-12-05T18:56:37.375870710Z[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=afb10138-6a20-44f0-984f-c8f78a942262&target-nf-type=AMF |  |
2025-12-05T18:56:37.376029609Z[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-12-05T18:56:37.376041909Z[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.2
2025-12-05T18:56:37.376045324Z[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-12-05T18:56:37.376048256Z[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-208930000007487] [0mAllocated PDUAdress[10.60.0.2]
2025-12-05T18:56:37.376189000Z[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-12-05T18:56:37.376564626Z[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=BSF |  |
2025-12-05T18:56:37.376665386Z[33m [WARN][SMF][Consumer] [0mBSF selection failed: no BSF instances found
2025-12-05T18:56:37.376674371Z[33m [WARN][SMF][Consumer] [0mBSF query error (falling back to NRF): no BSF instances found
2025-12-05T18:56:37.376678157Z[36m [INFO][SMF][Consumer] [0mNo PCF binding found in BSF, using NRF discovery for SUPI: imsi-208930000007487, DNN: internet
2025-12-05T18:56:37.377075136Z[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-12-05T18:56:37.377795363Z[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?preferred-locality=area1&requester-nf-type=SMF&target-nf-type=PCF |  |
2025-12-05T18:56:37.378217144Z[36m [INFO][PCF][SMpolicy] [0mHandle CreateSmPolicy
2025-12-05T18:56:37.379156941Z[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v2/policy-data/ues/imsi-208930000007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-12-05T18:56:37.382645609Z[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v2/application-data/influenceData?dnns=internet&snssais=%5B%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%5D&supis=imsi-208930000007487 |  |
2025-12-05T18:56:37.382736801Z[36m [INFO][PCF][SMpolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-12-05T18:56:37.382880713Z[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v2/application-data/influenceData/subs-to-notify |  |
2025-12-05T18:56:37.383003620Z[36m [INFO][PCF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-12-05T18:56:37.383114139Z[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-208930000007487] PDUSessionID[2]
2025-12-05T18:56:37.383314999Z[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-12-05T18:56:37.383762643Z[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-12-05T18:56:37.383883457Z[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-12-05T18:56:37.384120188Z[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-12-05T18:56:37.384129993Z[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-12-05T18:56:37.384134721Z[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-12-05T18:56:37.384137916Z[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-208930000007487
2025-12-05T18:56:37.384140509Z[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-208930000007487
2025-12-05T18:56:37.384150205Z[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-12-05T18:56:37.384225592Z[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-12-05T18:56:37.384273008Z[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-208930000007487] [0mInstall PCCRule[PccRuleId-1]
2025-12-05T18:56:37.384278162Z[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-208930000007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-12-05T18:56:37.384294281Z[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-208930000007487] [0mInstall PCCRule[PccRuleId-2]
2025-12-05T18:56:37.384297520Z[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-208930000007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-12-05T18:56:37.384317721Z[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-208930000007487] [0mHas default path
2025-12-05T18:56:37.384331236Z[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-12-05T18:56:37.384371025Z[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-12-05T18:56:37.384419541Z[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-208930000007487] [0mcreate smContext[pduSessionID: 2] Success
2025-12-05T18:56:37.384576623Z[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-12-05T18:56:37.384594679Z[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x2][UPSEID:0x2] [0mNew session
2025-12-05T18:56:37.385058114Z[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:2 urrid:1 period:30000000000}]
2025-12-05T18:56:37.385099033Z[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:2 urrid:2 period:30000000000}]
2025-12-05T18:56:37.386176519Z[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-12-05T18:56:37.386696789Z[36m [INFO][AMF][Producer] [0mHandle N1N2 Message Transfer Request
2025-12-05T18:56:37.386721707Z[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/172.17.0.1/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57451] [0mSend PDU Session Resource Setup Request
2025-12-05T18:56:37.386789827Z[36m [INFO][AMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-208930000007487/n1-n2-messages |  |
2025-12-05T18:56:37.386877377Z[36m [INFO][N3IWF][NGAP] [0mHandle PDU Session Resource Setup Request
2025-12-05T18:56:37.386950761Z[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-12-05T18:56:37.386954930Z[36m [INFO][N3IWF][IKE] [0mHandle CreatePDUSession event
    non3gpp_test.go:676: Received Qos Flow settings
    non3gpp_test.go:679: NotificationData:[6 2 2 1 2 2]
    non3gpp_test.go:689: UP IP Address: 10.0.0.1
    non3gpp_test.go:778: ====== IPSec/Child SA for 3GPP UP Inbound =====
    non3gpp_test.go:779: [UE:192.168.127.2] <- [N3IWF:192.168.127.1]
    non3gpp_test.go:781: IPSec SPI: 0x000000006a8dfa15
    non3gpp_test.go:782: IPSec Encryption Algorithm: 12
    non3gpp_test.go:783: IPSec Encryption Key: 0xf5e66f98ee7b5e70f24c8776a34e35f7b1791373dadecdd91d21b8e51d1b9b1f
    non3gpp_test.go:784: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:785: IPSec Integrity  Key: 0x2721ecd5bfc4ee7355b003f5edf060f1532f47be
    non3gpp_test.go:787: ====== IPSec/Child SA for 3GPP UP Outbound =====
    non3gpp_test.go:788: [UE:192.168.127.2] -> [N3IWF:192.168.127.1]
2025-12-05T18:56:37.387211041Z[36m [INFO][N3IWF][IKE] [0mHandle CREATE_CHILD_SA
2025-12-05T18:56:37.387218089Z[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-12-05T18:56:37.387224994Z[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-12-05T18:56:37.387227916Z[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
    non3gpp_test.go:790: IPSec SPI: 0x00000000ac3dd184
    non3gpp_test.go:791: IPSec Encryption Algorithm: 12
    non3gpp_test.go:792: IPSec Encryption Key: 0xc0e5f83c74ab31d226fe660974c353dc4d9a80aa0412b3e3a8d061a8e6af9392
    non3gpp_test.go:793: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:794: IPSec Integrity  Key: 0xbe5127e654fba2f3323723e2cc298bb4d6e0664c
    non3gpp_test.go:795: State function: encr: 12, auth: 2
2025-12-05T18:56:37.387811760Z[36m [INFO][N3IWF][IKE] [0mSetup XFRM interface: xfrmi-3
2025-12-05T18:56:37.387923084Z[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
    non3gpp_test.go:817: Setup XFRM interface ipsec-2 successfully
2025-12-05T18:56:37.387977810Z[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
Security header type: Integrity Protected And Ciphered
2025-12-05T18:56:37.388016767Z[36m [INFO][N3IWF][NGAP] [0mSend PDU Session Resource Setup Response
cmac value: 0xc093da15
err <nil>
2025-12-05T18:56:37.388086165Z[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/172.17.0.1/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57451] [0mHandle PDUSessionResourceSetupResponse
2025-12-05T18:56:37.388099307Z[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/172.17.0.1/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57451] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
    non3gpp_test.go:831: Dump DecodePDUSessionEstablishmentAccept:
         (*nas.Message)(0xc000b8fd40)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc000580690)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 68                                          |~.h|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(<nil>),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(0xc000b90a50)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			DLNASTRANSPORTMessageIdentity: (nasType.DLNASTRANSPORTMessageIdentity) {
        				Octet: (uint8) 104
        			},
        			SpareHalfOctetAndPayloadContainerType: (nasType.SpareHalfOctetAndPayloadContainerType) {
        				Octet: (uint8) 1
        			},
        			PayloadContainer: (nasType.PayloadContainer) {
        				Iei: (uint8) 0,
        				Len: (uint16) 109,
        				Buffer: ([]uint8) (len=109 cap=109) {
        					00000000  2e 02 00 c2 11 00 1a 01  00 06 31 31 01 01 ff 01  |..........11....|
        					00000010  02 00 0e 21 11 09 10 09  09 09 09 ff ff ff ff 80  |...!............|
        					00000020  02 06 01 03 e8 01 03 e8  29 05 01 0a 3c 00 02 22  |........)...<.."|
        					00000030  04 01 fe dc ba 79 00 0c  01 20 41 01 01 09 02 20  |.....y... A.... |
        					00000040  41 01 01 08 7b 00 1b 80  00 0d 04 08 08 08 08 00  |A...{...........|
        					00000050  03 10 20 01 48 60 48 60  00 00 00 00 00 00 00 00  |.. .H`H`........|
        					00000060  88 88 25 09 08 69 6e 74  65 72 6e 65 74           |..%..internet|
        				}
        			},
        			PduSessionID2Value: (*nasType.PduSessionID2Value)(0xc00079227c)({
        				Iei: (uint8) 18,
        				Octet: (uint8) 2
        			}),
        			AdditionalInformation: (*nasType.AdditionalInformation)(<nil>),
        			Cause5GMM: (*nasType.Cause5GMM)(<nil>),
        			BackoffTimerValue: (*nasType.BackoffTimerValue)(<nil>)
        		}),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(0xc000c202d0)({
        		GsmHeader: (nas.GsmHeader) {
        			Octet: ([4]uint8) (len=4 cap=4) {
        				00000000  2e 02 00 c2                                       |....|
        			}
        		},
        		PDUSessionEstablishmentRequest: (*nasMessage.PDUSessionEstablishmentRequest)(<nil>),
        		PDUSessionEstablishmentAccept: (*nasMessage.PDUSessionEstablishmentAccept)(0xc00063a780)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 46
        			},
        			PDUSessionID: (nasType.PDUSessionID) {
        				Octet: (uint8) 2
        			},
        			PTI: (nasType.PTI) {
        				Octet: (uint8) 0
        			},
        			PDUSESSIONESTABLISHMENTACCEPTMessageIdentity: (nasType.PDUSESSIONESTABLISHMENTACCEPTMessageIdentity) {
        				Octet: (uint8) 194
        			},
        			SelectedSSCModeAndSelectedPDUSessionType: (nasType.SelectedSSCModeAndSelectedPDUSessionType) {
        				Octet: (uint8) 17
        			},
        			AuthorizedQosRules: (nasType.AuthorizedQosRules) {
        				Iei: (uint8) 0,
        				Len: (uint16) 26,
        				Buffer: ([]uint8) (len=26 cap=26) {
        					00000000  01 00 06 31 31 01 01 ff  01 02 00 0e 21 11 09 10  |...11.......!...|
        					00000010  09 09 09 09 ff ff ff ff  80 02                    |..........|
        				}
        			},
        			SessionAMBR: (nasType.SessionAMBR) {
        				Iei: (uint8) 0,
        				Len: (uint8) 6,
        				Octet: ([6]uint8) (len=6 cap=6) {
        					00000000  01 03 e8 01 03 e8                                 |......|
        				}
        			},
        			Cause5GSM: (*nasType.Cause5GSM)(<nil>),
        			PDUAddress: (*nasType.PDUAddress)(0xc0007922c0)({
        				Iei: (uint8) 41,
        				Len: (uint8) 5,
        				Octet: ([13]uint8) (len=13 cap=13) {
        					00000000  01 0a 3c 00 02 00 00 00  00 00 00 00 00           |..<..........|
        				}
        			}),
        			RQTimerValue: (*nasType.RQTimerValue)(<nil>),
        			SNSSAI: (*nasType.SNSSAI)(0xc0007922e0)({
        				Iei: (uint8) 34,
        				Len: (uint8) 4,
        				Octet: ([8]uint8) (len=8 cap=8) {
        					00000000  01 fe dc ba 00 00 00 00                           |........|
        				}
        			}),
        			AlwaysonPDUSessionIndication: (*nasType.AlwaysonPDUSessionIndication)(<nil>),
        			MappedEPSBearerContexts: (*nasType.MappedEPSBearerContexts)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			AuthorizedQosFlowDescriptions: (*nasType.AuthorizedQosFlowDescriptions)(0xc000b8fd60)({
        				Iei: (uint8) 121,
        				Len: (uint16) 12,
        				Buffer: ([]uint8) (len=12 cap=12) {
        					00000000  01 20 41 01 01 09 02 20  41 01 01 08              |. A.... A...|
        				}
        			}),
        			ExtendedProtocolConfigurationOptions: (*nasType.ExtendedProtocolConfigurationOptions)(0xc000b8fd80)({
        				Iei: (uint8) 123,
        				Len: (uint16) 27,
        				Buffer: ([]uint8) (len=27 cap=27) {
        					00000000  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000010  60 00 00 00 00 00 00 00  00 88 88                 |`..........|
        				}
        			}),
        			DNN: (*nasType.DNN)(0xc000b8fda0)({
        				Iei: (uint8) 37,
        				Len: (uint8) 9,
        				Buffer: ([]uint8) (len=9 cap=9) {
        					00000000  08 69 6e 74 65 72 6e 65  74                       |.internet|
        				}
        			})
        		}),
        		PDUSessionEstablishmentReject: (*nasMessage.PDUSessionEstablishmentReject)(<nil>),
        		PDUSessionAuthenticationCommand: (*nasMessage.PDUSessionAuthenticationCommand)(<nil>),
        		PDUSessionAuthenticationComplete: (*nasMessage.PDUSessionAuthenticationComplete)(<nil>),
        		PDUSessionAuthenticationResult: (*nasMessage.PDUSessionAuthenticationResult)(<nil>),
        		PDUSessionModificationRequest: (*nasMessage.PDUSessionModificationRequest)(<nil>),
        		PDUSessionModificationReject: (*nasMessage.PDUSessionModificationReject)(<nil>),
        		PDUSessionModificationCommand: (*nasMessage.PDUSessionModificationCommand)(<nil>),
        		PDUSessionModificationComplete: (*nasMessage.PDUSessionModificationComplete)(<nil>),
        		PDUSessionModificationCommandReject: (*nasMessage.PDUSessionModificationCommandReject)(<nil>),
        		PDUSessionReleaseRequest: (*nasMessage.PDUSessionReleaseRequest)(<nil>),
        		PDUSessionReleaseReject: (*nasMessage.PDUSessionReleaseReject)(<nil>),
        		PDUSessionReleaseCommand: (*nasMessage.PDUSessionReleaseCommand)(<nil>),
        		PDUSessionReleaseComplete: (*nasMessage.PDUSessionReleaseComplete)(<nil>),
        		Status5GSM: (*nasMessage.Status5GSM)(<nil>)
        	})
        })
        
    non3gpp_test.go:838: PDU Address: 10.60.0.2
    non3gpp_test.go:264: GRE Key Field: 0x1000000
2025-12-05T18:56:37.388379070Z[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
    non3gpp_test.go:1718: Create 2 interfaces
2025-12-05T18:56:37.388623756Z[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
    non3gpp_test.go:1714: 3 times PDU Session Est Request Start
    non3gpp_test.go:641: Waiting for N3IWF reply from IKE
2025-12-05T18:56:37.388777424Z[36m [INFO][N3IWF][NGAP] [0mSend Uplink NAS Transport
2025-12-05T18:56:37.389088855Z[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-12-05T18:56:37.389112393Z[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:e9a406f6-7ed1-497e-a67e-a1fc51e8f98e/modify |  |
2025-12-05T18:56:37.594860442Z[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/172.17.0.1/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57451] [0mHandle UplinkNASTransport
2025-12-05T18:56:37.594892385Z[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/172.17.0.1/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57451] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-12-05T18:56:37.594915803Z[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-12-05T18:56:37.594919852Z[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-208930000007487] [0mHandle UL NAS Transport
2025-12-05T18:56:37.594923354Z[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-208930000007487] [0mTransport 5GSM Message to SMF
2025-12-05T18:56:37.594929176Z[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-208930000007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-12-05T18:56:37.595223970Z[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-12-05T18:56:37.595308221Z[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-12-05T18:56:37.595319634Z[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v2/network-slice-information?nf-id=afb10138-6a20-44f0-984f-c8f78a942262&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-12-05T18:56:37.595432734Z[33m [WARN][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-208930000007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-12-05T18:56:37.595798921Z[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-12-05T18:56:37.596587236Z[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%5B%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%5D&target-nf-type=SMF&target-plmn-list=%5B%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%5D |  |
2025-12-05T18:56:37.596975657Z[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-12-05T18:56:37.597048078Z[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-12-05T18:56:37.597078292Z[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-12-05T18:56:37.597081148Z[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-12-05T18:56:37.597153317Z[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-12-05T18:56:37.597686846Z[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-12-05T18:56:37.597813687Z[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-208930000007487] [0mSend NF Discovery Serving UDM Successfully
2025-12-05T18:56:37.598067497Z[36m [INFO][UDM][Consumer] [0mTwoLayerPathHandlerFunc,  imsi-208930000007487 sm-data
2025-12-05T18:56:37.598088782Z[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-12-05T18:56:37.598097536Z[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-208930000007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-12-05T18:56:37.598710407Z[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v2/subscription-data/imsi-208930000007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-12-05T18:56:37.598812199Z[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v2/imsi-208930000007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-12-05T18:56:37.598860786Z[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-12-05T18:56:37Z[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc000d03b00 0xc000d03b20 0xc000d03b40]
2025-12-05T18:56:37.598870887Z[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-12-05T18:56:37.598874487Z[36m [INFO][SMF][GSM] [0m&{[0xc000d03b00 0xc000d03b20 0xc000d03b40]}
2025-12-05T18:56:37.598876971Z[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-12-05T18:56:37.598936282Z[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-12-05T18:56:37.599523059Z[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=afb10138-6a20-44f0-984f-c8f78a942262&target-nf-type=AMF |  |
2025-12-05T18:56:37.599652822Z[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-12-05T18:56:37.599662737Z[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.3
2025-12-05T18:56:37.599665658Z[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-12-05T18:56:37.599668350Z[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-208930000007487] [0mAllocated PDUAdress[10.60.0.3]
2025-12-05T18:56:37.599736088Z[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-12-05T18:56:37.600059025Z[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=BSF |  |
2025-12-05T18:56:37.600154317Z[33m [WARN][SMF][Consumer] [0mBSF selection failed: no BSF instances found
2025-12-05T18:56:37.600158837Z[33m [WARN][SMF][Consumer] [0mBSF query error (falling back to NRF): no BSF instances found
2025-12-05T18:56:37.600161835Z[36m [INFO][SMF][Consumer] [0mNo PCF binding found in BSF, using NRF discovery for SUPI: imsi-208930000007487, DNN: internet
2025-12-05T18:56:37.600238593Z[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-12-05T18:56:37.600927279Z[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?preferred-locality=area1&requester-nf-type=SMF&target-nf-type=PCF |  |
2025-12-05T18:56:37.601298088Z[36m [INFO][PCF][SMpolicy] [0mHandle CreateSmPolicy
2025-12-05T18:56:37.602100356Z[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v2/policy-data/ues/imsi-208930000007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-12-05T18:56:37.604777293Z[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v2/application-data/influenceData?dnns=internet&snssais=%5B%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%5D&supis=imsi-208930000007487 |  |
2025-12-05T18:56:37.604885235Z[36m [INFO][PCF][SMpolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-12-05T18:56:37.604997752Z[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v2/application-data/influenceData/subs-to-notify |  |
2025-12-05T18:56:37.605060018Z[36m [INFO][PCF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-12-05T18:56:37.605136127Z[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-208930000007487] PDUSessionID[3]
2025-12-05T18:56:37.605336817Z[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-12-05T18:56:37.605806241Z[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-12-05T18:56:37.605899519Z[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-12-05T18:56:37.606183190Z[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-12-05T18:56:37.606194889Z[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-12-05T18:56:37.606199561Z[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-12-05T18:56:37.606202833Z[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-208930000007487
2025-12-05T18:56:37.606205361Z[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-208930000007487
2025-12-05T18:56:37.606216063Z[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-12-05T18:56:37.606274494Z[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-12-05T18:56:37.606311733Z[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-208930000007487] [0mInstall PCCRule[PccRuleId-1]
2025-12-05T18:56:37.606316778Z[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-208930000007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-12-05T18:56:37.606333794Z[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-208930000007487] [0mInstall PCCRule[PccRuleId-2]
2025-12-05T18:56:37.606337011Z[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-208930000007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-12-05T18:56:37.606351653Z[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-208930000007487] [0mHas default path
2025-12-05T18:56:37.606363472Z[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-12-05T18:56:37.606394933Z[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-12-05T18:56:37.606454009Z[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-208930000007487] [0mcreate smContext[pduSessionID: 3] Success
2025-12-05T18:56:37.606631004Z[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-12-05T18:56:37.606649181Z[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x3][UPSEID:0x3] [0mNew session
2025-12-05T18:56:37.607097094Z[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:3 urrid:1 period:30000000000}]
2025-12-05T18:56:37.607289166Z[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:3 urrid:2 period:30000000000}]
2025-12-05T18:56:37.610701154Z[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-12-05T18:56:37.611096680Z[36m [INFO][AMF][Producer] [0mHandle N1N2 Message Transfer Request
2025-12-05T18:56:37.611115742Z[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/172.17.0.1/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57451] [0mSend PDU Session Resource Setup Request
2025-12-05T18:56:37.611178413Z[36m [INFO][AMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-208930000007487/n1-n2-messages |  |
2025-12-05T18:56:37.611256529Z[36m [INFO][N3IWF][NGAP] [0mHandle PDU Session Resource Setup Request
2025-12-05T18:56:37.611296110Z[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-12-05T18:56:37.611299940Z[36m [INFO][N3IWF][IKE] [0mHandle CreatePDUSession event
    non3gpp_test.go:676: Received Qos Flow settings
    non3gpp_test.go:679: NotificationData:[6 3 2 1 2 2]
    non3gpp_test.go:689: UP IP Address: 10.0.0.1
    non3gpp_test.go:778: ====== IPSec/Child SA for 3GPP UP Inbound =====
    non3gpp_test.go:779: [UE:192.168.127.2] <- [N3IWF:192.168.127.1]
    non3gpp_test.go:781: IPSec SPI: 0x00000000ae768b2f
    non3gpp_test.go:782: IPSec Encryption Algorithm: 12
    non3gpp_test.go:783: IPSec Encryption Key: 0xdb118ab7f2a717bb9538dc0964a8d6a28fab7321d49f681ff808bf2d2b90af3c
    non3gpp_test.go:784: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:785: IPSec Integrity  Key: 0xa0f3dc35032ebb90ee8baa01fd7a93323843aae0
    non3gpp_test.go:787: ====== IPSec/Child SA for 3GPP UP Outbound =====
    non3gpp_test.go:788: [UE:192.168.127.2] -> [N3IWF:192.168.127.1]
    non3gpp_test.go:790: IPSec SPI: 0x0000000071eb1d4b
    non3gpp_test.go:791: IPSec Encryption Algorithm: 12
2025-12-05T18:56:37.611524367Z[36m [INFO][N3IWF][IKE] [0mHandle CREATE_CHILD_SA
    non3gpp_test.go:792: IPSec Encryption Key: 0xc540f261eab27eaa76497786a69ddc13985cde90a5e6f3a281484d1dc88be452
    non3gpp_test.go:793: IPSec Integrity  Algorithm: 2
2025-12-05T18:56:37.611535901Z[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
    non3gpp_test.go:794: IPSec Integrity  Key: 0xcb86e19129460fc81b16c8548aa2e6027ed43f9b
    non3gpp_test.go:795: State function: encr: 12, auth: 2
2025-12-05T18:56:37.611558027Z[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-12-05T18:56:37.611564921Z[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-12-05T18:56:37.612156251Z[36m [INFO][N3IWF][IKE] [0mSetup XFRM interface: xfrmi-4
    non3gpp_test.go:817: Setup XFRM interface ipsec-3 successfully
2025-12-05T18:56:37.612271886Z[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-12-05T18:56:37.612321239Z[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
Security header type: Integrity Protected And Ciphered
2025-12-05T18:56:37.612336002Z[36m [INFO][N3IWF][NGAP] [0mSend PDU Session Resource Setup Response
cmac value: 0x5f2258b0
err <nil>
2025-12-05T18:56:37.612433282Z[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/172.17.0.1/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57451] [0mHandle PDUSessionResourceSetupResponse
2025-12-05T18:56:37.612461165Z[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/172.17.0.1/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57451] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
    non3gpp_test.go:831: Dump DecodePDUSessionEstablishmentAccept:
         (*nas.Message)(0xc000d02a00)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc0005d81e0)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 68                                          |~.h|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(<nil>),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(0xc000b91130)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			DLNASTRANSPORTMessageIdentity: (nasType.DLNASTRANSPORTMessageIdentity) {
        				Octet: (uint8) 104
        			},
        			SpareHalfOctetAndPayloadContainerType: (nasType.SpareHalfOctetAndPayloadContainerType) {
        				Octet: (uint8) 1
        			},
        			PayloadContainer: (nasType.PayloadContainer) {
        				Iei: (uint8) 0,
        				Len: (uint16) 109,
        				Buffer: ([]uint8) (len=109 cap=109) {
        					00000000  2e 03 00 c2 11 00 1a 01  00 06 31 31 01 01 ff 01  |..........11....|
        					00000010  02 00 0e 21 11 09 10 09  09 09 09 ff ff ff ff 80  |...!............|
        					00000020  02 06 01 03 e8 01 03 e8  29 05 01 0a 3c 00 03 22  |........)...<.."|
        					00000030  04 01 fe dc ba 79 00 0c  01 20 41 01 01 09 02 20  |.....y... A.... |
        					00000040  41 01 01 08 7b 00 1b 80  00 0d 04 08 08 08 08 00  |A...{...........|
        					00000050  03 10 20 01 48 60 48 60  00 00 00 00 00 00 00 00  |.. .H`H`........|
        					00000060  88 88 25 09 08 69 6e 74  65 72 6e 65 74           |..%..internet|
        				}
        			},
        			PduSessionID2Value: (*nasType.PduSessionID2Value)(0xc000793a9c)({
        				Iei: (uint8) 18,
        				Octet: (uint8) 3
        			}),
        			AdditionalInformation: (*nasType.AdditionalInformation)(<nil>),
        			Cause5GMM: (*nasType.Cause5GMM)(<nil>),
        			BackoffTimerValue: (*nasType.BackoffTimerValue)(<nil>)
        		}),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(0xc000c20480)({
        		GsmHeader: (nas.GsmHeader) {
        			Octet: ([4]uint8) (len=4 cap=4) {
        				00000000  2e 03 00 c2                                       |....|
        			}
        		},
        		PDUSessionEstablishmentRequest: (*nasMessage.PDUSessionEstablishmentRequest)(<nil>),
        		PDUSessionEstablishmentAccept: (*nasMessage.PDUSessionEstablishmentAccept)(0xc00063ae80)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 46
        			},
        			PDUSessionID: (nasType.PDUSessionID) {
        				Octet: (uint8) 3
        			},
        			PTI: (nasType.PTI) {
        				Octet: (uint8) 0
        			},
        			PDUSESSIONESTABLISHMENTACCEPTMessageIdentity: (nasType.PDUSESSIONESTABLISHMENTACCEPTMessageIdentity) {
        				Octet: (uint8) 194
        			},
        			SelectedSSCModeAndSelectedPDUSessionType: (nasType.SelectedSSCModeAndSelectedPDUSessionType) {
        				Octet: (uint8) 17
        			},
        			AuthorizedQosRules: (nasType.AuthorizedQosRules) {
        				Iei: (uint8) 0,
        				Len: (uint16) 26,
        				Buffer: ([]uint8) (len=26 cap=26) {
        					00000000  01 00 06 31 31 01 01 ff  01 02 00 0e 21 11 09 10  |...11.......!...|
        					00000010  09 09 09 09 ff ff ff ff  80 02                    |..........|
        				}
        			},
        			SessionAMBR: (nasType.SessionAMBR) {
        				Iei: (uint8) 0,
        				Len: (uint8) 6,
        				Octet: ([6]uint8) (len=6 cap=6) {
        					00000000  01 03 e8 01 03 e8                                 |......|
        				}
        			},
        			Cause5GSM: (*nasType.Cause5GSM)(<nil>),
        			PDUAddress: (*nasType.PDUAddress)(0xc000793ad0)({
        				Iei: (uint8) 41,
        				Len: (uint8) 5,
        				Octet: ([13]uint8) (len=13 cap=13) {
        					00000000  01 0a 3c 00 03 00 00 00  00 00 00 00 00           |..<..........|
        				}
        			}),
        			RQTimerValue: (*nasType.RQTimerValue)(<nil>),
        			SNSSAI: (*nasType.SNSSAI)(0xc000793ae0)({
        				Iei: (uint8) 34,
        				Len: (uint8) 4,
        				Octet: ([8]uint8) (len=8 cap=8) {
        					00000000  01 fe dc ba 00 00 00 00                           |........|
        				}
        			}),
        			AlwaysonPDUSessionIndication: (*nasType.AlwaysonPDUSessionIndication)(<nil>),
        			MappedEPSBearerContexts: (*nasType.MappedEPSBearerContexts)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			AuthorizedQosFlowDescriptions: (*nasType.AuthorizedQosFlowDescriptions)(0xc000d02a20)({
        				Iei: (uint8) 121,
        				Len: (uint16) 12,
        				Buffer: ([]uint8) (len=12 cap=12) {
        					00000000  01 20 41 01 01 09 02 20  41 01 01 08              |. A.... A...|
        				}
        			}),
        			ExtendedProtocolConfigurationOptions: (*nasType.ExtendedProtocolConfigurationOptions)(0xc000d02a40)({
        				Iei: (uint8) 123,
        				Len: (uint16) 27,
        				Buffer: ([]uint8) (len=27 cap=27) {
        					00000000  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000010  60 00 00 00 00 00 00 00  00 88 88                 |`..........|
        				}
        			}),
        			DNN: (*nasType.DNN)(0xc000d02a60)({
        				Iei: (uint8) 37,
        				Len: (uint8) 9,
        				Buffer: ([]uint8) (len=9 cap=9) {
        					00000000  08 69 6e 74 65 72 6e 65  74                       |.internet|
        				}
        			})
        		}),
        		PDUSessionEstablishmentReject: (*nasMessage.PDUSessionEstablishmentReject)(<nil>),
        		PDUSessionAuthenticationCommand: (*nasMessage.PDUSessionAuthenticationCommand)(<nil>),
        		PDUSessionAuthenticationComplete: (*nasMessage.PDUSessionAuthenticationComplete)(<nil>),
        		PDUSessionAuthenticationResult: (*nasMessage.PDUSessionAuthenticationResult)(<nil>),
        		PDUSessionModificationRequest: (*nasMessage.PDUSessionModificationRequest)(<nil>),
        		PDUSessionModificationReject: (*nasMessage.PDUSessionModificationReject)(<nil>),
        		PDUSessionModificationCommand: (*nasMessage.PDUSessionModificationCommand)(<nil>),
        		PDUSessionModificationComplete: (*nasMessage.PDUSessionModificationComplete)(<nil>),
        		PDUSessionModificationCommandReject: (*nasMessage.PDUSessionModificationCommandReject)(<nil>),
        		PDUSessionReleaseRequest: (*nasMessage.PDUSessionReleaseRequest)(<nil>),
        		PDUSessionReleaseReject: (*nasMessage.PDUSessionReleaseReject)(<nil>),
        		PDUSessionReleaseCommand: (*nasMessage.PDUSessionReleaseCommand)(<nil>),
        		PDUSessionReleaseComplete: (*nasMessage.PDUSessionReleaseComplete)(<nil>),
        		Status5GSM: (*nasMessage.Status5GSM)(<nil>)
        	})
        })
        
    non3gpp_test.go:838: PDU Address: 10.60.0.3
    non3gpp_test.go:264: GRE Key Field: 0x1000000
2025-12-05T18:56:37.612935013Z[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
    non3gpp_test.go:1718: Create 2 interfaces
    non3gpp_test.go:1714: 4 times PDU Session Est Request Start
2025-12-05T18:56:37.613123650Z[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
    non3gpp_test.go:641: Waiting for N3IWF reply from IKE
2025-12-05T18:56:37.613156249Z[36m [INFO][N3IWF][NGAP] [0mSend Uplink NAS Transport
2025-12-05T18:56:37.644305927Z[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-12-05T18:56:37.644344950Z[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:72203b0b-6881-4c29-813f-22605b2ab36d/modify |  |
2025-12-05T18:56:37.824268523Z[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/172.17.0.1/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57451] [0mHandle UplinkNASTransport
2025-12-05T18:56:37.824303529Z[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/172.17.0.1/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57451] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-12-05T18:56:37.824326105Z[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-12-05T18:56:37.824330252Z[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-208930000007487] [0mHandle UL NAS Transport
2025-12-05T18:56:37.824333688Z[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-208930000007487] [0mTransport 5GSM Message to SMF
2025-12-05T18:56:37.824349611Z[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-208930000007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-12-05T18:56:37.824688432Z[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-12-05T18:56:37.824752701Z[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-12-05T18:56:37.824763928Z[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v2/network-slice-information?nf-id=afb10138-6a20-44f0-984f-c8f78a942262&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-12-05T18:56:37.824893106Z[33m [WARN][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-208930000007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-12-05T18:56:37.825158152Z[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-12-05T18:56:37.825972749Z[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%5B%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%5D&target-nf-type=SMF&target-plmn-list=%5B%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%5D |  |
2025-12-05T18:56:37.826729045Z[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-12-05T18:56:37.826798851Z[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-12-05T18:56:37.826812563Z[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-12-05T18:56:37.826815824Z[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-12-05T18:56:37.826889227Z[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-12-05T18:56:37.827438724Z[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-12-05T18:56:37.827552411Z[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-208930000007487] [0mSend NF Discovery Serving UDM Successfully
2025-12-05T18:56:37.827783827Z[36m [INFO][UDM][Consumer] [0mTwoLayerPathHandlerFunc,  imsi-208930000007487 sm-data
2025-12-05T18:56:37.827803393Z[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-12-05T18:56:37.827826078Z[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-208930000007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-12-05T18:56:37.828439006Z[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v2/subscription-data/imsi-208930000007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-12-05T18:56:37.828581353Z[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v2/imsi-208930000007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-12-05T18:56:37.828684921Z[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-12-05T18:56:37Z[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc000e0dd40 0xc000e0dd60 0xc000e0dd80]
2025-12-05T18:56:37.828703896Z[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-12-05T18:56:37.828708000Z[36m [INFO][SMF][GSM] [0m&{[0xc000e0dd40 0xc000e0dd60 0xc000e0dd80]}
2025-12-05T18:56:37.828710867Z[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-12-05T18:56:37.828938926Z[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-12-05T18:56:37.829585279Z[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=afb10138-6a20-44f0-984f-c8f78a942262&target-nf-type=AMF |  |
2025-12-05T18:56:37.829696712Z[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-12-05T18:56:37.829730286Z[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.4
2025-12-05T18:56:37.829736709Z[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-12-05T18:56:37.829739303Z[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-208930000007487] [0mAllocated PDUAdress[10.60.0.4]
2025-12-05T18:56:37.829827230Z[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-12-05T18:56:37.830223612Z[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=BSF |  |
2025-12-05T18:56:37.830297325Z[33m [WARN][SMF][Consumer] [0mBSF selection failed: no BSF instances found
2025-12-05T18:56:37.830302063Z[33m [WARN][SMF][Consumer] [0mBSF query error (falling back to NRF): no BSF instances found
2025-12-05T18:56:37.830305280Z[36m [INFO][SMF][Consumer] [0mNo PCF binding found in BSF, using NRF discovery for SUPI: imsi-208930000007487, DNN: internet
2025-12-05T18:56:37.830368608Z[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-12-05T18:56:37.830984381Z[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?preferred-locality=area1&requester-nf-type=SMF&target-nf-type=PCF |  |
2025-12-05T18:56:37.831376736Z[36m [INFO][PCF][SMpolicy] [0mHandle CreateSmPolicy
2025-12-05T18:56:37.832185592Z[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v2/policy-data/ues/imsi-208930000007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-12-05T18:56:37.834408956Z[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v2/application-data/influenceData?dnns=internet&snssais=%5B%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%5D&supis=imsi-208930000007487 |  |
2025-12-05T18:56:37.834489683Z[36m [INFO][PCF][SMpolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-12-05T18:56:37.834584406Z[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v2/application-data/influenceData/subs-to-notify |  |
2025-12-05T18:56:37.834652592Z[36m [INFO][PCF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-12-05T18:56:37.834785277Z[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-208930000007487] PDUSessionID[4]
2025-12-05T18:56:37.835021034Z[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-12-05T18:56:37.835424745Z[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-12-05T18:56:37.835503371Z[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-12-05T18:56:37.904835715Z[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-12-05T18:56:37.904854186Z[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-12-05T18:56:37.904859242Z[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-12-05T18:56:37.904862142Z[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-208930000007487
2025-12-05T18:56:37.904865162Z[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-208930000007487
2025-12-05T18:56:37.904876040Z[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-12-05T18:56:37.904938612Z[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-12-05T18:56:37.904996742Z[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-208930000007487] [0mInstall PCCRule[PccRuleId-1]
2025-12-05T18:56:37.905001152Z[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-208930000007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-12-05T18:56:37.905023486Z[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-208930000007487] [0mInstall PCCRule[PccRuleId-2]
2025-12-05T18:56:37.905026802Z[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-208930000007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-12-05T18:56:37.905044464Z[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-208930000007487] [0mHas default path
2025-12-05T18:56:37.905059325Z[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-12-05T18:56:37.905082962Z[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-12-05T18:56:37.905256858Z[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-208930000007487] [0mcreate smContext[pduSessionID: 4] Success
2025-12-05T18:56:37.905278607Z[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-12-05T18:56:37.905293446Z[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x4][UPSEID:0x4] [0mNew session
2025-12-05T18:56:37.905736388Z[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:4 urrid:1 period:30000000000}]
2025-12-05T18:56:37.905854994Z[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:4 urrid:2 period:30000000000}]
2025-12-05T18:56:37.906312771Z[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-12-05T18:56:37.906773006Z[36m [INFO][AMF][Producer] [0mHandle N1N2 Message Transfer Request
2025-12-05T18:56:37.906795122Z[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/172.17.0.1/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57451] [0mSend PDU Session Resource Setup Request
2025-12-05T18:56:37.906856020Z[36m [INFO][AMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-208930000007487/n1-n2-messages |  |
2025-12-05T18:56:37.906969628Z[36m [INFO][N3IWF][NGAP] [0mHandle PDU Session Resource Setup Request
2025-12-05T18:56:37.907017646Z[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-12-05T18:56:37.907021717Z[36m [INFO][N3IWF][IKE] [0mHandle CreatePDUSession event
    non3gpp_test.go:676: Received Qos Flow settings
    non3gpp_test.go:679: NotificationData:[6 4 2 1 2 2]
    non3gpp_test.go:689: UP IP Address: 10.0.0.1
    non3gpp_test.go:778: ====== IPSec/Child SA for 3GPP UP Inbound =====
    non3gpp_test.go:779: [UE:192.168.127.2] <- [N3IWF:192.168.127.1]
    non3gpp_test.go:781: IPSec SPI: 0x000000007ba655c5
    non3gpp_test.go:782: IPSec Encryption Algorithm: 12
    non3gpp_test.go:783: IPSec Encryption Key: 0xba72458898c5c3dffc62fd37796b5b94b7dd308d9bb8d4be3eda24e0fd08c0b2
2025-12-05T18:56:37.907228314Z[36m [INFO][N3IWF][IKE] [0mHandle CREATE_CHILD_SA
    non3gpp_test.go:784: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:785: IPSec Integrity  Key: 0xe83bbe7b1f6c9b2baa9bfaa5613aba8e57c10330
2025-12-05T18:56:37.907241982Z[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
    non3gpp_test.go:787: ====== IPSec/Child SA for 3GPP UP Outbound =====
2025-12-05T18:56:37.907247431Z[36m [INFO][N3IWF][IKE] [0mHandle IKE event
    non3gpp_test.go:788: [UE:192.168.127.2] -> [N3IWF:192.168.127.1]
    non3gpp_test.go:790: IPSec SPI: 0x00000000249ade4f
    non3gpp_test.go:791: IPSec Encryption Algorithm: 12
    non3gpp_test.go:792: IPSec Encryption Key: 0xb903f93ef227352383568b090c822f3499f7f287b24563213d3ba53f52250f56
    non3gpp_test.go:793: IPSec Integrity  Algorithm: 2
2025-12-05T18:56:37.907250408Z[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
    non3gpp_test.go:794: IPSec Integrity  Key: 0xdc5a98c918e106fe6256e18f4634cbffaa0149d9
    non3gpp_test.go:795: State function: encr: 12, auth: 2
2025-12-05T18:56:37.907839954Z[36m [INFO][N3IWF][IKE] [0mSetup XFRM interface: xfrmi-5
    non3gpp_test.go:817: Setup XFRM interface ipsec-4 successfully
2025-12-05T18:56:37.907943913Z[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-12-05T18:56:37.907989830Z[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-12-05T18:56:37.908005686Z[36m [INFO][N3IWF][NGAP] [0mSend PDU Session Resource Setup Response
Security header type: Integrity Protected And Ciphered
cmac value: 0x7872eec9
err <nil>
2025-12-05T18:56:37.908072045Z[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/172.17.0.1/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57451] [0mHandle PDUSessionResourceSetupResponse
2025-12-05T18:56:37.908092552Z[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/172.17.0.1/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57451] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
    non3gpp_test.go:831: Dump DecodePDUSessionEstablishmentAccept:
         (*nas.Message)(0xc000d03620)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc0005d9c20)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 68                                          |~.h|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(<nil>),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(0xc000b91810)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			DLNASTRANSPORTMessageIdentity: (nasType.DLNASTRANSPORTMessageIdentity) {
        				Octet: (uint8) 104
        			},
        			SpareHalfOctetAndPayloadContainerType: (nasType.SpareHalfOctetAndPayloadContainerType) {
        				Octet: (uint8) 1
        			},
        			PayloadContainer: (nasType.PayloadContainer) {
        				Iei: (uint8) 0,
        				Len: (uint16) 109,
        				Buffer: ([]uint8) (len=109 cap=109) {
        					00000000  2e 04 00 c2 11 00 1a 01  00 06 31 31 01 01 ff 01  |..........11....|
        					00000010  02 00 0e 21 11 09 10 09  09 09 09 ff ff ff ff 80  |...!............|
        					00000020  02 06 01 03 e8 01 03 e8  29 05 01 0a 3c 00 04 22  |........)...<.."|
        					00000030  04 01 fe dc ba 79 00 0c  01 20 41 01 01 09 02 20  |.....y... A.... |
        					00000040  41 01 01 08 7b 00 1b 80  00 0d 04 08 08 08 08 00  |A...{...........|
        					00000050  03 10 20 01 48 60 48 60  00 00 00 00 00 00 00 00  |.. .H`H`........|
        					00000060  88 88 25 09 08 69 6e 74  65 72 6e 65 74           |..%..internet|
        				}
        			},
        			PduSessionID2Value: (*nasType.PduSessionID2Value)(0xc0004fefec)({
        				Iei: (uint8) 18,
        				Octet: (uint8) 4
        			}),
        			AdditionalInformation: (*nasType.AdditionalInformation)(<nil>),
        			Cause5GMM: (*nasType.Cause5GMM)(<nil>),
        			BackoffTimerValue: (*nasType.BackoffTimerValue)(<nil>)
        		}),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(0xc000c20630)({
        		GsmHeader: (nas.GsmHeader) {
        			Octet: ([4]uint8) (len=4 cap=4) {
        				00000000  2e 04 00 c2                                       |....|
        			}
        		},
        		PDUSessionEstablishmentRequest: (*nasMessage.PDUSessionEstablishmentRequest)(<nil>),
        		PDUSessionEstablishmentAccept: (*nasMessage.PDUSessionEstablishmentAccept)(0xc00063b580)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 46
        			},
        			PDUSessionID: (nasType.PDUSessionID) {
        				Octet: (uint8) 4
        			},
        			PTI: (nasType.PTI) {
        				Octet: (uint8) 0
        			},
        			PDUSESSIONESTABLISHMENTACCEPTMessageIdentity: (nasType.PDUSESSIONESTABLISHMENTACCEPTMessageIdentity) {
        				Octet: (uint8) 194
        			},
        			SelectedSSCModeAndSelectedPDUSessionType: (nasType.SelectedSSCModeAndSelectedPDUSessionType) {
        				Octet: (uint8) 17
        			},
        			AuthorizedQosRules: (nasType.AuthorizedQosRules) {
        				Iei: (uint8) 0,
        				Len: (uint16) 26,
        				Buffer: ([]uint8) (len=26 cap=26) {
        					00000000  01 00 06 31 31 01 01 ff  01 02 00 0e 21 11 09 10  |...11.......!...|
        					00000010  09 09 09 09 ff ff ff ff  80 02                    |..........|
        				}
        			},
        			SessionAMBR: (nasType.SessionAMBR) {
        				Iei: (uint8) 0,
        				Len: (uint8) 6,
        				Octet: ([6]uint8) (len=6 cap=6) {
        					00000000  01 03 e8 01 03 e8                                 |......|
        				}
        			},
        			Cause5GSM: (*nasType.Cause5GSM)(<nil>),
        			PDUAddress: (*nasType.PDUAddress)(0xc0004ff020)({
        				Iei: (uint8) 41,
        				Len: (uint8) 5,
        				Octet: ([13]uint8) (len=13 cap=13) {
        					00000000  01 0a 3c 00 04 00 00 00  00 00 00 00 00           |..<..........|
        				}
        			}),
        			RQTimerValue: (*nasType.RQTimerValue)(<nil>),
        			SNSSAI: (*nasType.SNSSAI)(0xc0004ff030)({
        				Iei: (uint8) 34,
        				Len: (uint8) 4,
        				Octet: ([8]uint8) (len=8 cap=8) {
        					00000000  01 fe dc ba 00 00 00 00                           |........|
        				}
        			}),
        			AlwaysonPDUSessionIndication: (*nasType.AlwaysonPDUSessionIndication)(<nil>),
        			MappedEPSBearerContexts: (*nasType.MappedEPSBearerContexts)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			AuthorizedQosFlowDescriptions: (*nasType.AuthorizedQosFlowDescriptions)(0xc000d03640)({
        				Iei: (uint8) 121,
        				Len: (uint16) 12,
        				Buffer: ([]uint8) (len=12 cap=12) {
        					00000000  01 20 41 01 01 09 02 20  41 01 01 08              |. A.... A...|
        				}
        			}),
        			ExtendedProtocolConfigurationOptions: (*nasType.ExtendedProtocolConfigurationOptions)(0xc000d03660)({
        				Iei: (uint8) 123,
        				Len: (uint16) 27,
        				Buffer: ([]uint8) (len=27 cap=27) {
        					00000000  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000010  60 00 00 00 00 00 00 00  00 88 88                 |`..........|
        				}
        			}),
        			DNN: (*nasType.DNN)(0xc000d03680)({
        				Iei: (uint8) 37,
        				Len: (uint8) 9,
        				Buffer: ([]uint8) (len=9 cap=9) {
        					00000000  08 69 6e 74 65 72 6e 65  74                       |.internet|
        				}
        			})
        		}),
        		PDUSessionEstablishmentReject: (*nasMessage.PDUSessionEstablishmentReject)(<nil>),
        		PDUSessionAuthenticationCommand: (*nasMessage.PDUSessionAuthenticationCommand)(<nil>),
        		PDUSessionAuthenticationComplete: (*nasMessage.PDUSessionAuthenticationComplete)(<nil>),
        		PDUSessionAuthenticationResult: (*nasMessage.PDUSessionAuthenticationResult)(<nil>),
        		PDUSessionModificationRequest: (*nasMessage.PDUSessionModificationRequest)(<nil>),
        		PDUSessionModificationReject: (*nasMessage.PDUSessionModificationReject)(<nil>),
        		PDUSessionModificationCommand: (*nasMessage.PDUSessionModificationCommand)(<nil>),
        		PDUSessionModificationComplete: (*nasMessage.PDUSessionModificationComplete)(<nil>),
        		PDUSessionModificationCommandReject: (*nasMessage.PDUSessionModificationCommandReject)(<nil>),
        		PDUSessionReleaseRequest: (*nasMessage.PDUSessionReleaseRequest)(<nil>),
        		PDUSessionReleaseReject: (*nasMessage.PDUSessionReleaseReject)(<nil>),
        		PDUSessionReleaseCommand: (*nasMessage.PDUSessionReleaseCommand)(<nil>),
        		PDUSessionReleaseComplete: (*nasMessage.PDUSessionReleaseComplete)(<nil>),
        		Status5GSM: (*nasMessage.Status5GSM)(<nil>)
        	})
        })
        
    non3gpp_test.go:838: PDU Address: 10.60.0.4
    non3gpp_test.go:264: GRE Key Field: 0x1000000
    non3gpp_test.go:1718: Create 2 interfaces
2025-12-05T18:56:37.908561532Z[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
2025-12-05T18:56:37.908751488Z[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-12-05T18:56:37.919073578Z[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-12-05T18:56:37.919100859Z[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:2ae43253-dea7-4b56-a39a-c94ba8c72b3f/modify |  |
    non3gpp_test.go:1743: 32 bytes from 10.60.0.101: icmp_seq=0 time=298.56µs
    non3gpp_test.go:1743: 32 bytes from 10.60.0.101: icmp_seq=1 time=267.197µs
    non3gpp_test.go:1743: 32 bytes from 10.60.0.101: icmp_seq=2 time=448.348µs
    non3gpp_test.go:1743: 32 bytes from 10.60.0.101: icmp_seq=3 time=355.944µs
    non3gpp_test.go:1743: 32 bytes from 10.60.0.101: icmp_seq=4 time=346.621µs
    non3gpp_test.go:1747: 
        --- 10.60.0.101 ping statistics ---
    non3gpp_test.go:1748: 5 packets transmitted, 5 packets received, 0% packet loss
    non3gpp_test.go:1750: round-trip min/avg/max/stddev = 267.197µs/343.333µs/448.348µs/61.642µs
    non3gpp_test.go:1726: Delete interface: ipsec-4
    non3gpp_test.go:1726: Delete interface: gretun-id-4
    non3gpp_test.go:1726: Delete interface: ipsec-3
    non3gpp_test.go:1726: Delete interface: gretun-id-3
    non3gpp_test.go:1726: Delete interface: ipsec-2
    non3gpp_test.go:1726: Delete interface: gretun-id-2
    non3gpp_test.go:1694: Delete interface: gretun-id-1
    non3gpp_test.go:1453: Delete XFRM interface: ipsec-default
--- PASS: TestNon3GPPUE (11.46s)
PASS
ok  	test	11.490s
2025-12-05T18:56:50.371625084Z[36m [INFO][UPF][Main] [0mShutdown UPF ...
2025-12-05T18:56:50.371681561Z[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mStopping pfcp server
2025-12-05T18:56:50.371738137Z[31m [ERRO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mread udp4 10.200.200.101:8805: use of closed network connection
2025-12-05T18:56:50.371745786Z[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mpfcp reciver stopped
2025-12-05T18:56:50.371755131Z[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mpfcp server stopped
2025-12-05T18:56:50.410868148Z[36m [INFO][UPF][Perio] [0mrecv event[TYPE_SERVER_CLOSE][{eType:4 lSeid:0 urrid:0 period:0}]
2025-12-05T18:56:50.410890899Z[36m [INFO][UPF][Perio] [0mperio server stopped
2025-12-05T18:56:50.410906558Z[36m [INFO][UPF][Perio] [0mticker[30s] Stopped
2025-12-05T18:56:50.410915378Z[36m [INFO][UPF][Main] [0mTerminating UPF...
2025-12-05T18:56:50.410919416Z[36m [INFO][UPF][Main] [0mUPF terminated
2025-12-05T18:56:50.410923629Z[36m [INFO][UPF][Main] [0mUPF exited
2025-12-05T18:56:50.840189050Z[36m [INFO][N3IWF][Main] [0mStopping service created by N3IWF
2025-12-05T18:56:50.840247749Z[36m [INFO][N3IWF][NGAP] [0mClose NGAP server....
SCTPConn: SCTPWrite failed bad file descriptor
2025-12-05T18:56:50.840309062Z[36m [INFO][N3IWF][NWuCP] [0mClose Nwucp server...
2025-12-05T18:56:50.840355275Z[33m [WARN][N3IWF][NGAP] [0m[SCTP] Close connection.
2025-12-05T18:56:50.840382326Z[31m [ERRO][N3IWF][NGAP] [0mconn close error: bad file descriptor
2025-12-05T18:56:50.840407134Z[36m [INFO][N3IWF][NGAP] [0mNGAP receiver stopped
2025-12-05T18:56:50.840416075Z[36m [INFO][N3IWF][NGAP] [0mNGAP server stopped
2025-12-05T18:56:50.840389439Z[31m [ERRO][N3IWF][NWuCP] [0mTCP server accept failed : accept tcp 10.0.0.1:20000: use of closed network connection. Close the listener...
2025-12-05T18:56:50.840427981Z[31m [ERRO][N3IWF][NWuCP] [0mError closing tcpListener: close tcp 10.0.0.1:20000: use of closed network connection
2025-12-05T18:56:50.840438907Z[36m [INFO][N3IWF][NWuUP] [0mClose Nwuup server...
2025-12-05T18:56:50.840436347Z[31m [ERRO][N3IWF][NWuCP] [0mRead the length of NAS message failed: read tcp 10.0.0.1:20000->10.0.0.2:56595: use of closed network connection
2025-12-05T18:56:50.840463562Z[31m [ERRO][N3IWF][NWuUP] [0mError read from IPv4 packet connection: read ip 10.0.0.1: raw-read ip4 10.0.0.1: use of closed network connection
2025-12-05T18:56:50.840498295Z[31m [ERRO][N3IWF][NWuUP] [0mError closing raw socket: close ip4 10.0.0.1: use of closed network connection
2025-12-05T18:56:50.840465001Z[31m [ERRO][N3IWF][NWuCP] [0mError closing connection: close tcp 10.0.0.1:20000->10.0.0.2:56595: use of closed network connection
2025-12-05T18:56:50.840469871Z[36m [INFO][N3IWF][IKE] [0mClose Ike server...
2025-12-05T18:56:50.840518934Z[31m [ERRO][N3IWF][IKE] [0mReadFromUDP failed: read udp 192.168.127.1:500: use of closed network connection
2025-12-05T18:56:50.840548797Z[36m [INFO][N3IWF][IKE] [0mIke receiver stopped
2025-12-05T18:56:50.840673532Z[31m [ERRO][N3IWF][IKE] [0mReadFromUDP failed: read udp 192.168.127.1:4500: use of closed network connection
2025-12-05T18:56:50.840683775Z[36m [INFO][N3IWF][IKE] [0mIke receiver stopped
2025-12-05T18:56:50.840690297Z[36m [INFO][N3IWF][IKE] [0mIke server stopped
2025-12-05T18:56:50.840719690Z[31m [ERRO][N3IWF][Main] [0mDelete interface xfrmi-5 fail: no such device
2025-12-05T18:56:50.840733861Z[31m [ERRO][N3IWF][Main] [0mDelete interface xfrmi-default fail: no such device
2025-12-05T18:56:50.840749356Z[31m [ERRO][N3IWF][Main] [0mDelete interface xfrmi-3 fail: no such device
2025-12-05T18:56:50.840761514Z[31m [ERRO][N3IWF][Main] [0mDelete interface xfrmi-4 fail: no such device
2025-12-05T18:56:50.840764118Z[36m [INFO][N3IWF][Main] [0mN3IWF App is terminated
--- PASS: TestCN (30.11s)
PASS
ok  	test	36.119s
