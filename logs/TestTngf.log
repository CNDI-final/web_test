2025-12-06T09:19:33.714457202Z[36m [INFO][UPF][Main] [0mUPF version:  
	free5GC version: v4.1.0-26-gf454591
	build time:      2025-12-06T09:12:28Z
	commit hash:     +f9b9500
	commit time:     2025-12-05T05:43:16Z
	go version:      go1.24.2 linux/amd64
2025-12-06T09:19:33.714511283Z[36m [INFO][UPF][CFG] [0mRead config from [./config/upfcfg.test.yaml]
2025-12-06T09:19:33.714692204Z[36m [INFO][UPF][CFG] [0m==================================================
2025-12-06T09:19:33.714698278Z[36m [INFO][UPF][CFG] [0m(*factory.Config)(0xc0002d6ff0)({
	Version: (string) (len=5) "1.0.3",
	Description: (string) (len=31) "UPF initial local configuration",
	Pfcp: (*factory.Pfcp)(0xc000683560)({
		Addr: (string) (len=14) "10.200.200.101",
		NodeID: (string) (len=14) "10.200.200.101",
		RetransTimeout: (time.Duration) 1s,
		MaxRetrans: (uint8) 3
	}),
	Gtpu: (*factory.Gtpu)(0xc000683710)({
		Forwarder: (string) (len=5) "gtp5g",
		IfList: ([]factory.IfInfo) (len=1 cap=1) {
			(factory.IfInfo) {
				Addr: (string) (len=14) "10.200.200.102",
				Type: (string) (len=2) "N3",
				Name: (string) "",
				IfName: (string) "",
				MTU: (uint32) 0
			}
		}
	}),
	DnnList: ([]factory.DnnList) (len=1 cap=1) {
		(factory.DnnList) {
			Dnn: (string) (len=8) "internet",
			Cidr: (string) (len=12) "10.60.0.0/16",
			NatIfName: (string) ""
		}
	},
	Logger: (*factory.Logger)(0xc00065fb80)({
		Enable: (bool) true,
		Level: (string) (len=4) "info",
		ReportCaller: (bool) false
	})
})
2025-12-06T09:19:33.714701320Z[36m [INFO][UPF][CFG] [0m==================================================
2025-12-06T09:19:33.714704307Z[36m [INFO][UPF][Main] [0mLog level is set to [info]
2025-12-06T09:19:33.714706813Z[36m [INFO][UPF][Main] [0mReport Caller is set to [false]
2025-12-06T09:19:33.714725230Z[36m [INFO][UPF][Main] [0mstarting Gtpu Forwarder [gtp5g]
2025-12-06T09:19:33.714728108Z[36m [INFO][UPF][Main] [0mGTP Address: "10.200.200.102:2152"
2025-12-06T09:19:33.716307070Z[36m [INFO][UPF][BUFF] [0mbuff netlink server started
2025-12-06T09:19:33.716336222Z[36m [INFO][UPF][Gtp5g] [0mForwarder started
2025-12-06T09:19:33.716500860Z[36m [INFO][UPF][Perio] [0mperio server started
2025-12-06T09:19:33.716533514Z[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mstarting pfcp server
2025-12-06T09:19:33.716541711Z[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mpfcp server started
2025-12-06T09:19:33.716544381Z[36m [INFO][UPF][Main] [0mUPF started
Run TestCN
os.Args: [/tmp/go-build3985173304/b001/test.test -test.paniconexit0 -test.v=true -test.timeout=0s -test.run=TestCN]
2025-12-06T09:19:37.058701951Z[36m [INFO][NRF][Main] [0mLog enable is set to [true]
2025-12-06T09:19:37.058759665Z[36m [INFO][NRF][Main] [0mLog level is set to [info]
2025-12-06T09:19:37.058762980Z[36m [INFO][NRF][Main] [0mReport Caller is set to [false]
2025-12-06T09:19:37.058785042Z[36m [INFO][NRF][Init] [0mnrfconfig Info: Version[1.0.2] Description[NRF initial test configuration]
2025-12-06T09:19:37.058794584Z[36m [INFO][NRF][SBI] [0mBinding addr: [127.0.0.10:8000]
AMF Config failed: invalid T3555: non zero value required
2025-12-06T09:19:37.059099337Z[36m [INFO][AMF][Main] [0mLog enable is set to [true]
2025-12-06T09:19:37.059102368Z[36m [INFO][AMF][Main] [0mLog level is set to [info]
2025-12-06T09:19:37.059104622Z[36m [INFO][AMF][Main] [0mReport Caller is set to [false]
2025-12-06T09:19:37.059142540Z[36m [INFO][AMF][SBI] [0mBinding addr: [127.0.0.18:8000]
2025-12-06T09:19:37.059546514Z[36m [INFO][SMF][Main] [0mLog enable is set to [true]
2025-12-06T09:19:37.059550355Z[36m [INFO][SMF][Main] [0mLog level is set to [info]
2025-12-06T09:19:37.059554480Z[36m [INFO][SMF][Main] [0mReport Caller is set to [false]
2025-12-06T09:19:37.059558638Z[36m [INFO][SMF][CTX] [0msmfconfig Info: Version[1.0.7] Description[SMF initial single test configuration]
2025-12-06T09:19:37.059597333Z[36m [INFO][SMF][CTX] [0mEndpoints: [10.200.200.102]
2025-12-06T09:19:37.059723309Z[36m [INFO][UDR][Util] [0mudrconfig Info: Version[1.1.0] Description[UDR initial test configuration]
2025-12-06T09:19:37.059737382Z[36m [INFO][UDR][Main] [0mLog enable is set to [true]
2025-12-06T09:19:37.059739954Z[36m [INFO][UDR][Main] [0mLog level is set to [info]
2025-12-06T09:19:37.059742274Z[36m [INFO][UDR][Main] [0mReport Caller is set to [false]
2025-12-06T09:19:37.060082800Z[36m [INFO][PCF][Main] [0mLog enable is set to [true]
2025-12-06T09:19:37.060086422Z[36m [INFO][PCF][Main] [0mLog level is set to [info]
2025-12-06T09:19:37.060088774Z[36m [INFO][PCF][Main] [0mReport Caller is set to [false]
2025-12-06T09:19:37.060091817Z[36m [INFO][PCF][Util] [0mpcfconfig Info: Version[1.0.2] Description[PCF initial test configuration]
2025-12-06T09:19:37.060216915Z[36m [INFO][PCF][SBI] [0mBinding addr: [127.0.0.7:8000]
2025-12-06T09:19:37.060629544Z[36m [INFO][UDM][Main] [0mLog enable is set to [true]
2025-12-06T09:19:37.060634775Z[36m [INFO][UDM][Main] [0mLog level is set to [info]
2025-12-06T09:19:37.060637368Z[36m [INFO][UDM][Main] [0mReport Caller is set to [false]
2025-12-06T09:19:37.060640411Z[36m [INFO][UDM][Util] [0mudmconfig Info: Version[1.0.3] Description[UDM initial test configuration]
2025-12-06T09:19:37.060717647Z[36m [INFO][UDM][SBI] [0mBinding addr: [127.0.0.3:8000]
2025-12-06T09:19:37.060729717Z[36m [INFO][NSSF][Main] [0mLog enable is set to [true]
2025-12-06T09:19:37.060732266Z[36m [INFO][NSSF][Main] [0mLog level is set to [info]
2025-12-06T09:19:37.060736086Z[36m [INFO][NSSF][Main] [0mReport Caller is set to [false]
2025-12-06T09:19:37.060846643Z[36m [INFO][AUSF][Main] [0mLog enable is set to [true]
2025-12-06T09:19:37.060849368Z[36m [INFO][AUSF][Main] [0mLog level is set to [info]
2025-12-06T09:19:37.060851666Z[36m [INFO][AUSF][Main] [0mReport Caller is set to [false]
2025-12-06T09:19:37.060859042Z[36m [INFO][AUSF][Init] [0mausfconfig Info: Version[1.0.3] Description[AUSF initial test configuration]
ausf context =  &{{{} {{{} 0} {0 0} {[] {} <nil>} <nil> <nil> 0}} {{} {{{} 0} {0 0} {[] {} <nil>} <nil> <nil> 0}} 970541b3-f87a-4638-9c8e-00b59b58a224 ausfGroup001 8000 127.0.0.9 127.0.0.9 http://127.0.0.9:8000 http http://127.0.0.10:8000 ../cert/nrf.pem map[nausf-auth:{970541b3-f87a-4638-9c8e-00b59b58a224 nausf-auth [{v1 1.0.3 <nil>}] http REGISTERED   [{127.0.0.9   8000}]  [] [] [] [] [] [] map[] map[] 0 0 0 <nil> <nil>  [] [] []  map[] false <nil>}] [{208 93} {123 45}]  0xc000819220 false false}
2025-12-06T09:19:37.060902475Z[36m [INFO][AUSF][SBI] [0mBinding addr: [127.0.0.9:8000]
CHF Config failed: invalid Cgf.PassiveTransferPortRange.End: non zero value required;Cgf.PassiveTransferPortRange.Start: non zero value required
2025-12-06T09:19:37.061005755Z[36m [INFO][CHF][Main] [0mLog enable is set to [true]
2025-12-06T09:19:37.061008327Z[36m [INFO][CHF][Main] [0mLog level is set to [info]
2025-12-06T09:19:37.061010570Z[36m [INFO][CHF][Main] [0mReport Caller is set to [false]
2025-12-06T09:19:37.061016282Z[36m [INFO][CHF][Init] [0mchfconfig Info: Version[1.0.3] Description[CHF initial test configuration]
2025-12-06T09:19:37.061025868Z[36m [INFO][CHF][SBI] [0mBinding addr: [127.0.0.113:8000]
NfStart 9
2025-12-06T09:19:37.061144691Z[36m [INFO][NRF][Init] [0mServer starting
2025-12-06T09:19:37.061173537Z[36m [INFO][NRF][SBI] [0mSBI server started
2025-12-06T09:19:37.287309558Z[36m [INFO][AMF][Util] [0mamfconfig Info: Version[1.0.9]
2025-12-06T09:19:37.287443676Z[36m [INFO][AMF][Init] [0mServer started
2025-12-06T09:19:37.287774102Z[36m [INFO][AMF][Ngap] [0mListen on 10.200.200.1:38412
2025-12-06T09:19:37.288677874Z[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-12-06T09:19:37.290492724Z[36m [INFO][NRF][NFM] [0murilist update
2025-12-06T09:19:37.301794976Z[36m [INFO][NRF][NFM] [0mCreate NF Profile: 5cad6cf2-9fdc-40c9-8a84-fbf0a171d963
2025-12-06T09:19:37.303356456Z[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/5cad6cf2-9fdc-40c9-8a84-fbf0a171d963 |  |
2025-12-06T09:19:37.303518763Z[36m [INFO][AMF][Main] [0mOAuth2 setting receive from NRF: false
2025-12-06T09:19:37.303527758Z[36m [INFO][AMF][SBI] [0mStart SBI server (listen on 127.0.0.18:8000)
2025-12-06T09:19:37.491351088Z[36m [INFO][SMF][Init] [0mServer started
2025-12-06T09:19:37.491958222Z[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-12-06T09:19:37.492756813Z[36m [INFO][NRF][NFM] [0murilist update
2025-12-06T09:19:37.493240507Z[36m [INFO][NRF][NFM] [0mCreate NF Profile: 7081b0cf-b3ea-447e-8104-f92573c50df7
2025-12-06T09:19:37.494088279Z[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/7081b0cf-b3ea-447e-8104-f92573c50df7 |  |
2025-12-06T09:19:37.494269528Z[36m [INFO][SMF][Main] [0mOAuth2 setting receive from NRF: false
2025-12-06T09:19:37.494627454Z[36m [INFO][SMF][Init] [0mSMF Registration to NRF {7081b0cf-b3ea-447e-8104-f92573c50df7  SMF REGISTERED [] 0 [{208 93}] [] [{1 fedcba [] false} {1 112233 [] false}] [] []   [127.0.0.2] [] [] [] [] [] [] 0 0 0 <nil> area1 <nil> map[] <nil> map[] <nil> map[] <nil> map[] 0xc0008ed8c0 map[] <nil> map[] <nil> map[] <nil> map[] <nil> map[] <nil> <nil> <nil> map[] <nil> map[] map[] map[] map[oauth2:false] <nil> false [{7081b0cf-b3ea-447e-8104-f92573c50df7nsmf-pdusession nsmf-pdusession [{v1 https://127.0.0.2:8000/nsmf-pdusession/v1 2025-12-06 09:19:37.059607992 +0000 UTC}] https REGISTERED   [{127.0.0.2   8000}] http://127.0.0.2:8000 [] [] [] [] [] [] map[] map[] 0 0 0 <nil> <nil>  [] [] []  map[] false <nil>} {7081b0cf-b3ea-447e-8104-f92573c50df7nsmf-event-exposure nsmf-event-exposure [{v1 https://127.0.0.2:8000/nsmf-pdusession/v1 2025-12-06 09:19:37.059607992 +0000 UTC}] https REGISTERED   [{127.0.0.2   8000}] http://127.0.0.2:8000 [] [] [] [] [] [] map[] map[] 0 0 0 <nil> <nil>  [] [] []  map[] false <nil>} {7081b0cf-b3ea-447e-8104-f92573c50df7nsmf-oam nsmf-oam [{v1 https://127.0.0.2:8000/nsmf-pdusession/v1 2025-12-06 09:19:37.059607992 +0000 UTC}] https REGISTERED   [{127.0.0.2   8000}] http://127.0.0.2:8000 [] [] [] [] [] [] map[] map[] 0 0 0 <nil> <nil>  [] [] []  map[] false <nil>}] map[] false false [] <nil> <nil> [] [] false false map[] map[] [] <nil> <nil>  map[] map[] <nil> <nil> map[] <nil> map[] map[] map[] map[] <nil> <nil> [] <nil> <nil>}
2025-12-06T09:19:37.494668041Z[36m [INFO][SMF][PFCP] [0mListen on 10.200.200.1:8805
2025-12-06T09:19:37.494675045Z[36m [INFO][SMF][PFCP] [0mPfcp running... [2025-12-06 09:19:37.494671893 +0000 UTC m=+0.474332754]
2025-12-06T09:19:37.494682519Z[36m [INFO][SMF][SBI] [0mStart SBI server (listen on 127.0.0.2:8000)
2025-12-06T09:19:37.879552484Z[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-12-06T09:19:37.880311669Z[36m [INFO][NRF][NFM] [0murilist update
2025-12-06T09:19:37.880737993Z[36m [INFO][NRF][NFM] [0mCreate NF Profile: 26ded896-3245-4064-83b7-13fb165de2d9
2025-12-06T09:19:37.881605279Z[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/26ded896-3245-4064-83b7-13fb165de2d9 |  |
2025-12-06T09:19:37.881713189Z[36m [INFO][UDR][Main] [0mOAuth2 setting receive from NRF: false
2025-12-06T09:19:37.881718058Z[36m [INFO][UDR][Init] [0mregister to NRF successfully
2025-12-06T09:19:37.881720915Z[36m [INFO][UDR][Init] [0mServer started
2025-12-06T09:19:37.881723957Z[36m [INFO][UDR][Init] [0mUDR Config Info: Version[1.1.0] Description[UDR initial test configuration]
2025-12-06T09:19:37.881726463Z[36m [INFO][UDR][SBI] [0mStarting server...
2025-12-06T09:19:38.127373929Z[36m [INFO][PCF][Init] [0mServer started
2025-12-06T09:19:38.128157123Z[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-12-06T09:19:38.129320486Z[36m [INFO][NRF][NFM] [0murilist update
2025-12-06T09:19:38.129931218Z[36m [INFO][NRF][NFM] [0mCreate NF Profile: d80156b2-bb06-4ba0-b7d9-cf92351fafbe
2025-12-06T09:19:38.130629311Z[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/d80156b2-bb06-4ba0-b7d9-cf92351fafbe |  |
2025-12-06T09:19:38.130802703Z[36m [INFO][PCF][Main] [0mOAuth2 setting receive from NRF: false
2025-12-06T09:19:38.130813581Z[36m [INFO][PCF][SBI] [0mStart SBI server (listen on 127.0.0.7:8000)
2025-12-06T09:19:38.416222527Z[36m [INFO][UDM][Init] [0mServer started
2025-12-06T09:19:38.416263246Z[36m [INFO][UDM][SBI] [0mStarting server...
2025-12-06T09:19:38.416677659Z[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-12-06T09:19:38.417660561Z[36m [INFO][NRF][NFM] [0murilist update
2025-12-06T09:19:38.418242774Z[36m [INFO][NRF][NFM] [0mCreate NF Profile: 336e2599-e680-4216-9402-ac977d755af2
2025-12-06T09:19:38.419162395Z[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/336e2599-e680-4216-9402-ac977d755af2 |  |
2025-12-06T09:19:38.419303714Z[36m [INFO][UDM][Main] [0mOAuth2 setting receive from NRF: false
2025-12-06T09:19:38.419312775Z[36m [INFO][UDM][SBI] [0mStart SBI server (listen on 127.0.0.3:8000)
2025-12-06T09:19:38.741391294Z[36m [INFO][SMF][Main] [0mSending PFCP Association Request to UPF[10.200.200.101]
2025-12-06T09:19:38.741655156Z[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleAssociationSetupRequest
2025-12-06T09:19:38.741704738Z[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1] [0mNew node
2025-12-06T09:19:38.741842027Z[36m [INFO][SMF][Main] [0mReceived PFCP Association Setup Accepted Response from UPF[10.200.200.101]
2025-12-06T09:19:38.741848418Z[36m [INFO][SMF][Main] [0mUPF(10.200.200.101) setup association
2025-12-06T09:19:38.741895818Z[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-12-06T09:19:38.742815570Z[36m [INFO][NRF][NFM] [0murilist update
2025-12-06T09:19:38.743259136Z[36m [INFO][NRF][NFM] [0mCreate NF Profile: 575f579f-0f6c-482d-bf43-0cdec18f67a4
2025-12-06T09:19:38.743824954Z[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/575f579f-0f6c-482d-bf43-0cdec18f67a4 |  |
2025-12-06T09:19:38.743951106Z[36m [INFO][NSSF][Main] [0mOAuth2 setting receive from NRF: false
2025-12-06T09:19:38.743955559Z[36m [INFO][NSSF][Main] [0mregister to NRF successfully
2025-12-06T09:19:38.743958405Z[36m [INFO][NSSF][SBI] [0mStarting server...
2025-12-06T09:19:38.976600044Z[36m [INFO][AUSF][Init] [0mServer started
2025-12-06T09:19:38.976997933Z[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-12-06T09:19:38.977872015Z[36m [INFO][NRF][NFM] [0murilist update
2025-12-06T09:19:38.978392132Z[36m [INFO][NRF][NFM] [0mCreate NF Profile: 970541b3-f87a-4638-9c8e-00b59b58a224
2025-12-06T09:19:38.979229839Z[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/970541b3-f87a-4638-9c8e-00b59b58a224 |  |
2025-12-06T09:19:38.979378446Z[36m [INFO][AUSF][Main] [0mOAuth2 setting receive from NRF: false
2025-12-06T09:19:38.979385209Z[36m [INFO][AUSF][SBI] [0mStart SBI server (listen on 127.0.0.9:8000)
2025-12-06T09:19:39.227073868Z[36m [INFO][CHF][Init] [0mServer started
2025-12-06T09:19:39.227527435Z[36m [INFO][CHF][Acct] [0mOpen Account Balance Management Server
2025-12-06T09:19:39.228577205Z[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-12-06T09:19:39.229445016Z[36m [INFO][NRF][NFM] [0murilist update
2025-12-06T09:19:39.230054240Z[36m [INFO][NRF][NFM] [0mCreate NF Profile: 306a8573-058a-48f1-971c-14870792051f
2025-12-06T09:19:39.230714740Z[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/306a8573-058a-48f1-971c-14870792051f |  |
2025-12-06T09:19:39.230838200Z[36m [INFO][CHF][Main] [0mOAuth2 setting receive from NRF: false
2025-12-06T09:19:39.230848278Z[36m [INFO][CHF][SBI] [0mStart SBI server (listen on 127.0.0.113:8000)
=== RUN   TestCN
2025-12-06T09:19:46.317397800Z[36m [INFO][TNGF][Main] [0mTNGF version:  
	free5GC version: v4.1.0-26-gf454591
	build time:      2025-12-06T09:12:30Z
	commit hash:     afd36f63
	commit time:     2025-09-27T14:44:37Z
	go version:      go1.24.2 linux/amd64
2025-12-06T09:19:46.317619698Z[36m [INFO][TNGF][CFG] [0mRead config from [./config/tngfcfg.test.yaml]
2025-12-06T09:19:46.318140050Z[33m [WARN][TNGF][Context] [0mParse PKCS8 private key failed: x509: failed to parse private key (use ParsePKCS1PrivateKey instead for this key format)
2025-12-06T09:19:46.318144953Z[36m [INFO][TNGF][Context] [0mParse using PKCS1...
2025-12-06T09:19:46.318537885Z[36m [INFO][TNGF][Main] [0mLog enable is set to[true]
2025-12-06T09:19:46.318542919Z[36m [INFO][TNGF][Main] [0mLog level is set to [info]
2025-12-06T09:19:46.318555087Z[36m [INFO][TNGF][Main] [0mReport Caller is set to [false]
2025-12-06T09:19:46.318558513Z[36m [INFO][TNGF][Init] [0mServer started
2025-12-06T09:19:46.319115146Z[33m [WARN][TNGF][Init] [0mnetlink.RouteAdd: file exists
2025-12-06T09:19:46.319129219Z[36m [INFO][TNGF][Init] [0mSetup XFRM interface xfrmi-default
2025-12-06T09:19:46.321357963Z[36m [INFO][AMF][Ngap] [0m[AMF] SCTP Accept from: 10.200.200.1/10.0.2.15/172.17.0.1/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:35074
2025-12-06T09:19:46.321374728Z[36m [INFO][TNGF][Init] [0mNGAP service running.
2025-12-06T09:19:46.321385868Z[36m [INFO][TNGF][NGAP] [0m[TNGF] Send NG Setup Request
2025-12-06T09:19:46.321523761Z[36m [INFO][TNGF][Init] [0mNAS TCP server successfully started.
2025-12-06T09:19:46.321762719Z[36m [INFO][TNGF][Init] [0mListening NWt user plane traffic
2025-12-06T09:19:46.321785994Z[36m [INFO][AMF][Ngap] [0mCreate a new NG connection for: 10.200.200.1/10.0.2.15/172.17.0.1/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:35074
2025-12-06T09:19:46.321931187Z[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/172.17.0.1/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:35074] [0mHandle NGSetupRequest
2025-12-06T09:19:46.321937140Z[33m [WARN][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/172.17.0.1/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:35074] [0mMissing IE PagingDRX
2025-12-06T09:19:46.321952022Z[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/172.17.0.1/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:35074] [0mSend NG-Setup response
2025-12-06T09:19:46.321963869Z[36m [INFO][TNGF][Init] [0mIKE service running.
2025-12-06T09:19:46.321982013Z[36m [INFO][TNGF][Radius] [0mRadius packet received
2025-12-06T09:19:46.322017424Z[36m [INFO][TNGF][Init] [0mRadius service running.
2025-12-06T09:19:46.322021977Z[36m [INFO][TNGF][Init] [0mTNGF running...
2025-12-06T09:19:46.322381773Z[36m [INFO][TNGF][NGAP] [0m[TNGF] Handle NG Setup Response
Run TestTngfUE
os.Args: [/tmp/go-build539998954/b001/test.test -test.paniconexit0 -test.v=true -test.timeout=0s -test.run=TestTngfUE noinit]
MongoDB Set
=== RUN   TestTngfUE
2025-12-06T09:19:52.268954127Z[36m [INFO][TNGF][Radius] [0mHandle Radius Access Request
2025-12-06T09:19:52.269007047Z[36m [INFO][TNGF][Radius] [0mHandle EAP-Res/Identity
2025-12-06T09:19:52.269039099Z[36m [INFO][TNGF][Radius] [0mSend Radius message to UE
2025-12-06T09:19:52.269042153Z[36m [INFO][TNGF][Radius] [0mEncoding...
2025-12-06T09:19:52.269191022Z[36m [INFO][TNGF][Radius] [0mHandle Radius Access Request
2025-12-06T09:19:52.269207152Z[36m [INFO][TNGF][Radius] [0mHandle EAP-Res/5G-NAS
2025-12-06T09:19:52.269232419Z[36m [INFO][TNGF][Radius] [0mSelected AMF Name: AMF
2025-12-06T09:19:52.269240364Z[36m [INFO][TNGF][NGAP] [0m[TNGF] Send Initial UE Message
2025-12-06T09:19:52.269485652Z[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/172.17.0.1/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:35074] [0mHandle InitialUEMessage
2025-12-06T09:19:52.269517781Z[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/172.17.0.1/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:35074] [0mNew RanUe [RanUeNgapID:0][AmfUeNgapID:1]
2025-12-06T09:19:52.269546222Z[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/172.17.0.1/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:35074] [0m5GSMobileIdentity ["SUCI":"suci-0-208-93-0-0-0-0000007487", err: <nil>]
2025-12-06T09:19:52.269590202Z[36m [INFO][AMF][CTX] [0mNew AmfUe [supi:][guti:20893cafe0000000001]
2025-12-06T09:19:52.269604439Z[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [Deregistered] to [Deregistered]
2025-12-06T09:19:52.269608247Z[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mHandle Registration Request
2025-12-06T09:19:52.269612417Z[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mRegistrationType: Initial Registration
2025-12-06T09:19:52.269625100Z[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mMobileIdentity5GS: SUCI[suci-0-208-93-0-0-0-0000007487]
2025-12-06T09:19:52.269632245Z[36m [INFO][AMF][Gmm] [0mHandle event[Start Authentication], transition from [Deregistered] to [Authentication]
2025-12-06T09:19:52.269636185Z[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mAuthentication procedure
2025-12-06T09:19:52.270072966Z[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-12-06T09:19:52.271081726Z[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&target-nf-type=AUSF |  |
2025-12-06T09:19:52.271619963Z[36m [INFO][AUSF][UeAuth] [0mHandleUeAuthPostRequest
2025-12-06T09:19:52.271635863Z[36m [INFO][AUSF][UeAuth] [0mServing network authorized
2025-12-06T09:19:52.271797607Z[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-12-06T09:19:52.272549761Z[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AUSF&service-names=nudm-ueau&target-nf-type=UDM |  |
2025-12-06T09:19:52.306556187Z[36m [INFO][UDM][UEAU] [0mHandle GenerateAuthDataRequest
2025-12-06T09:19:52.306602597Z[36m [INFO][UDM][Suci] [0mscheme 0
2025-12-06T09:19:52.306606930Z[36m [INFO][UDM][Suci] [0mSUPI type is IMSI
2025-12-06T09:19:52.307299570Z[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-12-06T09:19:52.308048485Z[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=UDM&target-nf-type=UDR |  |
2025-12-06T09:19:52.309401817Z[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v2/subscription-data/imsi-208930000007487/authentication-data/authentication-subscription |  |
2025-12-06T09:19:52.309634823Z[36m [INFO][UDM][Proc] [0mModifyAuthenticationSubscriptionRequest:  [{replace /sequenceNumber  { 16f3b3f70fc3 map[] 0 }}]
2025-12-06T09:19:52.311104460Z[36m [INFO][UDR][GIN] [0m| 204 |       127.0.0.1 | PATCH   | /nudr-dr/v2/subscription-data/imsi-208930000007487/authentication-data/authentication-subscription |  |
2025-12-06T09:19:52.311228240Z[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | POST    | /nudm-ueau/v1/suci-0-208-93-0-0-0-0000007487/security-information/generate-auth-data |  |
2025-12-06T09:19:52.311334962Z[36m [INFO][AUSF][UeAuth] [0mAdd SuciSupiPair (suci-0-208-93-0-0-0-0000007487, imsi-208930000007487) to map.
2025-12-06T09:19:52.311344406Z[36m [INFO][AUSF][UeAuth] [0mUse 5G AKA auth method
2025-12-06T09:19:52.311348892Z[36m [INFO][AUSF][5gAka] [0mXresStar = 6234663539613161613763643131356665353033653765373864613864393163
2025-12-06T09:19:52.311384917Z[36m [INFO][AUSF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nausf-auth/v1/ue-authentications |  |
2025-12-06T09:19:52.311480422Z[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mSend Authentication Request
2025-12-06T09:19:52.311504989Z[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/172.17.0.1/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:35074] [0mSend Downlink Nas Transport
2025-12-06T09:19:52.311593180Z[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mStart T3560 timer
2025-12-06T09:19:52.311732003Z[36m [INFO][TNGF][NGAP] [0m[TNGF] Handle Downlink NAS Transport
2025-12-06T09:19:52.311755104Z[36m [INFO][TNGF][Radius] [0mSend Radius message to UE
2025-12-06T09:19:52.311758299Z[36m [INFO][TNGF][Radius] [0mEncoding...
2025-12-06T09:19:52.311940233Z[36m [INFO][TNGF][Radius] [0mHandle Radius Access Request
2025-12-06T09:19:52.311958628Z[36m [INFO][TNGF][Radius] [0mHandle EAP-Res/5G-NAS
2025-12-06T09:19:52.311971858Z[36m [INFO][TNGF][NGAP] [0m[TNGF] Send Uplink NAS Transport
2025-12-06T09:19:52.312095093Z[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/172.17.0.1/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:35074] [0mHandle UplinkNASTransport
2025-12-06T09:19:52.312161036Z[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/172.17.0.1/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:35074] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-12-06T09:19:52.312188110Z[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [Authentication] to [Authentication]
2025-12-06T09:19:52.312192552Z[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mHandle Authentication Response
2025-12-06T09:19:52.312196339Z[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mStop T3560 timer
2025-12-06T09:19:52.312412409Z[36m [INFO][AUSF][5gAka] [0mAuth5gAkaComfirmRequest
2025-12-06T09:19:52.312422849Z[36m [INFO][AUSF][5gAka] [0mres*: 6234663539613161613763643131356665353033653765373864613864393163
Xres*: 6234663539613161613763643131356665353033653765373864613864393163
2025-12-06T09:19:52.312428156Z[36m [INFO][AUSF][5gAka] [0m5G AKA confirmation succeeded
2025-12-06T09:19:52.312700977Z[36m [INFO][UDM][UEAU] [0mHandle ConfirmAuthDataRequest
2025-12-06T09:19:52.313880047Z[36m [INFO][UDR][GIN] [0m| 204 |       127.0.0.1 | PUT     | /nudr-dr/v2/subscription-data/imsi-208930000007487/authentication-data/authentication-status |  |
2025-12-06T09:19:52.314003328Z[36m [INFO][UDM][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudm-ueau/v1/imsi-208930000007487/auth-events |  |
2025-12-06T09:19:52.314135118Z[36m [INFO][AUSF][GIN] [0m| 200 |       127.0.0.1 | PUT     | /nausf-auth/v1/ue-authentications/suci-0-208-93-0-0-0-0000007487/5g-aka-confirmation |  |
2025-12-06T09:19:52.314243684Z[36m [INFO][AMF][Gmm] [0mHandle event[Authentication Success], transition from [Authentication] to [SecurityMode]
2025-12-06T09:19:52.314259782Z[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-208930000007487] [0mSend Security Mode Command
2025-12-06T09:19:52.314270156Z[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/172.17.0.1/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:35074] [0mSend Downlink Nas Transport
2025-12-06T09:19:52.314312210Z[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-208930000007487] [0mStart T3560 timer
2025-12-06T09:19:52.314374957Z[36m [INFO][TNGF][NGAP] [0m[TNGF] Handle Downlink NAS Transport
2025-12-06T09:19:52.314389632Z[36m [INFO][TNGF][Radius] [0mSend Radius message to UE
2025-12-06T09:19:52.314393024Z[36m [INFO][TNGF][Radius] [0mEncoding...
2025-12-06T09:19:52.314505174Z[36m [INFO][TNGF][Radius] [0mHandle Radius Access Request
2025-12-06T09:19:52.314519148Z[36m [INFO][TNGF][Radius] [0mHandle EAP-Res/5G-NAS
2025-12-06T09:19:52.314529041Z[36m [INFO][TNGF][NGAP] [0m[TNGF] Send Uplink NAS Transport
2025-12-06T09:19:52.314602343Z[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/172.17.0.1/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:35074] [0mHandle UplinkNASTransport
2025-12-06T09:19:52.314608296Z[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/172.17.0.1/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:35074] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-12-06T09:19:52.314625225Z[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [SecurityMode] to [SecurityMode]
2025-12-06T09:19:52.314628737Z[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-208930000007487] [0mHandle Security Mode Complete
2025-12-06T09:19:52.314631823Z[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-208930000007487] [0mStop T3560 timer
2025-12-06T09:19:52.314645820Z[36m [INFO][AMF][Gmm] [0mHandle event[SecurityMode Success], transition from [SecurityMode] to [ContextSetup]
2025-12-06T09:19:52.314650033Z[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-208930000007487] [0mHandle InitialRegistration
2025-12-06T09:19:52.314860900Z[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-12-06T09:19:52.315512604Z[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&supi=imsi-208930000007487&target-nf-type=UDM |  |
2025-12-06T09:19:52.315920488Z[36m [INFO][UDM][Consumer] [0mTwoLayerPathHandlerFunc,  imsi-208930000007487 nssai
2025-12-06T09:19:52.315937274Z[36m [INFO][UDM][SDM] [0mHandle GetNssai
2025-12-06T09:19:52.316198441Z[36m [INFO][UDR][DataRepo] [0mQueryAmDataProcedure: ueId: imsi-208930000007487, servingPlmnId: 20893
2025-12-06T09:19:52.316626128Z[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v2/subscription-data/imsi-208930000007487/20893/provisioned-data/am-data?supported-features= |  |
2025-12-06T09:19:52.316816012Z[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v2/imsi-208930000007487/nssai?plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-12-06T09:19:52.317194253Z[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-12-06T09:19:52.317856860Z[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&supi=imsi-208930000007487&target-nf-type=UDM |  |
2025-12-06T09:19:52.318340444Z[36m [INFO][UDM][UECM] [0mHandle RegisterAmfNon3gppAccessRequest
2025-12-06T09:19:52.319259037Z[36m [INFO][UDR][GIN] [0m| 204 |       127.0.0.1 | PUT     | /nudr-dr/v2/subscription-data/imsi-208930000007487/context-data/amf-non-3gpp-access |  |
2025-12-06T09:19:52.319409132Z[36m [INFO][UDM][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nudm-uecm/v1/imsi-208930000007487/registrations/amf-non-3gpp-access |  |
2025-12-06T09:19:52.319828207Z[36m [INFO][UDM][Consumer] [0mTwoLayerPathHandlerFunc,  imsi-208930000007487 am-data
2025-12-06T09:19:52.319849491Z[36m [INFO][UDM][SDM] [0mHandle GetAmData
2025-12-06T09:19:52.319989906Z[36m [INFO][UDR][DataRepo] [0mQueryAmDataProcedure: ueId: imsi-208930000007487, servingPlmnId: 20893
2025-12-06T09:19:52.320381476Z[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v2/subscription-data/imsi-208930000007487/20893/provisioned-data/am-data?supported-features= |  |
2025-12-06T09:19:52.320600637Z[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v2/imsi-208930000007487/am-data?plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-12-06T09:19:52.320808802Z[36m [INFO][UDM][Consumer] [0mTwoLayerPathHandlerFunc,  imsi-208930000007487 smf-select-data
2025-12-06T09:19:52.320826191Z[36m [INFO][UDM][SDM] [0mHandle GetSmfSelectData
2025-12-06T09:19:52.321336900Z[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v2/subscription-data/imsi-208930000007487/20893/provisioned-data/smf-selection-subscription-data?supported-features= |  |
2025-12-06T09:19:52.321466097Z[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v2/imsi-208930000007487/smf-select-data?plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-12-06T09:19:52.321665501Z[36m [INFO][UDM][Consumer] [0mTwoLayerPathHandlerFunc,  imsi-208930000007487 ue-context-in-smf-data
2025-12-06T09:19:52.321682025Z[36m [INFO][UDM][SDM] [0mHandle GetUeContextInSmfData
2025-12-06T09:19:52.322044445Z[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v2/subscription-data/imsi-208930000007487/context-data/smf-registrations?supported-features= |  |
2025-12-06T09:19:52.322151120Z[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v2/imsi-208930000007487/ue-context-in-smf-data |  |
2025-12-06T09:19:52.322564899Z[36m [INFO][UDM][Consumer] [0mTwoLayerPathHandlerFunc,  imsi-208930000007487 sdm-subscriptions
2025-12-06T09:19:52.322600453Z[36m [INFO][UDM][SDM] [0mHandle Subscribe
2025-12-06T09:19:52.322770530Z[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v2/subscription-data/imsi-208930000007487/context-data/sdm-subscriptions |  |
2025-12-06T09:19:52.322842502Z[36m [INFO][UDM][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudm-sdm/v2/imsi-208930000007487/sdm-subscriptions |  |
2025-12-06T09:19:52.323096644Z[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-12-06T09:19:52.323976637Z[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&supi=imsi-208930000007487&target-nf-type=PCF |  |
2025-12-06T09:19:52.324640620Z[36m [INFO][PCF][AmPol] [0mHandle AM Policy Create Request
2025-12-06T09:19:52.324774262Z[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-12-06T09:19:52.325220372Z[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=UDR |  |
2025-12-06T09:19:52.325924579Z[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v2/policy-data/ues/imsi-208930000007487/am-data |  |
2025-12-06T09:19:52.326136278Z[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-12-06T09:19:52.326961113Z[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?guami=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22amfId%22%3A%22cafe00%22%7D&requester-nf-type=PCF&target-nf-type=AMF |  |
2025-12-06T09:19:52.327881382Z[36m [INFO][AMF][Comm] [0mHandle AMF Status Change Subscribe Request
2025-12-06T09:19:52.327897578Z[36m [INFO][AMF][Comm] [0mnew AMF Status Subscription[1]
2025-12-06T09:19:52.327909528Z[36m [INFO][AMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /namf-comm/v1/subscriptions |  |
2025-12-06T09:19:52.328077356Z[36m [INFO][PCF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-am-policy-control/v1/policies |  |
2025-12-06T09:19:52.328177807Z[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-208930000007487] [0mSend Registration Accept
2025-12-06T09:19:52.328194988Z[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/172.17.0.1/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:35074] [0mSend Initial Context Setup Request
2025-12-06T09:19:52.328271272Z[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-208930000007487] [0mStart T3550 timer
2025-12-06T09:19:52.328405329Z[36m [INFO][TNGF][NGAP] [0m[TNGF] Handle Initial Context Setup Request
2025-12-06T09:19:52.328422247Z[36m [INFO][TNGF][Radius] [0mSend Radius message to UE
2025-12-06T09:19:52.328425563Z[36m [INFO][TNGF][Radius] [0mEncoding...
2025-12-06T09:19:52.328558691Z[36m [INFO][TNGF][Radius] [0mHandle Radius Access Request
2025-12-06T09:19:52.328572644Z[36m [INFO][TNGF][Radius] [0mHandle EAP-Res/5G-Notification
2025-12-06T09:19:52.328585928Z[36m [INFO][TNGF][Radius] [0mSend Radius message to UE
2025-12-06T09:19:52.328588664Z[36m [INFO][TNGF][Radius] [0mEncoding...
2025-12-06T09:19:52.330992595Z[36m [INFO][TNGF][IKE] [0mEncoding IKE message
2025-12-06T09:19:52.331026267Z[36m [INFO][TNGF][IKE] [0mEncoding IKE payloads
2025-12-06T09:19:52.331032449Z[36m [INFO][TNGF][IKE] [0m[SecurityAssociation] marshal(): Start marshaling
2025-12-06T09:19:52.331036312Z[36m [INFO][TNGF][IKE] [0m[KeyExchange] marshal(): Start marshaling
2025-12-06T09:19:52.331038917Z[36m [INFO][TNGF][IKE] [0m[Nonce] marshal(): Start marshaling
2025-12-06T09:19:52.331076648Z[36m [INFO][TNGF][IKE] [0mEncoding IKE message
2025-12-06T09:19:52.331079395Z[36m [INFO][TNGF][IKE] [0mEncoding IKE payloads
2025-12-06T09:19:52.331081945Z[36m [INFO][TNGF][IKE] [0m[SecurityAssociation] marshal(): Start marshaling
2025-12-06T09:19:52.331084549Z[36m [INFO][TNGF][IKE] [0m[KeyExchange] marshal(): Start marshaling
2025-12-06T09:19:52.331086771Z[36m [INFO][TNGF][IKE] [0m[Nonce] marshal(): Start marshaling
2025-12-06T09:19:52.331116487Z[36m [INFO][TNGF][IKE] [0mDecoding IKE message
2025-12-06T09:19:52.331180230Z[36m [INFO][TNGF][IKE] [0mDecoding IKE payloads
2025-12-06T09:19:52.331188601Z[36m [INFO][TNGF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-12-06T09:19:52.331193383Z[36m [INFO][TNGF][IKE] [0m[KeyExchange] unmarshal(): Start unmarshalling received bytes
2025-12-06T09:19:52.331196743Z[36m [INFO][TNGF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-12-06T09:19:52.331207062Z[36m [INFO][TNGF][IKE] [0mHandle IKE_SA_INIT
2025-12-06T09:19:52.335576671Z[36m [INFO][TNGF][IKE] [0mEncoding IKE message
2025-12-06T09:19:52.335586541Z[36m [INFO][TNGF][IKE] [0mEncoding IKE payloads
2025-12-06T09:19:52.335589769Z[36m [INFO][TNGF][IKE] [0m[SecurityAssociation] marshal(): Start marshaling
2025-12-06T09:19:52.335593862Z[36m [INFO][TNGF][IKE] [0m[KeyExchange] marshal(): Start marshaling
2025-12-06T09:19:52.335600198Z[36m [INFO][TNGF][IKE] [0m[Nonce] marshal(): Start marshaling
2025-12-06T09:19:52.335618440Z[36m [INFO][TNGF][IKE] [0mNonceRData:  00000000  37 57 d2 23 16 e1 f1 52  4e 03 e6 c1 b8 e2 ce 11  |7W.#...RN.......|
00000010  1f ea ee 8c 0d c6 61 97  e7 1a 6d 1e c1 66 19 66  |......a...m..f.f|
00000020  c6 6b 83 36 aa 26 a0 e9  fc 2b d3 da 2e ba 98 31  |.k.6.&...+.....1|
00000030  07 1f 01 13 30 06 a0 6d  e5 39 25 a4 b8 50 4b 38  |....0..m.9%..PK8|
00000040  22 7b 26 b8 2b 76 e6 61  68 ce a8 93 dc 3d cc 9a  |"{&.+v.ah....=..|
00000050  07 e2 93 43 7f 6c 41 a1  d0 28 a0 69 61 f7 e8 1a  |...C.lA..(.ia...|
00000060  7b d7 69 1c bd 3c 3d 08  b4 93 89 2d 64 e7 5b 57  |{.i..<=....-d.[W|
00000070  3d c7 8b 2a d4 d9 d3 81  4c 52 fe 9d a4 fe 38 93  |=..*....LR....8.|
00000080  a8 6a a1 28 0e 3f 62 86  3a c8 dd 01 62 89 a4 22  |.j.(.?b.:...b.."|
00000090  d4 fa f1 06 cd 99 5d 54  b6 30 97 af 44 41 15 b2  |......]T.0..DA..|
000000a0  01 94 00 40 ca a0 02 c1  92 ef a6 80 eb d2 be 40  |...@...........@|
000000b0  ef 9b 67 99 60 a1 68 71  69 25 b5 a4 81 b2 8a 10  |..g.`.hqi%......|
000000c0  93 49 f7 dc f5 16 7c 17  ed d9 8c 4a cf 23 7c 22  |.I....|....J.#|"|
000000d0  61 e2 78 a8 38 33 f6 aa  24 10 c2 91 12 9e 27 20  |a.x.83..$.....' |
000000e0  8e d7 b8 82 a2 af e5 7b  c2 6f 66 5e f8 b3 fe 38  |.......{.of^...8|
000000f0  48 1d fb 50 32 7c d9 15  ac 3a e7 dc 45 e6 68 d5  |H..P2|...:..E.h.|
2025-12-06T09:19:52.335621734Z[36m [INFO][TNGF][IKE] [0mEncoding IKE message
2025-12-06T09:19:52.335623956Z[36m [INFO][TNGF][IKE] [0mEncoding IKE payloads
2025-12-06T09:19:52.335626494Z[36m [INFO][TNGF][IKE] [0m[SecurityAssociation] marshal(): Start marshaling
2025-12-06T09:19:52.335629044Z[36m [INFO][TNGF][IKE] [0m[KeyExchange] marshal(): Start marshaling
2025-12-06T09:19:52.335631397Z[36m [INFO][TNGF][IKE] [0m[Nonce] marshal(): Start marshaling
2025-12-06T09:19:52.335633848Z[36m [INFO][TNGF][IKE] [0m[Notification] marshal(): Start marshaling
2025-12-06T09:19:52.335636168Z[36m [INFO][TNGF][IKE] [0m[Notification] marshal(): Start marshaling
2025-12-06T09:19:52.335651609Z[36m [INFO][TNGF][IKE] [0mEncoding IKE payloads
2025-12-06T09:19:52.335655592Z[36m [INFO][TNGF][IKE] [0m[Identification] marshal(): Start marshaling
2025-12-06T09:19:52.335675826Z[36m [INFO][TNGF][IKE] [0mEncoding IKE message
2025-12-06T09:19:52.335678047Z[36m [INFO][TNGF][IKE] [0mEncoding IKE payloads
2025-12-06T09:19:52.335680115Z[36m [INFO][TNGF][IKE] [0m[SecurityAssociation] marshal(): Start marshaling
2025-12-06T09:19:52.335682512Z[36m [INFO][TNGF][IKE] [0m[KeyExchange] marshal(): Start marshaling
2025-12-06T09:19:52.335686462Z[36m [INFO][TNGF][IKE] [0m[Nonce] marshal(): Start marshaling
2025-12-06T09:19:52.335690588Z[36m [INFO][TNGF][IKE] [0m[Notification] marshal(): Start marshaling
2025-12-06T09:19:52.335692820Z[36m [INFO][TNGF][IKE] [0m[Notification] marshal(): Start marshaling
2025-12-06T09:19:52.335779232Z[36m [INFO][TNGF][IKE] [0mDecoding IKE message
2025-12-06T09:19:52.335804642Z[36m [INFO][TNGF][IKE] [0mDecoding IKE payloads
2025-12-06T09:19:52.335808395Z[36m [INFO][TNGF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-12-06T09:19:52.335812302Z[36m [INFO][TNGF][IKE] [0m[KeyExchange] unmarshal(): Start unmarshalling received bytes
2025-12-06T09:19:52.335819798Z[36m [INFO][TNGF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-12-06T09:19:52.335822753Z[36m [INFO][TNGF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-12-06T09:19:52.335825269Z[36m [INFO][TNGF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    tngf_test.go:1313: Get SA payload
ktngf:  00000000  81 0d e1 b3 d1 ce 13 6d  1e 32 2b 29 c6 c6 4d d7  |.......m.2+)..M.|
00000010  fb 21 0f ad 6c a7 3d 07  72 cc 6a 39 43 be f8 1e  |.!..l.=.r.j9C...|

2025-12-06T09:19:52.338028789Z[36m [INFO][TNGF][IKE] [0mEncoding IKE payloads
2025-12-06T09:19:52.338036033Z[36m [INFO][TNGF][IKE] [0m[Identification] marshal(): Start marshaling
ktipsec:  00000000  ee 76 fb 71 f0 37 fc 6c  54 b7 93 71 e3 54 cf 23  |.v.q.7.lT..q.T.#|
00000010  6f 39 14 29 20 ce 50 4d  1f 9f 23 78 28 bf 34 4e  |o9.) .PM..#x(.4N|

    tngf_test.go:1430: Using key to authentication: 00000000  ce 30 d6 0a 66 e6 3d 77  59 22 26 8d f1 3e b1 d4  |.0..f.=wY"&..>..|
        00000010  63 77 73 b1                                       |cws.|
        
    tngf_test.go:1438: InitoatorSignedOctets:  00000000  00 00 00 00 00 01 e0 f3  00 00 00 00 00 00 00 00  |................|
        00000010  21 20 22 08 00 00 00 00  00 00 02 54 22 00 00 2c  |! "........T"..,|
        00000020  00 00 00 28 01 01 00 04  03 00 00 08 01 00 00 0b  |...(............|
        00000030  03 00 00 08 02 00 00 02  03 00 00 08 03 00 00 02  |................|
        00000040  00 00 00 08 04 00 00 0e  28 00 01 08 00 0e 00 00  |........(.......|
        00000050  29 78 11 8e b5 c8 eb 0b  be 49 08 dd 61 59 1c 7d  |)x.......I..aY.}|
        00000060  36 af 08 05 f6 5d 86 1c  87 56 cb b0 d1 f3 3c 55  |6....]...V....<U|
        00000070  f2 f7 1d 60 a8 d7 e5 78  d0 ed a9 ef 3e 3b b4 4c  |...`...x....>;.L|
        00000080  b8 9f 3a 37 f3 78 c5 6d  21 60 f1 60 df e3 30 98  |..:7.x.m!`.`..0.|
        00000090  2b 41 92 b9 e5 7d 62 68  bf 1a 33 22 01 9a b7 b6  |+A...}bh..3"....|
        000000a0  14 16 74 c3 01 8e e5 62  44 80 d8 95 55 0d 5c 99  |..t....bD...U.\.|
        000000b0  6a 3c 75 03 1a f6 c0 1d  ec 87 02 60 3a fa 2b 0a  |j<u........`:.+.|
        000000c0  45 61 65 e0 7b 8c d7 d7  20 01 22 3f 1b 64 16 3c  |Eae.{... ."?.d.<|
        000000d0  aa a3 c0 74 62 17 3c fb  35 77 73 f5 4a 61 d8 39  |...tb.<.5ws.Ja.9|
        000000e0  3a e4 6a 17 5e 2e 63 2b  64 4c 74 20 1d 60 23 b9  |:.j.^.c+dLt .`#.|
        000000f0  0e 37 65 0b a9 fd 83 9a  7b 4e d3 43 b1 c2 22 4c  |.7e.....{N.C.."L|
        00000100  71 3b c2 e3 79 3b a0 7c  c2 ed db c8 83 b3 97 92  |q;..y;.|........|
        00000110  71 e2 af 14 27 13 53 f2  d5 09 c1 28 71 20 46 54  |q...'.S....(q FT|
        00000120  38 ec 61 13 63 e0 36 7a  70 15 fb b8 0b da 56 4d  |8.a.c.6zp.....VM|
        00000130  9e 80 32 49 df de b1 34  62 bc f2 4d 71 fd 85 b2  |..2I...4b..Mq...|
        00000140  52 89 d1 0f 4e d8 40 a6  8f 82 9b 8c 53 7d ff 38  |R...N.@.....S}.8|
        00000150  00 00 01 04 75 98 39 ab  a7 3b 82 e1 bd cc 30 94  |....u.9..;....0.|
        00000160  22 81 03 ec ff 87 bb 04  ab e4 12 51 9a ac 12 7a  |"..........Q...z|
        00000170  df b0 07 5e 9c db 4e f5  12 38 a7 d8 4f 9d 83 09  |...^..N..8..O...|
        00000180  a4 30 45 29 f5 0a cf a2  be a7 f5 1b ff ef 9c 73  |.0E)...........s|
        00000190  38 8c 29 5e 05 07 c9 d8  04 32 c3 f9 dd 4d 81 9d  |8.)^.....2...M..|
        000001a0  a7 23 7a b6 51 ae b2 0e  8f fb f1 ce d5 9b ab 97  |.#z.Q...........|
        000001b0  2a 72 dd 07 4f 09 ab dd  cd 51 c0 87 2b 57 92 af  |*r..O....Q..+W..|
        000001c0  7f d2 c4 53 0f 09 a0 41  c2 9d 3f d3 06 11 a1 05  |...S...A..?.....|
        000001d0  e7 00 d7 db 0d de 66 25  cd c5 f7 3f cd f1 be 3e  |......f%...?...>|
        000001e0  18 ee 15 05 92 62 73 25  f4 fd 5a a8 19 af 22 72  |.....bs%..Z..."r|
        000001f0  c4 b3 e0 b9 fd 4a f3 ac  ec df 84 7b 20 36 7f ae  |.....J.....{ 6..|
        00000200  9a 76 83 6f 30 d6 33 57  1a 89 f4 69 87 f8 bb dd  |.v.o0.3W...i....|
        00000210  ce d0 c0 fc e5 d5 de 5e  be dc 56 79 4f af e1 d7  |.......^..VyO...|
        00000220  42 ec 37 b7 b5 34 36 44  29 6b 0c 4e 0d 66 93 e6  |B.7..46D)k.N.f..|
        00000230  2a 87 4f ba a3 01 e8 ad  cb c3 39 69 76 b8 9b 43  |*.O.......9iv..C|
        00000240  ae 66 5d dc 5e b7 7a df  b5 b2 e5 cd ed 06 5b 5c  |.f].^.z.......[\|
        00000250  06 d8 55 42 37 57 d2 23  16 e1 f1 52 4e 03 e6 c1  |..UB7W.#...RN...|
        00000260  b8 e2 ce 11 1f ea ee 8c  0d c6 61 97 e7 1a 6d 1e  |..........a...m.|
        00000270  c1 66 19 66 c6 6b 83 36  aa 26 a0 e9 fc 2b d3 da  |.f.f.k.6.&...+..|
        00000280  2e ba 98 31 07 1f 01 13  30 06 a0 6d e5 39 25 a4  |...1....0..m.9%.|
        00000290  b8 50 4b 38 22 7b 26 b8  2b 76 e6 61 68 ce a8 93  |.PK8"{&.+v.ah...|
        000002a0  dc 3d cc 9a 07 e2 93 43  7f 6c 41 a1 d0 28 a0 69  |.=.....C.lA..(.i|
        000002b0  61 f7 e8 1a 7b d7 69 1c  bd 3c 3d 08 b4 93 89 2d  |a...{.i..<=....-|
        000002c0  64 e7 5b 57 3d c7 8b 2a  d4 d9 d3 81 4c 52 fe 9d  |d.[W=..*....LR..|
        000002d0  a4 fe 38 93 a8 6a a1 28  0e 3f 62 86 3a c8 dd 01  |..8..j.(.?b.:...|
        000002e0  62 89 a4 22 d4 fa f1 06  cd 99 5d 54 b6 30 97 af  |b.."......]T.0..|
        000002f0  44 41 15 b2 01 94 00 40  ca a0 02 c1 92 ef a6 80  |DA.....@........|
        00000300  eb d2 be 40 ef 9b 67 99  60 a1 68 71 69 25 b5 a4  |...@..g.`.hqi%..|
        00000310  81 b2 8a 10 93 49 f7 dc  f5 16 7c 17 ed d9 8c 4a  |.....I....|....J|
        00000320  cf 23 7c 22 61 e2 78 a8  38 33 f6 aa 24 10 c2 91  |.#|"a.x.83..$...|
        00000330  12 9e 27 20 8e d7 b8 82  a2 af e5 7b c2 6f 66 5e  |..' .......{.of^|
        00000340  f8 b3 fe 38 48 1d fb 50  32 7c d9 15 ac 3a e7 dc  |...8H..P2|...:..|
        00000350  45 e6 68 d5 8b df bd b1  99 ca 85 67 d9 de 16 67  |E.h........g...g|
        00000360  51 ab 82 f7 bd 12 50 ca                           |Q.....P.|
        
2025-12-06T09:19:52.338097314Z[36m [INFO][TNGF][IKE] [0mEncoding IKE payloads
2025-12-06T09:19:52.338100017Z[36m [INFO][TNGF][IKE] [0m[Identification] marshal(): Start marshaling
2025-12-06T09:19:52.338102863Z[36m [INFO][TNGF][IKE] [0m[SecurityAssociation] marshal(): Start marshaling
2025-12-06T09:19:52.338106408Z[36m [INFO][TNGF][IKE] [0m[TrafficSelector] marshal(): Start marshaling
2025-12-06T09:19:52.338109330Z[36m [INFO][TNGF][IKE] [0m[TrafficSelector] marshal(): Start marshaling
2025-12-06T09:19:52.338112427Z[36m [INFO][TNGF][IKE] [0m[Authentication] marshal(): Start marshaling
2025-12-06T09:19:52.338114944Z[36m [INFO][TNGF][IKE] [0m[Configuration] marshal(): Start marshaling
2025-12-06T09:19:52.338117679Z[36m [INFO][TNGF][IKE] [0mEncoding IKE message
2025-12-06T09:19:52.338120174Z[36m [INFO][TNGF][IKE] [0mEncoding IKE payloads
2025-12-06T09:19:52.338122505Z[36m [INFO][TNGF][IKE] [0m[Encrypted] marshal(): Start marshaling
2025-12-06T09:19:52.338129137Z[36m [INFO][TNGF][IKE] [0mEncoding IKE message
2025-12-06T09:19:52.338131347Z[36m [INFO][TNGF][IKE] [0mEncoding IKE payloads
2025-12-06T09:19:52.338133503Z[36m [INFO][TNGF][IKE] [0m[Encrypted] marshal(): Start marshaling
2025-12-06T09:19:52.338215371Z[36m [INFO][TNGF][IKE] [0mDecoding IKE message
2025-12-06T09:19:52.338239905Z[36m [INFO][TNGF][IKE] [0mDecoding IKE payloads
2025-12-06T09:19:52.338244578Z[36m [INFO][TNGF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-12-06T09:19:52.338253518Z[36m [INFO][TNGF][IKE] [0mHandle IKE_AUTH
2025-12-06T09:19:52.338257381Z[36m [INFO][TNGF][IKE] [0mEncoding IKE message
2025-12-06T09:19:52.338259723Z[36m [INFO][TNGF][IKE] [0mEncoding IKE payloads
2025-12-06T09:19:52.338261933Z[36m [INFO][TNGF][IKE] [0m[Encrypted] marshal(): Start marshaling
2025-12-06T09:19:52.338271596Z[36m [INFO][TNGF][IKE] [0mDecoding IKE payloads
2025-12-06T09:19:52.338274332Z[36m [INFO][TNGF][IKE] [0m[Identification] unmarshal(): Start unmarshalling received bytes
2025-12-06T09:19:52.338276816Z[36m [INFO][TNGF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-12-06T09:19:52.338280438Z[36m [INFO][TNGF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-12-06T09:19:52.338283896Z[36m [INFO][TNGF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-12-06T09:19:52.338286949Z[36m [INFO][TNGF][IKE] [0m[Authentication] unmarshal(): Start unmarshalling received bytes
2025-12-06T09:19:52.338289575Z[36m [INFO][TNGF][IKE] [0m[Configuration] unmarshal(): Start unmarshalling received bytes
2025-12-06T09:19:52.338297487Z[36m [INFO][TNGF][IKE] [0mEcoding initiator for later IKE authentication
2025-12-06T09:19:52.338299698Z[36m [INFO][TNGF][IKE] [0mEncoding IKE payloads
2025-12-06T09:19:52.338302291Z[36m [INFO][TNGF][IKE] [0m[Identification] marshal(): Start marshaling
2025-12-06T09:19:52.338307128Z[36m [INFO][TNGF][IKE] [0mPRF(sk_p,id) : 00000000  8b df bd b1 99 ca 85 67  d9 de 16 67 51 ab 82 f7  |.......g...gQ...|
00000010  bd 12 50 ca                                       |..P.|
2025-12-06T09:19:52.338310039Z[36m [INFO][TNGF][IKE] [0mParsing security association
2025-12-06T09:19:52.338313289Z[36m [INFO][TNGF][IKE] [0mReceived traffic selector initiator from UE
2025-12-06T09:19:52.338315379Z[36m [INFO][TNGF][IKE] [0mReceived traffic selector initiator from UE
initiatorID.IDData:  9     Gx
ktipsec:  00000000  ee 76 fb 71 f0 37 fc 6c  54 b7 93 71 e3 54 cf 23  |.v.q.7.lT..q.T.#|
00000010  6f 39 14 29 20 ce 50 4d  1f 9f 23 78 28 bf 34 4e  |o9.) .PM..#x(.4N|

2025-12-06T09:19:52.338326979Z[36m [INFO][TNGF][IKE] [0mUsing key to authentication: 00000000  ce 30 d6 0a 66 e6 3d 77  59 22 26 8d f1 3e b1 d4  |.0..f.=wY"&..>..|
00000010  63 77 73 b1                                       |cws.|
2025-12-06T09:19:52.338352181Z[36m [INFO][TNGF][IKE] [0mInitoatorSignedOctets:  00000000  00 00 00 00 00 01 e0 f3  00 00 00 00 00 00 00 00  |................|
00000010  21 20 22 08 00 00 00 00  00 00 02 54 22 00 00 2c  |! "........T"..,|
00000020  00 00 00 28 01 01 00 04  03 00 00 08 01 00 00 0b  |...(............|
00000030  03 00 00 08 02 00 00 02  03 00 00 08 03 00 00 02  |................|
00000040  00 00 00 08 04 00 00 0e  28 00 01 08 00 0e 00 00  |........(.......|
00000050  29 78 11 8e b5 c8 eb 0b  be 49 08 dd 61 59 1c 7d  |)x.......I..aY.}|
00000060  36 af 08 05 f6 5d 86 1c  87 56 cb b0 d1 f3 3c 55  |6....]...V....<U|
00000070  f2 f7 1d 60 a8 d7 e5 78  d0 ed a9 ef 3e 3b b4 4c  |...`...x....>;.L|
00000080  b8 9f 3a 37 f3 78 c5 6d  21 60 f1 60 df e3 30 98  |..:7.x.m!`.`..0.|
00000090  2b 41 92 b9 e5 7d 62 68  bf 1a 33 22 01 9a b7 b6  |+A...}bh..3"....|
000000a0  14 16 74 c3 01 8e e5 62  44 80 d8 95 55 0d 5c 99  |..t....bD...U.\.|
000000b0  6a 3c 75 03 1a f6 c0 1d  ec 87 02 60 3a fa 2b 0a  |j<u........`:.+.|
000000c0  45 61 65 e0 7b 8c d7 d7  20 01 22 3f 1b 64 16 3c  |Eae.{... ."?.d.<|
000000d0  aa a3 c0 74 62 17 3c fb  35 77 73 f5 4a 61 d8 39  |...tb.<.5ws.Ja.9|
000000e0  3a e4 6a 17 5e 2e 63 2b  64 4c 74 20 1d 60 23 b9  |:.j.^.c+dLt .`#.|
000000f0  0e 37 65 0b a9 fd 83 9a  7b 4e d3 43 b1 c2 22 4c  |.7e.....{N.C.."L|
00000100  71 3b c2 e3 79 3b a0 7c  c2 ed db c8 83 b3 97 92  |q;..y;.|........|
00000110  71 e2 af 14 27 13 53 f2  d5 09 c1 28 71 20 46 54  |q...'.S....(q FT|
00000120  38 ec 61 13 63 e0 36 7a  70 15 fb b8 0b da 56 4d  |8.a.c.6zp.....VM|
00000130  9e 80 32 49 df de b1 34  62 bc f2 4d 71 fd 85 b2  |..2I...4b..Mq...|
00000140  52 89 d1 0f 4e d8 40 a6  8f 82 9b 8c 53 7d ff 38  |R...N.@.....S}.8|
00000150  00 00 01 04 75 98 39 ab  a7 3b 82 e1 bd cc 30 94  |....u.9..;....0.|
00000160  22 81 03 ec ff 87 bb 04  ab e4 12 51 9a ac 12 7a  |"..........Q...z|
00000170  df b0 07 5e 9c db 4e f5  12 38 a7 d8 4f 9d 83 09  |...^..N..8..O...|
00000180  a4 30 45 29 f5 0a cf a2  be a7 f5 1b ff ef 9c 73  |.0E)...........s|
00000190  38 8c 29 5e 05 07 c9 d8  04 32 c3 f9 dd 4d 81 9d  |8.)^.....2...M..|
000001a0  a7 23 7a b6 51 ae b2 0e  8f fb f1 ce d5 9b ab 97  |.#z.Q...........|
000001b0  2a 72 dd 07 4f 09 ab dd  cd 51 c0 87 2b 57 92 af  |*r..O....Q..+W..|
000001c0  7f d2 c4 53 0f 09 a0 41  c2 9d 3f d3 06 11 a1 05  |...S...A..?.....|
000001d0  e7 00 d7 db 0d de 66 25  cd c5 f7 3f cd f1 be 3e  |......f%...?...>|
000001e0  18 ee 15 05 92 62 73 25  f4 fd 5a a8 19 af 22 72  |.....bs%..Z..."r|
000001f0  c4 b3 e0 b9 fd 4a f3 ac  ec df 84 7b 20 36 7f ae  |.....J.....{ 6..|
00000200  9a 76 83 6f 30 d6 33 57  1a 89 f4 69 87 f8 bb dd  |.v.o0.3W...i....|
00000210  ce d0 c0 fc e5 d5 de 5e  be dc 56 79 4f af e1 d7  |.......^..VyO...|
00000220  42 ec 37 b7 b5 34 36 44  29 6b 0c 4e 0d 66 93 e6  |B.7..46D)k.N.f..|
00000230  2a 87 4f ba a3 01 e8 ad  cb c3 39 69 76 b8 9b 43  |*.O.......9iv..C|
00000240  ae 66 5d dc 5e b7 7a df  b5 b2 e5 cd ed 06 5b 5c  |.f].^.z.......[\|
00000250  06 d8 55 42 37 57 d2 23  16 e1 f1 52 4e 03 e6 c1  |..UB7W.#...RN...|
00000260  b8 e2 ce 11 1f ea ee 8c  0d c6 61 97 e7 1a 6d 1e  |..........a...m.|
00000270  c1 66 19 66 c6 6b 83 36  aa 26 a0 e9 fc 2b d3 da  |.f.f.k.6.&...+..|
00000280  2e ba 98 31 07 1f 01 13  30 06 a0 6d e5 39 25 a4  |...1....0..m.9%.|
00000290  b8 50 4b 38 22 7b 26 b8  2b 76 e6 61 68 ce a8 93  |.PK8"{&.+v.ah...|
000002a0  dc 3d cc 9a 07 e2 93 43  7f 6c 41 a1 d0 28 a0 69  |.=.....C.lA..(.i|
000002b0  61 f7 e8 1a 7b d7 69 1c  bd 3c 3d 08 b4 93 89 2d  |a...{.i..<=....-|
000002c0  64 e7 5b 57 3d c7 8b 2a  d4 d9 d3 81 4c 52 fe 9d  |d.[W=..*....LR..|
000002d0  a4 fe 38 93 a8 6a a1 28  0e 3f 62 86 3a c8 dd 01  |..8..j.(.?b.:...|
000002e0  62 89 a4 22 d4 fa f1 06  cd 99 5d 54 b6 30 97 af  |b.."......]T.0..|
000002f0  44 41 15 b2 01 94 00 40  ca a0 02 c1 92 ef a6 80  |DA.....@........|
00000300  eb d2 be 40 ef 9b 67 99  60 a1 68 71 69 25 b5 a4  |...@..g.`.hqi%..|
00000310  81 b2 8a 10 93 49 f7 dc  f5 16 7c 17 ed d9 8c 4a  |.....I....|....J|
00000320  cf 23 7c 22 61 e2 78 a8  38 33 f6 aa 24 10 c2 91  |.#|"a.x.83..$...|
00000330  12 9e 27 20 8e d7 b8 82  a2 af e5 7b c2 6f 66 5e  |..' .......{.of^|
00000340  f8 b3 fe 38 48 1d fb 50  32 7c d9 15 ac 3a e7 dc  |...8H..P2|...:..|
00000350  45 e6 68 d5 8b df bd b1  99 ca 85 67 d9 de 16 67  |E.h........g...g|
00000360  51 ab 82 f7 bd 12 50 ca                           |Q.....P.|
2025-12-06T09:19:52.338375949Z[36m [INFO][TNGF][IKE] [0mInbound SPI: 3827269398, Outbound SPI: 2994653483
2025-12-06T09:19:52.338386181Z[36m [INFO][TNGF][IKE] [0mEncoding IKE payloads
2025-12-06T09:19:52.338388927Z[36m [INFO][TNGF][IKE] [0m[Identification] marshal(): Start marshaling
2025-12-06T09:19:52.338391477Z[36m [INFO][TNGF][IKE] [0m[Authentication] marshal(): Start marshaling
2025-12-06T09:19:52.338393830Z[36m [INFO][TNGF][IKE] [0m[Configuration] marshal(): Start marshaling
2025-12-06T09:19:52.338396259Z[36m [INFO][TNGF][IKE] [0m[SecurityAssociation] marshal(): Start marshaling
2025-12-06T09:19:52.338402672Z[36m [INFO][TNGF][IKE] [0m[TrafficSelector] marshal(): Start marshaling
2025-12-06T09:19:52.338405473Z[36m [INFO][TNGF][IKE] [0m[TrafficSelector] marshal(): Start marshaling
2025-12-06T09:19:52.338407990Z[36m [INFO][TNGF][IKE] [0m[Notification] marshal(): Start marshaling
2025-12-06T09:19:52.338416723Z[36m [INFO][TNGF][IKE] [0m[Notification] marshal(): Start marshaling
2025-12-06T09:19:52.338419382Z[36m [INFO][TNGF][IKE] [0mEncoding IKE message
2025-12-06T09:19:52.338421472Z[36m [INFO][TNGF][IKE] [0mEncoding IKE payloads
2025-12-06T09:19:52.338423540Z[36m [INFO][TNGF][IKE] [0m[Encrypted] marshal(): Start marshaling
2025-12-06T09:19:52.341899753Z[36m [INFO][TNGF][IKE] [0mEncoding IKE message
2025-12-06T09:19:52.341911517Z[36m [INFO][TNGF][IKE] [0mEncoding IKE payloads
2025-12-06T09:19:52.341914427Z[36m [INFO][TNGF][IKE] [0m[Encrypted] marshal(): Start marshaling
2025-12-06T09:19:52.341945352Z[36m [INFO][TNGF][NGAP] [0m[TNGF] Send Initial Context Setup Response
2025-12-06T09:19:52.341976861Z[36m [INFO][TNGF][IKE] [0mDecoding IKE message
2025-12-06T09:19:52.341991054Z[36m [INFO][TNGF][IKE] [0mDecoding IKE payloads
2025-12-06T09:19:52.341994413Z[36m [INFO][TNGF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-12-06T09:19:52.341997247Z[36m [INFO][TNGF][IKE] [0mEncoding IKE message
2025-12-06T09:19:52.341999535Z[36m [INFO][TNGF][IKE] [0mEncoding IKE payloads
2025-12-06T09:19:52.342001843Z[36m [INFO][TNGF][IKE] [0m[Encrypted] marshal(): Start marshaling
2025-12-06T09:19:52.342014483Z[36m [INFO][TNGF][IKE] [0mDecoding IKE payloads
2025-12-06T09:19:52.342016978Z[36m [INFO][TNGF][IKE] [0m[Identification] unmarshal(): Start unmarshalling received bytes
2025-12-06T09:19:52.342019330Z[36m [INFO][TNGF][IKE] [0m[Authentication] unmarshal(): Start unmarshalling received bytes
2025-12-06T09:19:52.342027658Z[36m [INFO][TNGF][IKE] [0m[Configuration] unmarshal(): Start unmarshalling received bytes
2025-12-06T09:19:52.342025130Z[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/172.17.0.1/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:35074] [0mHandle InitialContextSetupResponse
2025-12-06T09:19:52.342030908Z[36m [INFO][TNGF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-12-06T09:19:52.342037419Z[36m [INFO][TNGF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-12-06T09:19:52.342036730Z[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/172.17.0.1/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:35074] [0mHandle InitialContextSetupResponse (RAN UE NGAP ID: 0)
2025-12-06T09:19:52.342040341Z[36m [INFO][TNGF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-12-06T09:19:52.342041578Z[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/172.17.0.1/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:35074] [0mSend Downlink Nas Transport
2025-12-06T09:19:52.342043022Z[36m [INFO][TNGF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-12-06T09:19:52.342045320Z[36m [INFO][TNGF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    tngf_test.go:1496: Get Authentication from TNGF
2025-12-06T09:19:52.342150702Z[36m [INFO][TNGF][NGAP] [0m[TNGF] Handle Downlink NAS Transport
Expected XFRM Interface Addr: 10.0.0.196/24
    tngf_test.go:1583: Establish TCP connection with TNGF successfully!!
Security header type: Integrity Protected And Ciphered
cmac value: 0xad4d231f
err <nil>
    tngf_test.go:1607: Get Registration Accept Message:
         (*nas.Message)(0xc000c80520)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc000208b40)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 42                                          |~.B|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(0xc000000000)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			RegistrationAcceptMessageIdentity: (nasType.RegistrationAcceptMessageIdentity) {
        				Octet: (uint8) 66
        			},
        			RegistrationResult5GS: (nasType.RegistrationResult5GS) {
        				Iei: (uint8) 0,
        				Len: (uint8) 1,
        				Octet: (uint8) 2
        			},
        			GUTI5G: (*nasType.GUTI5G)(0xc000ca8320)({
        				Iei: (uint8) 119,
        				Len: (uint16) 11,
        				Octet: ([11]uint8) (len=11 cap=11) {
        					00000000  f2 02 f8 39 ca fe 00 00  00 00 01                 |...9.......|
        				}
        			}),
        			EquivalentPlmns: (*nasType.EquivalentPlmns)(<nil>),
        			TAIList: (*nasType.TAIList)(0xc000c80540)({
        				Iei: (uint8) 84,
        				Len: (uint8) 7,
        				Buffer: ([]uint8) (len=7 cap=7) {
        					00000000  00 02 f8 39 00 00 01                              |...9...|
        				}
        			}),
        			AllowedNSSAI: (*nasType.AllowedNSSAI)(0xc000c80560)({
        				Iei: (uint8) 21,
        				Len: (uint8) 10,
        				Buffer: ([]uint8) (len=10 cap=10) {
        					00000000  04 01 fe dc ba 04 01 11  22 33                    |........"3|
        				}
        			}),
        			RejectedNSSAI: (*nasType.RejectedNSSAI)(<nil>),
        			ConfiguredNSSAI: (*nasType.ConfiguredNSSAI)(<nil>),
        			NetworkFeatureSupport5GS: (*nasType.NetworkFeatureSupport5GS)(0xc000ca835b)({
        				Iei: (uint8) 33,
        				Len: (uint8) 1,
        				Octet: ([3]uint8) (len=3 cap=3) {
        					00000000  00 00 00                                          |...|
        				}
        			}),
        			PDUSessionStatus: (*nasType.PDUSessionStatus)(<nil>),
        			PDUSessionReactivationResult: (*nasType.PDUSessionReactivationResult)(<nil>),
        			PDUSessionReactivationResultErrorCause: (*nasType.PDUSessionReactivationResultErrorCause)(<nil>),
        			LADNInformation: (*nasType.LADNInformation)(<nil>),
        			MICOIndication: (*nasType.MICOIndication)(<nil>),
        			NetworkSlicingIndication: (*nasType.NetworkSlicingIndication)(<nil>),
        			ServiceAreaList: (*nasType.ServiceAreaList)(<nil>),
        			T3512Value: (*nasType.T3512Value)(<nil>),
        			Non3GppDeregistrationTimerValue: (*nasType.Non3GppDeregistrationTimerValue)(0xc000ca8363)({
        				Iei: (uint8) 93,
        				Len: (uint8) 1,
        				Octet: (uint8) 73
        			}),
        			T3502Value: (*nasType.T3502Value)(0xc000ca8369)({
        				Iei: (uint8) 22,
        				Len: (uint8) 1,
        				Octet: (uint8) 44
        			}),
        			EmergencyNumberList: (*nasType.EmergencyNumberList)(<nil>),
        			ExtendedEmergencyNumberList: (*nasType.ExtendedEmergencyNumberList)(<nil>),
        			SORTransparentContainer: (*nasType.SORTransparentContainer)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			NSSAIInclusionMode: (*nasType.NSSAIInclusionMode)(<nil>),
        			OperatordefinedAccessCategoryDefinitions: (*nasType.OperatordefinedAccessCategoryDefinitions)(<nil>),
        			NegotiatedDRXParameters: (*nasType.NegotiatedDRXParameters)(<nil>),
        			Non3GppNwPolicies: (*nasType.Non3GppNwPolicies)(<nil>),
        			EPSBearerContextStatus: (*nasType.EPSBearerContextStatus)(<nil>)
        		}),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(<nil>),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(<nil>)
        })
2025-12-06T09:19:53.937202197Z[36m [INFO][TNGF][NGAP] [0m[TNGF] Send Uplink NAS Transport
2025-12-06T09:19:53.937377969Z[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/172.17.0.1/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:35074] [0mHandle UplinkNASTransport
2025-12-06T09:19:53.937398203Z[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/172.17.0.1/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:35074] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-12-06T09:19:53.937433396Z[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [ContextSetup] to [ContextSetup]
2025-12-06T09:19:53.937438506Z[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-208930000007487] [0mHandle Registration Complete
2025-12-06T09:19:53.937442533Z[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-208930000007487] [0mStop T3550 timer
2025-12-06T09:19:53.937465579Z[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-208930000007487] [0mSend Configuration Update Command
2025-12-06T09:19:53.937471587Z[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/172.17.0.1/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:35074] [0mSend Downlink Nas Transport
2025-12-06T09:19:53.937526073Z[36m [INFO][AMF][Gmm] [0mHandle event[ContextSetup Success], transition from [ContextSetup] to [Registered]
2025-12-06T09:19:53.937600786Z[36m [INFO][TNGF][NGAP] [0m[TNGF] Handle Downlink NAS Transport
2025-12-06T09:19:55.842603185Z[36m [INFO][TNGF][NGAP] [0m[TNGF] Send Uplink NAS Transport
2025-12-06T09:19:55.842788441Z[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/172.17.0.1/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:35074] [0mHandle UplinkNASTransport
2025-12-06T09:19:55.842809692Z[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/172.17.0.1/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:35074] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-12-06T09:19:55.842846472Z[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-12-06T09:19:55.842851166Z[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-208930000007487] [0mHandle UL NAS Transport
2025-12-06T09:19:55.842855489Z[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-208930000007487] [0mTransport 5GSM Message to SMF
2025-12-06T09:19:55.842863784Z[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-208930000007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-12-06T09:19:55.843201853Z[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-12-06T09:19:55.843943266Z[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&target-nf-type=NSSF |  |
2025-12-06T09:19:55.844374554Z[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-12-06T09:19:55.844505597Z[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-12-06T09:19:55.844591007Z[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v2/network-slice-information?nf-id=5cad6cf2-9fdc-40c9-8a84-fbf0a171d963&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-12-06T09:19:55.844683766Z[33m [WARN][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-208930000007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-12-06T09:19:55.844786499Z[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-12-06T09:19:55.845662600Z[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%5B%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%5D&target-nf-type=SMF&target-plmn-list=%5B%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%5D |  |
2025-12-06T09:19:55.846425675Z[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-12-06T09:19:55.846517421Z[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-12-06T09:19:55.846540183Z[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-12-06T09:19:55.846543170Z[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-12-06T09:19:55.846662220Z[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-12-06T09:19:55.847348754Z[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-12-06T09:19:55.847502088Z[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-208930000007487] [0mSend NF Discovery Serving UDM Successfully
2025-12-06T09:19:55.847738513Z[36m [INFO][UDM][Consumer] [0mTwoLayerPathHandlerFunc,  imsi-208930000007487 sm-data
2025-12-06T09:19:55.847756481Z[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-12-06T09:19:55.847765323Z[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-208930000007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-12-06T09:19:55.848589532Z[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v2/subscription-data/imsi-208930000007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-12-06T09:19:55.848748272Z[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v2/imsi-208930000007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-12-06T09:19:55.848802407Z[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-12-06T09:19:55Z[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc000c808a0 0xc000c808c0 0xc000c808e0]
2025-12-06T09:19:55.848815495Z[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-12-06T09:19:55.848829031Z[36m [INFO][SMF][GSM] [0m&{[0xc000c808a0 0xc000c808c0 0xc000c808e0]}
2025-12-06T09:19:55.848831647Z[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-12-06T09:19:55.848909058Z[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-12-06T09:19:55.849622583Z[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=5cad6cf2-9fdc-40c9-8a84-fbf0a171d963&target-nf-type=AMF |  |
2025-12-06T09:19:55.849825828Z[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-12-06T09:19:55.849845306Z[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.1
2025-12-06T09:19:55.849848786Z[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-12-06T09:19:55.849851555Z[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-208930000007487] [0mAllocated PDUAdress[10.60.0.1]
2025-12-06T09:19:55.849943444Z[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-12-06T09:19:55.850575618Z[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=BSF |  |
2025-12-06T09:19:55.850687401Z[33m [WARN][SMF][Consumer] [0mBSF selection failed: no BSF instances found
2025-12-06T09:19:55.850692818Z[33m [WARN][SMF][Consumer] [0mBSF query error (falling back to NRF): no BSF instances found
2025-12-06T09:19:55.850696123Z[36m [INFO][SMF][Consumer] [0mNo PCF binding found in BSF, using NRF discovery for SUPI: imsi-208930000007487, DNN: internet
2025-12-06T09:19:55.850768293Z[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-12-06T09:19:55.851492044Z[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?preferred-locality=area1&requester-nf-type=SMF&target-nf-type=PCF |  |
2025-12-06T09:19:55.852048202Z[36m [INFO][PCF][SMpolicy] [0mHandle CreateSmPolicy
2025-12-06T09:19:55.853126656Z[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v2/policy-data/ues/imsi-208930000007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-12-06T09:19:55.856291574Z[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v2/application-data/influenceData?dnns=internet&snssais=%5B%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%5D&supis=imsi-208930000007487 |  |
2025-12-06T09:19:55.856369719Z[36m [INFO][PCF][SMpolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-12-06T09:19:55.856490825Z[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v2/application-data/influenceData/subs-to-notify |  |
2025-12-06T09:19:55.856845763Z[36m [INFO][PCF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-12-06T09:19:55.856933067Z[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-208930000007487] PDUSessionID[1]
2025-12-06T09:19:55.857252114Z[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-12-06T09:19:55.857800027Z[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-12-06T09:19:55.857909151Z[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-12-06T09:19:55.859199113Z[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-12-06T09:19:55.859219576Z[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-12-06T09:19:55.859225212Z[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-12-06T09:19:55.859229184Z[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-208930000007487
2025-12-06T09:19:55.859233704Z[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-208930000007487
2025-12-06T09:19:55.859368829Z[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-12-06T09:19:55.859480962Z[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-12-06T09:19:55.859545154Z[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-208930000007487] [0mInstall PCCRule[PccRuleId-1]
2025-12-06T09:19:55.859550910Z[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-208930000007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-12-06T09:19:55.859575718Z[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-208930000007487] [0mInstall PCCRule[PccRuleId-2]
2025-12-06T09:19:55.859579165Z[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-208930000007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-12-06T09:19:55.859631068Z[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-208930000007487] [0mHas default path
2025-12-06T09:19:55.859769891Z[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-12-06T09:19:55.859972250Z[36m [INFO][UDM][Consumer] [0mTwoLayerPathHandlerFunc,  imsi-208930000007487 sdm-subscriptions
2025-12-06T09:19:55.860011951Z[36m [INFO][UDM][SDM] [0mHandle Subscribe
2025-12-06T09:19:55.860046411Z[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-12-06T09:19:55.860067531Z[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x1][UPSEID:0x1] [0mNew session
2025-12-06T09:19:55.860306363Z[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v2/subscription-data/imsi-208930000007487/context-data/sdm-subscriptions |  |
2025-12-06T09:19:55.860483247Z[36m [INFO][UDM][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudm-sdm/v2/imsi-208930000007487/sdm-subscriptions |  |
2025-12-06T09:19:55.860549561Z[36m [INFO][SMF][PduSess] [0mSDM Subscription Successful UE: imsi-208930000007487 SubscriptionId: 2
2025-12-06T09:19:55.860556390Z[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-12-06T09:19:55.860609518Z[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-208930000007487] [0mcreate smContext[pduSessionID: 1] Success
2025-12-06T09:19:55.860784312Z[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:1 urrid:2 period:30000000000}]
2025-12-06T09:19:55.860805957Z[36m [INFO][UPF][Perio] [0mnew ticker [30s]
2025-12-06T09:19:55.861070073Z[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:1 urrid:1 period:30000000000}]
2025-12-06T09:19:56.010875676Z[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-12-06T09:19:56.011667050Z[36m [INFO][AMF][Producer] [0mHandle N1N2 Message Transfer Request
2025-12-06T09:19:56.011695568Z[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/172.17.0.1/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:35074] [0mSend PDU Session Resource Setup Request
2025-12-06T09:19:56.011829368Z[36m [INFO][AMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-208930000007487/n1-n2-messages |  |
2025-12-06T09:19:56.011969675Z[36m [INFO][TNGF][NGAP] [0m[TNGF] Handle PDU Session Resource Setup Request
2025-12-06T09:19:56.012289310Z[36m [INFO][TNGF][IKE] [0mEncoding IKE payloads
2025-12-06T09:19:56.012295406Z[36m [INFO][TNGF][IKE] [0m[SecurityAssociation] marshal(): Start marshaling
2025-12-06T09:19:56.012299630Z[36m [INFO][TNGF][IKE] [0m[Nonce] marshal(): Start marshaling
2025-12-06T09:19:56.012303098Z[36m [INFO][TNGF][IKE] [0m[TrafficSelector] marshal(): Start marshaling
2025-12-06T09:19:56.012306546Z[36m [INFO][TNGF][IKE] [0m[TrafficSelector] marshal(): Start marshaling
2025-12-06T09:19:56.012309205Z[36m [INFO][TNGF][IKE] [0m[Notification] marshal(): Start marshaling
2025-12-06T09:19:56.012311525Z[36m [INFO][TNGF][IKE] [0m[Notification] marshal(): Start marshaling
2025-12-06T09:19:56.012314545Z[36m [INFO][TNGF][IKE] [0mEncoding IKE message
2025-12-06T09:19:56.012317007Z[36m [INFO][TNGF][IKE] [0mEncoding IKE payloads
2025-12-06T09:19:56.012319743Z[36m [INFO][TNGF][IKE] [0m[Encrypted] marshal(): Start marshaling
2025-12-06T09:19:56.012342121Z[36m [INFO][TNGF][IKE] [0mEncoding IKE message
2025-12-06T09:19:56.012344266Z[36m [INFO][TNGF][IKE] [0mEncoding IKE payloads
2025-12-06T09:19:56.012346345Z[36m [INFO][TNGF][IKE] [0m[Encrypted] marshal(): Start marshaling
2025-12-06T09:19:56.012414933Z[36m [INFO][TNGF][IKE] [0mDecoding IKE message
2025-12-06T09:19:56.012443035Z[36m [INFO][TNGF][IKE] [0mDecoding IKE payloads
2025-12-06T09:19:56.012447927Z[36m [INFO][TNGF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
    tngf_test.go:1655: IKE message exchange type: 36
    tngf_test.go:1656: IKE message ID: 0
2025-12-06T09:19:56.012482923Z[36m [INFO][TNGF][IKE] [0mEncoding IKE message
2025-12-06T09:19:56.012485735Z[36m [INFO][TNGF][IKE] [0mEncoding IKE payloads
2025-12-06T09:19:56.012499337Z[36m [INFO][TNGF][IKE] [0m[Encrypted] marshal(): Start marshaling
2025-12-06T09:19:56.012520009Z[36m [INFO][TNGF][IKE] [0mDecoding IKE payloads
2025-12-06T09:19:56.012523204Z[36m [INFO][TNGF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-12-06T09:19:56.012527384Z[36m [INFO][TNGF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-12-06T09:19:56.012530459Z[36m [INFO][TNGF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-12-06T09:19:56.012534027Z[36m [INFO][TNGF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-12-06T09:19:56.012537299Z[36m [INFO][TNGF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-12-06T09:19:56.012540220Z[36m [INFO][TNGF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    tngf_test.go:1683: Received Qos Flow settings
    tngf_test.go:1686: NotificationData:[6 1 2 1 2 2]
    tngf_test.go:1696: UP IP Address: 10.0.0.1
2025-12-06T09:19:56.012584496Z[36m [INFO][TNGF][IKE] [0mEncoding IKE payloads
2025-12-06T09:19:56.012587046Z[36m [INFO][TNGF][IKE] [0m[SecurityAssociation] marshal(): Start marshaling
2025-12-06T09:19:56.012594432Z[36m [INFO][TNGF][IKE] [0m[TrafficSelector] marshal(): Start marshaling
2025-12-06T09:19:56.012598645Z[36m [INFO][TNGF][IKE] [0m[TrafficSelector] marshal(): Start marshaling
2025-12-06T09:19:56.012608932Z[36m [INFO][TNGF][IKE] [0m[Nonce] marshal(): Start marshaling
2025-12-06T09:19:56.012616384Z[36m [INFO][TNGF][IKE] [0mEncoding IKE message
2025-12-06T09:19:56.012618759Z[36m [INFO][TNGF][IKE] [0mEncoding IKE payloads
2025-12-06T09:19:56.012621921Z[36m [INFO][TNGF][IKE] [0m[Encrypted] marshal(): Start marshaling
2025-12-06T09:19:56.012632613Z[36m [INFO][TNGF][IKE] [0mEncoding IKE message
2025-12-06T09:19:56.012634856Z[36m [INFO][TNGF][IKE] [0mEncoding IKE payloads
2025-12-06T09:19:56.012637044Z[36m [INFO][TNGF][IKE] [0m[Encrypted] marshal(): Start marshaling
2025-12-06T09:19:56.012700638Z[36m [INFO][TNGF][IKE] [0mDecoding IKE message
2025-12-06T09:19:56.012724975Z[36m [INFO][TNGF][IKE] [0mDecoding IKE payloads
2025-12-06T09:19:56.012728925Z[36m [INFO][TNGF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-12-06T09:19:56.012739704Z[36m [INFO][TNGF][IKE] [0mHandle CREATE_CHILD_SA
2025-12-06T09:19:56.012749126Z[33m [WARN][TNGF][IKE] [0mCREATE_CHILD_SA responderSPI: 8622285412656396949
2025-12-06T09:19:56.012752945Z[36m [INFO][TNGF][IKE] [0mEncoding IKE message
2025-12-06T09:19:56.012756874Z[36m [INFO][TNGF][IKE] [0mEncoding IKE payloads
2025-12-06T09:19:56.012759150Z[36m [INFO][TNGF][IKE] [0m[Encrypted] marshal(): Start marshaling
2025-12-06T09:19:56.012772446Z[36m [INFO][TNGF][IKE] [0mDecoding IKE payloads
2025-12-06T09:19:56.012775357Z[36m [INFO][TNGF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-12-06T09:19:56.012778760Z[36m [INFO][TNGF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-12-06T09:19:56.012782032Z[36m [INFO][TNGF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-12-06T09:19:56.012784932Z[36m [INFO][TNGF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-12-06T09:19:56.013070130Z[36m [INFO][TNGF][NGAP] [0m[TNGF] Send PDU Session Resource Setup Response
Security header type: Integrity Protected And Ciphered
cmac value: 0x7f0d408c
err <nil>
2025-12-06T09:19:56.013182745Z[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/172.17.0.1/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:35074] [0mHandle PDUSessionResourceSetupResponse
2025-12-06T09:19:56.013195012Z[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/172.17.0.1/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:35074] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
    tngf_test.go:1782: Dump DecodePDUSessionEstablishmentAccept:
         (*nas.Message)(0xc000c80a40)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc000209590)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 68                                          |~.h|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(<nil>),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(0xc0000618b0)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			DLNASTRANSPORTMessageIdentity: (nasType.DLNASTRANSPORTMessageIdentity) {
        				Octet: (uint8) 104
        			},
        			SpareHalfOctetAndPayloadContainerType: (nasType.SpareHalfOctetAndPayloadContainerType) {
        				Octet: (uint8) 1
        			},
        			PayloadContainer: (nasType.PayloadContainer) {
        				Iei: (uint8) 0,
        				Len: (uint16) 109,
        				Buffer: ([]uint8) (len=109 cap=109) {
        					00000000  2e 01 00 c2 11 00 1a 01  00 06 31 31 01 01 ff 01  |..........11....|
        					00000010  02 00 0e 21 11 09 10 09  09 09 09 ff ff ff ff 80  |...!............|
        					00000020  02 06 01 03 e8 01 03 e8  29 05 01 0a 3c 00 01 22  |........)...<.."|
        					00000030  04 01 fe dc ba 79 00 0c  01 20 41 01 01 09 02 20  |.....y... A.... |
        					00000040  41 01 01 08 7b 00 1b 80  00 0d 04 08 08 08 08 00  |A...{...........|
        					00000050  03 10 20 01 48 60 48 60  00 00 00 00 00 00 00 00  |.. .H`H`........|
        					00000060  88 88 25 09 08 69 6e 74  65 72 6e 65 74           |..%..internet|
        				}
        			},
        			PduSessionID2Value: (*nasType.PduSessionID2Value)(0xc000ca918c)({
        				Iei: (uint8) 18,
        				Octet: (uint8) 1
        			}),
        			AdditionalInformation: (*nasType.AdditionalInformation)(<nil>),
        			Cause5GMM: (*nasType.Cause5GMM)(<nil>),
        			BackoffTimerValue: (*nasType.BackoffTimerValue)(<nil>)
        		}),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(0xc000cbe2d0)({
        		GsmHeader: (nas.GsmHeader) {
        			Octet: ([4]uint8) (len=4 cap=4) {
        				00000000  2e 01 00 c2                                       |....|
        			}
        		},
        		PDUSessionEstablishmentRequest: (*nasMessage.PDUSessionEstablishmentRequest)(<nil>),
        		PDUSessionEstablishmentAccept: (*nasMessage.PDUSessionEstablishmentAccept)(0xc0008d4300)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 46
        			},
        			PDUSessionID: (nasType.PDUSessionID) {
        				Octet: (uint8) 1
        			},
        			PTI: (nasType.PTI) {
        				Octet: (uint8) 0
        			},
        			PDUSESSIONESTABLISHMENTACCEPTMessageIdentity: (nasType.PDUSESSIONESTABLISHMENTACCEPTMessageIdentity) {
        				Octet: (uint8) 194
        			},
        			SelectedSSCModeAndSelectedPDUSessionType: (nasType.SelectedSSCModeAndSelectedPDUSessionType) {
        				Octet: (uint8) 17
        			},
        			AuthorizedQosRules: (nasType.AuthorizedQosRules) {
        				Iei: (uint8) 0,
        				Len: (uint16) 26,
        				Buffer: ([]uint8) (len=26 cap=26) {
        					00000000  01 00 06 31 31 01 01 ff  01 02 00 0e 21 11 09 10  |...11.......!...|
        					00000010  09 09 09 09 ff ff ff ff  80 02                    |..........|
        				}
        			},
        			SessionAMBR: (nasType.SessionAMBR) {
        				Iei: (uint8) 0,
        				Len: (uint8) 6,
        				Octet: ([6]uint8) (len=6 cap=6) {
        					00000000  01 03 e8 01 03 e8                                 |......|
        				}
        			},
        			Cause5GSM: (*nasType.Cause5GSM)(<nil>),
        			PDUAddress: (*nasType.PDUAddress)(0xc000ca91b0)({
        				Iei: (uint8) 41,
        				Len: (uint8) 5,
        				Octet: ([13]uint8) (len=13 cap=13) {
        					00000000  01 0a 3c 00 01 00 00 00  00 00 00 00 00           |..<..........|
        				}
        			}),
        			RQTimerValue: (*nasType.RQTimerValue)(<nil>),
        			SNSSAI: (*nasType.SNSSAI)(0xc000ca91c0)({
        				Iei: (uint8) 34,
        				Len: (uint8) 4,
        				Octet: ([8]uint8) (len=8 cap=8) {
        					00000000  01 fe dc ba 00 00 00 00                           |........|
        				}
        			}),
        			AlwaysonPDUSessionIndication: (*nasType.AlwaysonPDUSessionIndication)(<nil>),
        			MappedEPSBearerContexts: (*nasType.MappedEPSBearerContexts)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			AuthorizedQosFlowDescriptions: (*nasType.AuthorizedQosFlowDescriptions)(0xc000c80a60)({
        				Iei: (uint8) 121,
        				Len: (uint16) 12,
        				Buffer: ([]uint8) (len=12 cap=12) {
        					00000000  01 20 41 01 01 09 02 20  41 01 01 08              |. A.... A...|
        				}
        			}),
        			ExtendedProtocolConfigurationOptions: (*nasType.ExtendedProtocolConfigurationOptions)(0xc000c80a80)({
        				Iei: (uint8) 123,
        				Len: (uint16) 27,
        				Buffer: ([]uint8) (len=27 cap=27) {
        					00000000  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000010  60 00 00 00 00 00 00 00  00 88 88                 |`..........|
        				}
        			}),
        			DNN: (*nasType.DNN)(0xc000c80aa0)({
        				Iei: (uint8) 37,
        				Len: (uint8) 9,
        				Buffer: ([]uint8) (len=9 cap=9) {
        					00000000  08 69 6e 74 65 72 6e 65  74                       |.internet|
        				}
        			})
        		}),
        		PDUSessionEstablishmentReject: (*nasMessage.PDUSessionEstablishmentReject)(<nil>),
        		PDUSessionAuthenticationCommand: (*nasMessage.PDUSessionAuthenticationCommand)(<nil>),
        		PDUSessionAuthenticationComplete: (*nasMessage.PDUSessionAuthenticationComplete)(<nil>),
        		PDUSessionAuthenticationResult: (*nasMessage.PDUSessionAuthenticationResult)(<nil>),
        		PDUSessionModificationRequest: (*nasMessage.PDUSessionModificationRequest)(<nil>),
        		PDUSessionModificationReject: (*nasMessage.PDUSessionModificationReject)(<nil>),
        		PDUSessionModificationCommand: (*nasMessage.PDUSessionModificationCommand)(<nil>),
        		PDUSessionModificationComplete: (*nasMessage.PDUSessionModificationComplete)(<nil>),
        		PDUSessionModificationCommandReject: (*nasMessage.PDUSessionModificationCommandReject)(<nil>),
        		PDUSessionReleaseRequest: (*nasMessage.PDUSessionReleaseRequest)(<nil>),
        		PDUSessionReleaseReject: (*nasMessage.PDUSessionReleaseReject)(<nil>),
        		PDUSessionReleaseCommand: (*nasMessage.PDUSessionReleaseCommand)(<nil>),
        		PDUSessionReleaseComplete: (*nasMessage.PDUSessionReleaseComplete)(<nil>),
        		Status5GSM: (*nasMessage.Status5GSM)(<nil>)
        	})
        })
        
    tngf_test.go:1788: PDU Address: 10.60.0.1
    non3gpp_test.go:264: GRE Key Field: 0x1000000
2025-12-06T09:19:56.013605961Z[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
2025-12-06T09:19:56.013885179Z[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-12-06T09:19:56.016476701Z[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-12-06T09:19:56.016550785Z[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:80911739-efb1-4646-9182-1f071253c27c/modify |  |
    tngf_test.go:1827: 32 bytes from 10.60.0.101: icmp_seq=0 time=424.41µs
    tngf_test.go:1827: 32 bytes from 10.60.0.101: icmp_seq=1 time=2.142452ms
    tngf_test.go:1827: 32 bytes from 10.60.0.101: icmp_seq=2 time=18.935567ms
    tngf_test.go:1827: 32 bytes from 10.60.0.101: icmp_seq=3 time=367.566µs
    tngf_test.go:1827: 32 bytes from 10.60.0.101: icmp_seq=4 time=365.996µs
    tngf_test.go:1831: 
        --- 10.60.0.101 ping statistics ---
    tngf_test.go:1832: 5 packets transmitted, 5 packets received, 0% packet loss
    tngf_test.go:1834: round-trip min/avg/max/stddev = 365.996µs/4.447199ms/18.935567ms/7.276085ms
    tngf_test.go:1801: Delete interface: gretun-id-1
    tngf_test.go:1559: Delete XFRM interface: ipsec-default
--- PASS: TestTngfUE (16.73s)
PASS
ok  	test	16.765s
2025-12-06T09:20:12.665309935Z[36m [INFO][UPF][Main] [0mShutdown UPF ...
2025-12-06T09:20:12.665378777Z[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mStopping pfcp server
2025-12-06T09:20:12.665423896Z[31m [ERRO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mread udp4 10.200.200.101:8805: use of closed network connection
2025-12-06T09:20:12.665431096Z[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mpfcp reciver stopped
2025-12-06T09:20:12.665440409Z[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mpfcp server stopped
2025-12-06T09:20:14.182912643Z[36m [INFO][UPF][Perio] [0mrecv event[TYPE_SERVER_CLOSE][{eType:4 lSeid:0 urrid:0 period:0}]
2025-12-06T09:20:14.182975954Z[36m [INFO][UPF][Perio] [0mperio server stopped
2025-12-06T09:20:14.183003312Z[36m [INFO][UPF][Perio] [0mticker[30s] Stopped
2025-12-06T09:20:14.183010009Z[36m [INFO][UPF][Main] [0mTerminating UPF...
2025-12-06T09:20:14.183014813Z[36m [INFO][UPF][Main] [0mUPF terminated
2025-12-06T09:20:14.183018763Z[36m [INFO][UPF][Main] [0mUPF exited
2025-12-06T09:20:14.862054849Z[36m [INFO][TNGF][Init] [0mTerminating TNGF...
2025-12-06T09:20:14.862086912Z[36m [INFO][TNGF][Init] [0mDeleting interfaces created by TNGF
2025-12-06T09:20:14.862216048Z[31m [ERRO][TNGF][Init] [0mDelete interface xfrmi-default fail: no such device
2025-12-06T09:20:14.862223423Z[36m [INFO][TNGF][Init] [0mTNGF terminated
/home/ubuntu/web_test/ci-test/base/free5gc/test.sh: line 82: 11860 Killed                  sudo -E ./bin/tngf -c ./config/tngfcfg.test.yaml  (wd: ~/web_test/ci-test/base/free5gc)
--- PASS: TestCN (38.62s)
PASS
ok  	test	43.093s
